<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="cxxClass"/>
<meta name="DC.Title" content="MMsvAttachmentManager"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD"/>

<title>MMsvAttachmentManager</title>

<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="cxxref.css"/></head>
<body class="cxxref" id="GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD"><a name="GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2437088 id2437096 id2366708 id2382304 id2382309 id2382314 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">
<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt;</div>
<h1 class="topictitle1">MMsvAttachmentManager Class Reference</h1>
	<table class="signature"><tr><td>class MMsvAttachmentManager</td></tr></table><div class="section"><div>
			<p>Defines the attachment management interface.</p>

			<p>This class is a pure virtual interface class that defines the APIs to be used for attachment management in the Messaging Framework. It is expected that the clients of this interface will be MTMs implementations that require attachment management.</p>

			<p>The API allows is based around the use of the <a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html#GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F">CMsvAttachment</a> object that represents any type of attachment that is supported by the Messaging Framework. The <a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html#GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F">CMsvAttachment</a> object provides users with various attributes about the attachment without having to actually load or retrieve the attachment.</p>

			<p>This attachment manager API supports the following different types of attachments: 1 - File attachments, file based attachments that are copied or created in the message store. 2 - Linked file attachments, file based attachments that are not copied and are simply linked to the file location on disk. 3 - Message entry attachments, existing message entries that can be registered as attachments of another message entry.</p>

			<p>For file based attachments, this API also supports the retrieval of the files as open read-only file handles.</p>

			<p>All functionality that requires the attachment manager to be in edit mode have been defined as asynchronous. The attachment manager does not allow multiple asynchronous requests to be made at the same time.</p>

			<p>
				<a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html#GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F">CMsvAttachment</a>   </p>

		</div></div>
<div class="section member-index"><table border="0" class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code">void</td><td><a href="#GUID-1E5A1188-D671-3AE7-B574-91A562A7E24A">AddAttachmentL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-9DF638D3-B358-3229-8C3A-6638B14E3BB8">AddAttachmentL</a>(<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;, <a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-37840180-6399-3EF6-8D10-10F21DADA1B0">AddEntryAsAttachmentL</a>(<a href="GUID-EE46F451-70DA-31DE-B49A-79EF77B492FC.html">TMsvId</a>, <a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-6AB03811-DAE4-39D4-8B3D-64BE4B6E39CD">AddLinkedAttachmentL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
				</td><td><a href="#GUID-86FFB1FF-5058-3A9A-9E54-456302E35156">AttachmentCount</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-1E001118-03CD-3497-94BD-483E839E898E">CancelRequest</a>()</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-BEE0D6E8-C106-3C85-99C7-0134B895D017">CreateAttachmentL</a>(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;, <a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td><a href="#GUID-3524A520-5092-3502-8A2D-22528F181C5F">GetAttachmentFileForWriteL</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td><a href="#GUID-CDB6355E-78F7-3B9D-BCF3-A6BEA2AE9914">GetAttachmentFileForWriteL</a>(<a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>)</td></tr><tr class="bg"><td align="right" class="code">
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td><a href="#GUID-41CA832F-928D-3519-B809-2780569CC1C9">GetAttachmentFileL</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td><a href="#GUID-EF5E8012-E057-3420-BA74-4C2BB0D878E8">GetAttachmentFileL</a>(<a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>)</td></tr><tr class="bg"><td align="right" class="code">
					<a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><a href="#GUID-20112827-F686-38F5-A338-F107F4A7E894">GetAttachmentInfoL</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">
					<a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><a href="#GUID-DA276F93-DFDB-3A39-A78E-90EEEDC59486">GetAttachmentInfoL</a>(<a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-7A02E48B-EE47-3A99-AC0F-8CC20EF0888A">ModifyAttachmentInfoL</a>(<a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-AF04342E-E681-358B-9225-7F583E57CA3E">RemoveAttachmentL</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-18FC724D-C7D2-33AF-9EC7-2543211F7565">RemoveAttachmentL</a>(<a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-6B0869A7-71E0-3990-BA7F-A62A5222C723">RenameAttachmentL</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr></tbody></table></div><h1 class="pageHeading topictitle1">Member Functions Documentation</h1><div class="nested1" id="GUID-1E5A1188-D671-3AE7-B574-91A562A7E24A"><a name="GUID-1E5A1188-D671-3AE7-B574-91A562A7E24A"><!-- --></a>
		<h2 class="topictitle2">AddAttachmentL(const TDesC &amp;, CMsvAttachment *, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>AddAttachmentL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>aAttachmentInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Adds an attachment to the message store by file path.</p>

				<p>The attachment file must be located in a public area. The file path must also be a full path specification. The file is copied into the message store.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The absolute file path of the attachment file.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> * aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>The client's request status to complete when the operation has completed.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-9DF638D3-B358-3229-8C3A-6638B14E3BB8"><a name="GUID-9DF638D3-B358-3229-8C3A-6638B14E3BB8"><!-- --></a>
		<h2 class="topictitle2">AddAttachmentL(RFile &amp;, CMsvAttachment *, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>AddAttachmentL</td><td>(</td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aFileHandle,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>aAttachmentInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Adds an attachment to the message store by file handle.</p>

				<p>This is used to add an attachment from an open file handle such as when adding a file from the caller's private area. The file is copied into the message store. The message server is responsible for closing the file handle once copied.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aFileHandle</td><td>An open file handle for the attachment file. Ownership is transferred. The caller must close the file handle.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> * aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>The client's request status to complete.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-37840180-6399-3EF6-8D10-10F21DADA1B0"><a name="GUID-37840180-6399-3EF6-8D10-10F21DADA1B0"><!-- --></a>
		<h2 class="topictitle2">AddEntryAsAttachmentL(TMsvId, CMsvAttachment *, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>AddEntryAsAttachmentL</td><td>(</td><td><a href="GUID-EE46F451-70DA-31DE-B49A-79EF77B492FC.html">TMsvId</a></td><td>aEntryId,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>aAttachmentInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Adds a message entry as an attachment.</p>

				<p>The message entry is registered as an attachment of the current message entry. The attachment message entry is not copied.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-EE46F451-70DA-31DE-B49A-79EF77B492FC.html">TMsvId</a> aEntryId</td><td>The message Id of the entry to register as an attachment.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> * aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>The client's request status to complete.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-6AB03811-DAE4-39D4-8B3D-64BE4B6E39CD"><a name="GUID-6AB03811-DAE4-39D4-8B3D-64BE4B6E39CD"><!-- --></a>
		<h2 class="topictitle2">AddLinkedAttachmentL(const TDesC &amp;, CMsvAttachment *, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>AddLinkedAttachmentL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFilePath,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>aAttachmentInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Adds an attachment as a linked file attachment.</p>

				<p>The attachment is added as a link by its file path. The attachment is not copied to the message store. The attachment is linked and therefore must be in a public location.</p>

				<p>It is possible to change a linked attachment file after it has been attached to a message entry. No integrity checking is carried out. This is left to individual MTMs or implementors of this interface to decide if any checking is required such as checking if the size has changed.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFilePath</td><td>The absolute file path of the linked attachment file.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> * aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>The client's request status to complete.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-86FFB1FF-5058-3A9A-9E54-456302E35156"><a name="GUID-86FFB1FF-5058-3A9A-9E54-456302E35156"><!-- --></a>
		<h2 class="topictitle2">AttachmentCount()</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
				</td><td>AttachmentCount</td><td>(</td><td>)</td><td>const [pure virtual]</td></tr></table><div class="section"><div>
				<p>Counts the number of attachments.</p>

				<p>Returns the number of attachments associated with the message entry. This includes all the attachments that have not been commited yet. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-1E001118-03CD-3497-94BD-483E839E898E"><a name="GUID-1E001118-03CD-3497-94BD-483E839E898E"><!-- --></a>
		<h2 class="topictitle2">CancelRequest()</h2>
		<table class="signature"><tr><td>void</td><td>CancelRequest</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Cancels the last asynchronous operation that was requested.</p>

				<p>Allows callers to cancel the last asynchronous operation. This will have no effect if an asynchronous is not waiting to complete. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-BEE0D6E8-C106-3C85-99C7-0134B895D017"><a name="GUID-BEE0D6E8-C106-3C85-99C7-0134B895D017"><!-- --></a>
		<h2 class="topictitle2">CreateAttachmentL(const TDesC &amp;, RFile &amp;, CMsvAttachment *, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>CreateAttachmentL</td><td>(</td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aFileName,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;</td><td>aAttachmentFile,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>aAttachmentInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Creates a new empty attachment file.</p>

				<p>The caller is returned an open writable file handle to an empty attachment file in the message store. The caller must pass in an uninitialised file handle. The file handle cannot be used until the asynchronous request completes successfully. If the request is sucessful the file handle is open and must close by the caller once the data has been written to it.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aFileName</td><td>The filename to assign to the newly create attachment file.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp; aAttachmentFile</td><td>An uninitialised file handle. This is opened and can be written to if the request is successful. Ownership is transferred . The caller must close the file handle.  </td></tr><tr><td class="parameter"><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> * aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td> </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-3524A520-5092-3502-8A2D-22528F181C5F"><a name="GUID-3524A520-5092-3502-8A2D-22528F181C5F"><!-- --></a>
		<h2 class="topictitle2">GetAttachmentFileForWriteL(TInt)</h2>
		<table class="signature"><tr><td>
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td>GetAttachmentFileForWriteL</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>aIndex</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Returns an open writable file handle for the attachment file.</p>

				<p>Returns a writable open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotSupported If the attachment is not a file attachment in the message store. </dd>

						
					</dl>

					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aIndex</td><td>The array index position of the attachment.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-CDB6355E-78F7-3B9D-BCF3-A6BEA2AE9914"><a name="GUID-CDB6355E-78F7-3B9D-BCF3-A6BEA2AE9914"><!-- --></a>
		<h2 class="topictitle2">GetAttachmentFileForWriteL(TMsvAttachmentId)</h2>
		<table class="signature"><tr><td>
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td>GetAttachmentFileForWriteL</td><td>(</td><td><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td>aId</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Returns an open writable file handle for the attachment file.</p>

				<p>Returns a writable open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotSupported If the attachment is not a file attachment in the message store. </dd>

						
					</dl>

					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotFound If an attachment with the specified attachment Id is not found. </dd>

						
					</dl>

					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a> aId</td><td> </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-41CA832F-928D-3519-B809-2780569CC1C9"><a name="GUID-41CA832F-928D-3519-B809-2780569CC1C9"><!-- --></a>
		<h2 class="topictitle2">GetAttachmentFileL(TInt)</h2>
		<table class="signature"><tr><td>
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td>GetAttachmentFileL</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>aIndex</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Returns an open file handle for the attachment file.</p>

				<p>Returns a read-only open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotSupported If the attachment is not a file attachment in the message store. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aIndex</td><td>The array index position of the attachment.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-EF5E8012-E057-3420-BA74-4C2BB0D878E8"><a name="GUID-EF5E8012-E057-3420-BA74-4C2BB0D878E8"><!-- --></a>
		<h2 class="topictitle2">GetAttachmentFileL(TMsvAttachmentId)</h2>
		<table class="signature"><tr><td>
					<a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a>
				</td><td>GetAttachmentFileL</td><td>(</td><td><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td>aId</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Returns an open file handle for the attachment file.</p>

				<p>Returns a read-only open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotSupported If the attachment is not a file attachment in the message store. </dd>

						
					</dl>

					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotFound If an attachment with the specified attachment Id is not found. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a> aId</td><td> </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-20112827-F686-38F5-A338-F107F4A7E894"><a name="GUID-20112827-F686-38F5-A338-F107F4A7E894"><!-- --></a>
		<h2 class="topictitle2">GetAttachmentInfoL(TInt)</h2>
		<table class="signature"><tr><td>
					<a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>GetAttachmentInfoL</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>aIndex</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Returns an attachment info object.</p>

				<p>This object contains attributes and information about the attachment without having actually retrieving the actual attachment. The caller assumes ownership of the returned object.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aIndex</td><td>The array index position of the attachment.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-DA276F93-DFDB-3A39-A78E-90EEEDC59486"><a name="GUID-DA276F93-DFDB-3A39-A78E-90EEEDC59486"><!-- --></a>
		<h2 class="topictitle2">GetAttachmentInfoL(TMsvAttachmentId)</h2>
		<table class="signature"><tr><td>
					<a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>GetAttachmentInfoL</td><td>(</td><td><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td>aId</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Returns an attachment info object.</p>

				<p>This object contains attributes and information about the attachment without having actually retrieving the actual attachment. The caller assumes ownership of the returned object.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotFound If an attachment with the specified attachment Id is not found. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a> aId</td><td>The attachment Id of the attachment.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-7A02E48B-EE47-3A99-AC0F-8CC20EF0888A"><a name="GUID-7A02E48B-EE47-3A99-AC0F-8CC20EF0888A"><!-- --></a>
		<h2 class="topictitle2">ModifyAttachmentInfoL(CMsvAttachment *, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>ModifyAttachmentInfoL</td><td>(</td><td><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>aAttachmentInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Modifies the attachment info for a particular attachment.</p>

				<p>This allows callers to modify an existing attachment info object for a particular attachment. The attachment info object passed in replaces the existing attachment info object and takes ownership for the object passed in. It is expected that callers will use GetAttachmentInfoL to get the object, make some changes and pass it back into this method.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotFound If the attachment that is trying to be modified cannot be found. </dd>

						
					</dl>

					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> * aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>The client's request status to complete.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-AF04342E-E681-358B-9225-7F583E57CA3E"><a name="GUID-AF04342E-E681-358B-9225-7F583E57CA3E"><!-- --></a>
		<h2 class="topictitle2">RemoveAttachmentL(TInt, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>RemoveAttachmentL</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>aIndex,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Removes the attachment from the message entry.</p>

				<p>This changes the array index values of all the attachments after the removed one. Attachment files stored in the message store are deleted. Linked files and message entry attachments are not deleted, this is left to the caller to do if required.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aIndex</td><td> </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td> </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-18FC724D-C7D2-33AF-9EC7-2543211F7565"><a name="GUID-18FC724D-C7D2-33AF-9EC7-2543211F7565"><!-- --></a>
		<h2 class="topictitle2">RemoveAttachmentL(TMsvAttachmentId, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>RemoveAttachmentL</td><td>(</td><td><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td>aId,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Removes the attachment from the message entry.</p>

				<p>This changes the array index values of all the attachments after the removed one. Attachment files stored in the message store are deleted. Linked files and message entry attachments are not deleted, this is left to the caller to do if required.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrNotFound If an attachment with the specified attachment Id is not found. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a> aId</td><td> </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td> </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-6B0869A7-71E0-3990-BA7F-A62A5222C723"><a name="GUID-6B0869A7-71E0-3990-BA7F-A62A5222C723"><!-- --></a>
		<h2 class="topictitle2">RenameAttachmentL(TInt, const TDesC &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>RenameAttachmentL</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>aIndex,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>aNewName,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Renames the physical filename of an attachment.</p>

				<div class="p">
					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAccessDenied If attachment manager is in read-only mode. </dd>

						
					</dl>

					<dl class="user">
						
							<dt class="dlterm">
								<strong>leave</strong>
							</dt>

							<dd>KErrAlreadyExists If the supplied attachment filename already exists. </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aIndex</td><td>The array index position of the attachment to be renamed.  </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp; aNewName</td><td>The new name of the attachment.  </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>The client's request status to complete.  </td></tr></table></div>

	</div>

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>