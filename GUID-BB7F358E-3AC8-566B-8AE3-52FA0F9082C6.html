<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="OpenGL ES 2.0 Shader Programs"/>
<meta name="abstract" content="The OpenGL ES 2.0 standard allows vendor implementations to support shader programs as pre-compiled binaries, source code to be compiled when the OpenGL ES 2.0 program is run, or both. At the time of writing, the Khronos Group has not defined the Application Binary Interface (ABI) for shader binaries. These are intended to be registered by hardware vendors with Khronos. This would result in updates to the header file GLES2/gl2ext.h."/>
<meta name="description" content="The OpenGL ES 2.0 standard allows vendor implementations to support shader programs as pre-compiled binaries, source code to be compiled when the OpenGL ES 2.0 program is run, or both. At the time of writing, the Khronos Group has not defined the Application Binary Interface (ABI) for shader binaries. These are intended to be registered by hardware vendors with Khronos. This would result in updates to the header file GLES2/gl2ext.h."/>
<meta name="DC.Relation" scheme="URI" content="GUID-FF5B53C9-F8E4-5A57-9CD9-05BB0BFD9045.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-975CBC70-81E6-5FA2-80CE-88DD2ABE9595.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-AB93B01C-B6C2-5B24-ADEF-95706584D625.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CBC43846-22BB-5AAF-89FE-3CF4F11B76F6.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-FF5B53C9-F8E4-5A57-9CD9-05BB0BFD9045.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7DD1BC7B-B3F7-515D-8DC8-B699B947B434.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-90A4BDE2-839A-5A37-ACAA-EB33FE39DE54.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-12D5C140-DFDA-549B-9CCF-EF7488B832AE.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>OpenGL ES 2.0 Shader Programs</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2384330 id2386845 id2386859 id2386874 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-975CBC70-81E6-5FA2-80CE-88DD2ABE9595.html">Graphics Guide</a> &gt; <a href="GUID-AB93B01C-B6C2-5B24-ADEF-95706584D625.html" title="The components within the OpenGLES collection provide access to OpenGL ES on the Symbian platform. OpenGL ES, an open standard developed by the Khronos Group, provides an API for 2D and 3D graphics on embedded systems, such as smartphones.">OpenGLES Collection</a> &gt; <a href="GUID-CBC43846-22BB-5AAF-89FE-3CF4F11B76F6.html" title="The OpenGLES Interface component provides a consistent interface to OpenGL ES on the Symbian platform, and enables users and providers of OpenGL ES to be binary compatible. OpenGL ES is an open standard developed by the Khronos Group.">OpenGLES Interface Component</a> &gt; <a href="GUID-FF5B53C9-F8E4-5A57-9CD9-05BB0BFD9045.html" title="This section provides information for OpenGL ES implementers working with the Symbian platform. This section should be used in conjunction with the EGL documentation, particularly the EGL Porting Guide.">OpenGLES Implementer's Guide</a> &gt; </div>
<h1 class="topictitle1">OpenGL ES 2.0 Shader Programs</h1>
<div><p>The OpenGL ES 2.0 standard allows vendor implementations to support shader programs as pre-compiled binaries, source code to be compiled when the OpenGL ES 2.0 program is run, or both. At the time of writing, the Khronos Group has not defined the Application Binary Interface (ABI) for shader binaries. These are intended to be registered by hardware vendors with Khronos. This would result in updates to the header file <span class="filepath">GLES2/gl2ext.h</span>. </p>
<p> <strong>Variant</strong>: <a href="GUID-D93978BE-11A3-5CE3-B110-1DEAA5AD566C.html" title="This topic provides an introduction to ScreenPlay and its architecture. ScreenPlay is a new graphics architecture, introduced in Symbian^3 (S^3). ScreenPlay enables device creators to take advantage of improved software performance, hardware acceleration and third party graphics engines. ScreenPlay is sometimes known as the New Graphics Architecture (NGA).">ScreenPlay</a> and <a href="GUID-F64E6551-670E-5E12-8103-DE504D3EC94F.html" title="ScreenPlay provides improved support for graphics hardware acceleration and some other new features. However, it is possible to use the Symbian platform without enabling ScreenPlay. This is called the non-ScreenPlay variant (sometimes referred to as the non-NGA variant). This topic provides an introduction to the graphics architecture when ScreenPlay is not enabled.">non-ScreenPlay</a>. <strong>Target audience</strong>: Device creators. </p>
 <p>A <em>shader</em> is a compilation unit for one of the two programmable stages in the OpenGL ES pipeline. A <em>shader program</em> is a complete set of shaders that are compiled and linked together. </p>
 <p>It is not always possible to register an extension to define the enumerated value <samp class="codeph">GLenum binaryformat</samp> supplied to <samp class="codeph">glShaderBinary()</samp> by client applications. In such cases the enumerations need to be defined in an SDK-specific file, which the client application must include. </p>
 <p>To maximize portability, shader programs may be supplied in as many formats as possible. Symbian recommends that OpenGL ES 2.0 implementation vendors supply guidance to application developers to enable them to achieve this goal. For example, if OpenGL ES 2.0 support is being added to an SDK for a family of handsets, the different ABI formats that are supported should be documented. Alternatively, if source code compilation is available, this should also be documented. </p>
 <p>The OpenGL ES 2.0 implementation vendor must give application writers details on how to pre-compile to a binary suitable for run-time loading. Alternatively, the vendor must explain whether shaders must be supplied as source code. A vendor may wish to provide support for both approaches. In such conditions, the vendor must describe the benefits of each method. </p>
 <p>In order to allow client applications to be written in a portable fashion, vendor implementations must support the following queries: </p>
 <ul><li id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-6C055EC6-5A8B-51B1-BAD5-D718BF819835"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-6C055EC6-5A8B-51B1-BAD5-D718BF819835"><!-- --></a><p> <samp class="codeph">glGetBooleanv(GL_SHADER_COMPILER,
             &amp;shaderCompilerSupport)</samp>  </p>
 </li>
 <li id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-BFA1D474-48B9-51A9-B3AC-8E163E603C69"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-BFA1D474-48B9-51A9-B3AC-8E163E603C69"><!-- --></a><p> <samp class="codeph">glGetIntegerv(GL_NUM_SHADER_BINARY_FORMATS,
             &amp;nShaderBinaryFormats)</samp>. </p>
 </li>
 </ul>
 <p>If the <samp class="codeph">GL_SHADER_COMPILER</samp> query returns <samp class="codeph">GL_TRUE</samp>, the vendor implementation has a runtime compiler for the shader source code. If the <samp class="codeph">GL_NUM_SHADER_BINARY_FORMATS</samp> query is greater than zero, the vendor implementation supports loading pre-compiled shader programs. </p>
 <p>It is recommended that application developers make use of such queries in structuring their programs to take advantage of whatever is available in the platform to construct shader programs. The following code excerpt demonstrates this: </p>
 <pre class="codeblock" id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-6B28C4DF-873F-52DB-9640-956C1F7991B1"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-6B28C4DF-873F-52DB-9640-956C1F7991B1"><!-- --></a>programObjectId = glCreateProgram();
GLuint fragShaderId;
GLuint vertShaderId;
fragShaderId = glCreateShader(GL_FRAGMENT_SHADER);
vertShaderId = glCreateShader(GL_VERTEX_SHADER);
    
GLboolean shaderCompilerSupport;
glGetBooleanv(GL_SHADER_COMPILER, &amp;shaderCompilerSupport);
GLboolean shaderBinarySupport;
GLint nShaderBinaryFormats;
glGetIntegerv(GL_NUM_SHADER_BINARY_FORMATS, &amp;nShaderBinaryFormats);
shaderBinarySupport = (nShaderBinaryFormats &gt; 0) ? GL_TRUE : GL_FALSE;
    
/*
 * Support Compile?  Support Binary?  Preferred Action
 * ----------------  ---------------  ----------------
 * FALSE             FALSE            Panic (out of spec behavior)
 * FALSE             TRUE             Load binary shader if have one
 * TRUE              FALSE            Compile shader from source if have it
 * TRUE              TRUE             Compile shader (we assume it would
 *                                    be better optimized than pre-built
 *                                    binaries; experimentation required)
 */
    
if (shaderCompilerSupport == GL_TRUE)
    {
    GLint shaderCompiled;
    glShaderSource(fragShaderId, 1, (const char**)&amp;KFragmentShaderSrc, NULL);
    glCompileShader(fragShaderId);
    glGetShaderiv(fragShaderId, GL_COMPILE_STATUS, &amp;shaderCompiled);
    
    if (!shaderCompiled) 
        {
        User::Panic(_L("OGLES2App-Comp"), 1);
        }
    glShaderSource(vertShaderId, 1, (const char**)&amp;KVertexShaderSrc, NULL);
    glCompileShader(vertShaderId);
    glGetShaderiv(vertShaderId, GL_COMPILE_STATUS, &amp;shaderCompiled);
    if (!shaderCompiled) 
        {
        User::Panic(_L("OGLES2App-Comp"), 2);
        }
    }
else if (shaderBinarySupport == GL_TRUE)
    {
    // This single-platform example has uses only one binary format type.
    // A multi-platform example would use a loop to cycle through
    // each available binary format before giving up.
    glShaderBinary(1, &amp;fragShaderId, GL_SGX_BINARY_VENDOR, KFragmentShaderBin, KFragmentShaderBinSz);

    if (glGetError())
        {
        User::Panic(_L("OGLES2App-Load"), 3);
        }
    glShaderBinary(1, &amp;vertShaderId, GL_SGX_BINARY_VENDOR, KVertexShaderBin, KVertexShaderBinSz);

    if (glGetError())
        {
        User::Panic(_L("OGLES2App-Load"), 4);
        }
    }
else
    {
    User::Panic(_L("OGLES2App-Lib"), 5);
    }
    
glAttachShader(programObjectId, fragShaderId);
glAttachShader(programObjectId, vertShaderId);
glDeleteShader(fragShaderId);
glDeleteShader(vertShaderId);
    
// Any attribute bindings need to be done before LinkProgram
glBindAttribLocation(programObjectId, KVertexAttrIndex, "myVertex");
    
glLinkProgram(programObjectId);
GLint programLinked;
glGetProgramiv(programObjectId, GL_LINK_STATUS, &amp;programLinked);
if (!programLinked)
    {
    User::Panic(_L("OGLES2App-Link"), 6);
    }
glUseProgram(programObjectId);</pre>
 <p><strong>Notes </strong> </p>
 <ul><li id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-11645A2E-DD2D-57E1-9AA0-36A014E1A673"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-11645A2E-DD2D-57E1-9AA0-36A014E1A673"><!-- --></a><p>This program is locked to an SDK-specific family because it uses the binary format token <samp class="codeph">GL_SGX_BINARY_VENDOR</samp> using an SDK-specific file, for example, <span class="filepath">sdk_gl2ext.h</span>. </p>
 </li>
 <li id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-A8FBD2C8-F5C2-59DB-BC88-7D1AFB563497"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-A8FBD2C8-F5C2-59DB-BC88-7D1AFB563497"><!-- --></a><p>The program checks for compiler support and binary support, but prefers to compile rather than to use binaries. </p>
 </li>
 <li id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-1BCD9323-DF19-5425-A476-6997935779B7"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-1BCD9323-DF19-5425-A476-6997935779B7"><!-- --></a><p>The program assumes there is only one binary format (<samp class="codeph">GL_SGX_BINARY_VENDOR</samp>) whereas this might need to be turned into a loop to cover a family of handsets. </p>
 </li>
 <li id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-A9EC59C2-426C-5DDE-A7A6-B46AF1ADCAF1"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-A9EC59C2-426C-5DDE-A7A6-B46AF1ADCAF1"><!-- --></a><p>Top-level declarations are not shown for reasons of space. These are: <samp class="codeph">KVertexShaderSrc</samp>, <samp class="codeph">KVertexAttrIndex</samp>, <samp class="codeph">KFragmentShaderBin</samp>, <samp class="codeph">KFragmentShaderBinSz</samp>, <samp class="codeph">KVertexShaderBin</samp>, <samp class="codeph">KVertexShaderBinSz</samp>, <samp class="codeph">programObjectId</samp>. </p>
 </li>
 <li id="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-84A39C04-37EE-5F8C-9D49-DF2DE9B90343"><a name="GUID-BB7F358E-3AC8-566B-8AE3-52FA0F9082C6__GUID-84A39C04-37EE-5F8C-9D49-DF2DE9B90343"><!-- --></a><p>Shader source code or binaries should be in a secure location, accessible privately to the application. They should not be in a public resource file due to malicious replacement and reverse engineering risks. </p>
 </li>
 </ul>
 <div class="section"><h2 class="sectiontitle">Security issues</h2> <p>Although limited in behavior, shader programs are deployed into the runtime environment of a device and therefore OpenGL ES 2.0 implementation vendors must take measures to address the security threats that are involved. </p>
 <p>When an OpenGL ES 2.0 application provides source code for a shader program, the OpenGL ES implementation vendor must take care not to allow its data to be compromised in terms of confidentiality or integrity. The programs are confidential because they may represent the intellectual property of the shader program author. Integrity must be assured for shader source code and shader binaries to prevent malicious replacement or modification. </p>
 <p>For more information, see <a href="GUID-011A0A93-42DF-5235-BC8E-7BD88B572277.html">OpenGL ES Security Threats and Measures</a>. </p>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-FF5B53C9-F8E4-5A57-9CD9-05BB0BFD9045.html" title="This section provides information for OpenGL ES implementers working with the Symbian platform. This section should be used in conjunction with the EGL documentation, particularly the EGL Porting Guide.">OpenGLES Implementer's Guide</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-7DD1BC7B-B3F7-515D-8DC8-B699B947B434.html" title="This topic provides a guide for implementers of OpenGL ES on the Symbian platform. It is designed to be used in conjunction with the EGL Porting Guide. It does not specify how to implement OpenGL ES itself.">OpenGL ES Porting Guide</a></div>
<div><a href="GUID-90A4BDE2-839A-5A37-ACAA-EB33FE39DE54.html">OpenGL ES Variability
                Choices</a></div>
<div><a href="GUID-12D5C140-DFDA-549B-9CCF-EF7488B832AE.html" title="The OpenGLES Interface component provides the Symbian platform with an interface to the open-source, cross-platform OpenGL ES APIs defined by the Khronos Group. The component includes the Khronos-released header files, some Symbian-specific header files, LIB, DEF and MMP files and UIDs. It does not provide any implementations of the APIs.">OpenGLES Interface Overview</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>