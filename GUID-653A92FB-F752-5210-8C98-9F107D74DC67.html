<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Forwarding or Replying to Email Messages Stored as Rich Text"/>
<meta name="abstract" content="This tutorial explains how to forward email messages that are stored as rich text."/>
<meta name="description" content="This tutorial explains how to forward email messages that are stored as rich text."/>
<meta name="DC.Relation" scheme="URI" content="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B394A824-8745-505E-8429-8B9B6D418387.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-179099DA-1CD9-5912-B41B-363C132C7A86.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-653A92FB-F752-5210-8C98-9F107D74DC67"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Forwarding or Replying to Email Messages Stored as Rich Text</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2404348 id2404397 id2404434 id2404652 id2404788 id2404819 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4.html">Messaging Middleware Guide</a> &gt; <a href="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388.html">Messaging Framework</a> &gt; <a href="GUID-B394A824-8745-505E-8429-8B9B6D418387.html">Message Server and Store</a> &gt; <a href="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6.html">Message Server and Store Tutorials</a> &gt; <a href="GUID-179099DA-1CD9-5912-B41B-363C132C7A86.html">Processing Email in Chunks</a> &gt; <a href="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html">Creating and Reading Email Messages in Chunks</a> &gt; </div>
<h1 class="topictitle1">Forwarding
or Replying to Email Messages Stored as Rich Text</h1>
<div><p>This tutorial explains how to forward email messages that are stored
as rich text. </p>

<div class="section"><h2 class="sectiontitle">Procedure</h2> <a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-4F6BB3EC-586E-5EAE-97DA-A4CF0E5017C8"><!-- --></a><ol id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-4F6BB3EC-586E-5EAE-97DA-A4CF0E5017C8">
<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-CB2BFF6E-193F-55F9-9559-B61FDFEE15E1"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-CB2BFF6E-193F-55F9-9559-B61FDFEE15E1"><!-- --></a><p>Use the<a href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498__GUID-5C13FD54-1C93-353C-9BDB-2A30A14BD159"><span class="apiname"> CImEmailOperation::CreateForwardL()</span></a> function
or the <a href="GUID-4DBC97FC-004F-3F79-9D17-F5B0F9F6F4A6.html"><span class="apiname">CreateReplyL()</span></a> function to forward or reply to an
email. </p>
 <p>The newly created email will be stored in the same format as
the original email. In this case, it is rich text format and the formatting
information is preserved while forwarding or replying to the email. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-38843C43-005E-5B42-9AAC-E098573C19AF"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-38843C43-005E-5B42-9AAC-E098573C19AF"><!-- --></a><p>Use the <a href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498__GUID-38E7EABD-1300-3DF2-B9DF-B65EEABD8A31"><span class="apiname">CImEmailOperation::ProgressL()</span></a> function
to obtain the <a href="GUID-A4B1F874-27C0-3BB6-9D29-C35C75A5DB98.html"><span class="apiname">TMsvId</span></a> parameter of the newly created email.
This is returned through a <a href="GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html"><span class="apiname">TPckgC</span></a> &lt;<a href="GUID-A4B1F874-27C0-3BB6-9D29-C35C75A5DB98.html"><span class="apiname">TMsvId</span></a> &gt;
descriptor. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-86C3A5DB-6F5D-5E5C-9701-A74547EBAA97"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-86C3A5DB-6F5D-5E5C-9701-A74547EBAA97"><!-- --></a><p>Use the <a href="GUID-A4B1F874-27C0-3BB6-9D29-C35C75A5DB98.html"><span class="apiname">TMsvId</span></a>  <samp class="codeph">aMessageId</samp> parameter
to create a <a href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><span class="apiname">CMsvEntry</span></a> object. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-E3378D43-F39E-5C6C-96F6-9086713D0C84"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-E3378D43-F39E-5C6C-96F6-9086713D0C84"><!-- --></a><p>Use the <a href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><span class="apiname">CMsvEntry</span></a> object
to create a <a href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html"><span class="apiname">CImEmailMessage</span></a> object. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-EE96F019-D147-5FD9-974B-A5C34ABD2A1D"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-EE96F019-D147-5FD9-974B-A5C34ABD2A1D"><!-- --></a><p>Use the <a href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44__GUID-57CA3F50-33EA-359B-AABB-4E4E15AF2A18"><span class="apiname"> CImEmailMessage::GetBodyTextL()</span></a> function
to get the body text of the message that is being replied to or forwarded.
This will return a <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html"><span class="apiname">CRichText</span></a> class. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-E3B9F2CC-512E-56DB-BC9C-825426C6FF45"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-E3B9F2CC-512E-56DB-BC9C-825426C6FF45"><!-- --></a><p>If you want to use the
rich text format, complete the following step 1. If you want to store the
body text in plain text format, complete the following steps from 2  to 4. </p>
 <a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-CABBF3DD-DFB5-56EB-862A-E6A4CEC1C6C6"><!-- --></a><ol type="a" id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-CABBF3DD-DFB5-56EB-862A-E6A4CEC1C6C6">
<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-57FC7507-A8D8-58B7-8282-3F349A69D0BD"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-57FC7507-A8D8-58B7-8282-3F349A69D0BD"><!-- --></a><p>Edit the <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html"><span class="apiname">CRichText</span></a> class
and call the <a href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44__GUID-791117B4-C946-3D43-AE1E-68DDC10F85A3"><span class="apiname">CImEmailMessage::StoreBodyTextL()</span></a> function
to store the edited body text. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-531982EB-3274-5891-BCB3-27D89EA075F1"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-531982EB-3274-5891-BCB3-27D89EA075F1"><!-- --></a><p>Call the <a href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44__GUID-B99E759E-E0D6-3A10-B81C-5BFCAF631B7D"><span class="apiname">CImEmailMessage::OpenPlainBodyTextForWriteL()</span></a> function
to get <a href="GUID-C7E9BDA1-B17A-39BC-A194-78680106D184.html"><span class="apiname">CImPlainBody</span></a> Text. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-0CD62596-7491-541F-95EE-754904620B47"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-0CD62596-7491-541F-95EE-754904620B47"><!-- --></a><p>Call the <a href="GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html#GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D__GUID-DFD5B13A-3CE5-35D9-B8F3-31D3DFA0DB41"><span class="apiname">CImPlainBodyText::StoreRichTextAsPlainTexL()</span></a> function
and pass the edited <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html"><span class="apiname">CRichText</span></a> class to store the message. </p>
 </li>

<li id="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-6BE40DD9-4D5F-527E-A7DB-2D5E1BEBB718"><a name="GUID-653A92FB-F752-5210-8C98-9F107D74DC67__GUID-6BE40DD9-4D5F-527E-A7DB-2D5E1BEBB718"><!-- --></a><p>Call the <a href="GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html#GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D__GUID-022C7A37-91EF-3363-A760-865A1F980917"><span class="apiname">CImPlainBodyText::CommitL()</span></a> function
to complete the operation. </p>
 </li>

</ol>
 </li>

</ol>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html">Creating and Reading Email Messages in Chunks</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.html">Chunk Method
to Process Emails</a></div>
<div><a href="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7.html">Imap4Example:
An Email manager  using IMAP4 and SMTP</a></div>
<div><a href="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.html">Pop3Example:
An Email manager using POP3 and SMTP</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>