<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Writing a UPS Policy File"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B2089965-546C-5FF2-8596-13A2221E02E6.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BA362536-C9C9-5BA4-BEE3-0E1AD7FA45F1.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5329AE68-39E0-55E7-9878-2D8FF9E29B21.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B2089965-546C-5FF2-8596-13A2221E02E6.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Writing a UPS Policy File</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2858558 id2858601 id2858609 id2858646 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html">OS Security Guide</a> &gt; <a href="GUID-BA362536-C9C9-5BA4-BEE3-0E1AD7FA45F1.html">Authorisation</a> &gt; <a href="GUID-5329AE68-39E0-55E7-9878-2D8FF9E29B21.html">User Prompt Service</a> &gt; <a href="GUID-B2089965-546C-5FF2-8596-13A2221E02E6.html">Tutorials</a> &gt; </div>
<h1 class="topictitle1">Writing
a UPS Policy File</h1>
<div>
<p>UPS policy files are resource files that specify whether application requests
to access services are silently accepted or denied or whether they require
the user to be prompted. Each service has a policy file. The policy file lists
policies for various applications. </p>

<div class="section" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-F3D62C3E-D570-4DE2-ACED-0577D3923965"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-F3D62C3E-D570-4DE2-ACED-0577D3923965"><!-- --></a><h2 class="sectiontitle">Required Background</h2> <p>Before you start writing a
UPS policy file, you must configure the UPS. For more information, see <a href="GUID-6849E256-6719-5788-BCB2-7557F09AAAD0.html">Configuring UPS</a>. </p>
 </div>

<div class="section" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-10A7A574-4E57-45E3-8198-CD6D15EAC455"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-10A7A574-4E57-45E3-8198-CD6D15EAC455"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>The resource header file, <span class="filepath">ups/policies.rh</span>,
defines the structures and constants required by User Prompt Service policy
files. </p>
 <p>Device creators can customise the circumstances under which
prompts are generated by configuring policies. Policies are made up of details
about the service being requested as well as information about whether to
accept or deny silently or to ask the user. They are defined in policy lists.
Each service has one policy list defining any number of policies. </p>
 <p>In
cases where the policy specifies that a user prompt is required, ECOM plug-ins
called <a href="GUID-43080A86-72D3-5422-953E-A5EF79961D7B.html">Policy Evaluators</a> and <a href="GUID-A8130D83-E684-5B6C-BDFE-EB6EE3CD49E8.html">Dialog Creators</a>, written
by device creators. </p>
 </div>

<div class="section" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-7DFB9572-0E28-4D7A-9EF1-8A4DADFAA0B3"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-7DFB9572-0E28-4D7A-9EF1-8A4DADFAA0B3"><!-- --></a><h2 class="sectiontitle">Writing policy files</h2> <p>Writing policy files include
the following: </p>
 <ul>
<li id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-9FE188FC-A512-595A-848B-DA5A82F143AF"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-9FE188FC-A512-595A-848B-DA5A82F143AF"><!-- --></a><p>Naming and location
of policy files </p>
 </li>

<li id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-81096653-08DF-53F2-8CD9-D683BD8D9F97"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-81096653-08DF-53F2-8CD9-D683BD8D9F97"><!-- --></a><p>Policy resource </p>
 </li>

</ul>
 <p><strong> Naming and location of policy files</strong> </p>
 <p>UPS policy files
must be named <span class="filepath">ups_&lt;systemserversid&gt;_&lt;serviceuid&gt;.rsc</span>.
They are stored in <span class="filepath">z:\private\10283558\policies</span> or the
equivalent directory on the system drive. </p>
 <p>The <samp class="codeph">systemserversid</samp> and
the <samp class="codeph">serviceuid</samp> components of the policy file name are 8-digit,
zero-padded hexadecimal numbers. </p>
 <p><strong>Policy resource </strong> </p>
 <p>The
policy resource is made up of a header, followed by any number of policies.
Policies need to be ordered from most specific to least specific. </p>
 <pre class="codeblock" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-679FBF44-5880-57B2-83EA-1A89DA0BBA9D"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-679FBF44-5880-57B2-83EA-1A89DA0BBA9D"><!-- --></a>RESOURCE POLICIES mypolicies
    {
    header = POLICY_HEADER 
        {
        // header definition
        };
        policies = 
            {
            POLICY
            {
            // definition of policy 1
            },
            POLICY
            {
            // definition of policy 2
            }
            // etc
            };
   }
</pre>
 <p>The following shows an example header: </p>
 <pre class="codeblock" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-52773FA8-A3E1-51E2-8F12-675BE94A21E3"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-52773FA8-A3E1-51E2-8F12-675BE94A21E3"><!-- --></a>header = POLICY_HEADER
 {
 // The major version number of THIS policy file.
 // When policy files are upgraded or eclipsed the UPS deletes all decision
 // records for the system server server SID and service ID where the major
 // version in the decision record is not equal to the major version
 // number in the policy file.
 majorversion = 0;
 // The minor version number of THIS policy file.
 minorversion = 0; 

 // Built-in (protected SID and loaded from Z drive) client applications
 // do not require authorisation from the UPS if the client has the correct
 // capabilities.
 authorisationpolicy = ECheckPostManufacture;
 //dialogcreator and policyevaluator UIDs
 dialogcreator = 0x10283694;
 policyevaluator = 0x10283698;
 };
</pre>
 </div>

<div class="section" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-7A571B93-A2B9-4B97-ACE9-8C70AABBB389"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-7A571B93-A2B9-4B97-ACE9-8C70AABBB389"><!-- --></a><h2 class="sectiontitle">Example of a policy file </h2> <p>The following is an example
of a policy file: </p>
 <pre class="codeblock" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-F5378D3D-02A5-536E-96D1-6BD240B3852E"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-F5378D3D-02A5-536E-96D1-6BD240B3852E"><!-- --></a>#include &lt;ups/policies.rh&gt;
// Identifies this as a UPS policy file
UID2 KUidUpsPolicyResourceFile
// Uniquely defines this policy file. The UID should be reserved using the Symbian Signed protected UID allocator.
UID3 0x01100001                    

RESOURCE POLICIES testpolicies
    {
    header = POLICY_HEADER
        {
        // Built-in (protected SID and loaded from Z drive) client applications
        // do not require authorisation from the UPS if the client has the correct
        // capabilities.
        authorisationpolicy = ECheckPostManufacture;
        dialogcreator = 0x10283694;
        policyevaluator = 0x10283698;
        };
    policies = 
        {
        POLICY
            {        
            // Silently accept this SID (By specifying only KYes in options field)
            sid_list = {0x01000030};
            destination = "*";
            options = KYes;
            },            
        POLICY
            {
            // Silently accept these SIDs for a specific destination
            sid_list = {0x01000031,0x01000032};
            destination = "*WLAN*";
            options = KYes;
            },            
        POLICY
            {
            // For protected SIDs enable the Always and Never options
   // if the client has the correct capability.
            sid_classes = KProtectedSids;
            systemserversecurity = ESystemServerSecurityPassed;
            destination = "*";
            options = KYes|KNo|KAlways|KNever;
            policyevaluator = 0x01000020;
            dialogcreator = 0x01000021;
            },
        POLICY
            {
            // Unprotected SIDs may only get one-shot permissions            
            sid_classes = KUnprotectedSids;
            destination = "*";
            options = KYes|KNo;
            flags = 42;         // Flags specific to policy evaluator 0x10283698
            }
        };
    }

</pre>
 </div>

<div class="section" id="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-C069700D-FABD-4C84-AD71-B292F3B26E04"><a name="GUID-DB827750-6057-537E-8FE1-8F68BF2E9F99__GUID-C069700D-FABD-4C84-AD71-B292F3B26E04"><!-- --></a><h2 class="sectiontitle">See also</h2><p><a href="GUID-4E838A77-C7B5-5B1F-93F5-F3577901914B.html">Policy
Resource</a>  </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-B2089965-546C-5FF2-8596-13A2221E02E6.html">Tutorials</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>