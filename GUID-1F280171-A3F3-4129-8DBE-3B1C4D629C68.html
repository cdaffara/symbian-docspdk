<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Atomic Operations"/>
<meta name="abstract" content="Describes the new atomic operations added to euser.dll and the kernel."/>
<meta name="description" content="Describes the new atomic operations added to euser.dll and the kernel."/>
<meta name="DC.Relation" scheme="URI" content="GUID-CE72E71B-6ED3-4961-B4C5-C43D823ACA9D.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-629EAA30-ED77-4CA9-91ED-36C818D7B4F4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CE72E71B-6ED3-4961-B4C5-C43D823ACA9D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-387E98B0-568D-4DBB-9A9E-616E41E96B58.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Atomic Operations</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68"><a name="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2561665 id2561671 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-629EAA30-ED77-4CA9-91ED-36C818D7B4F4.html" title="Provides summary of documents to make SMP-safe applications.">SMP</a> &gt; <a href="GUID-CE72E71B-6ED3-4961-B4C5-C43D823ACA9D.html" title="Symmetric Multiprocessing (SMP) applies to a multiprocessor computer architecture where 2 or more identical processes can connect to a single shared main memory. SMP allows simultaneous execution of threads. This means that overall performance is improved and ultimately battery life is extended. This section introduces the main concepts applied to SMP including Threading Models, Interrupt Handling, Locking and Memory Barriers.">SMP Concepts</a> &gt; </div>
<h1 class="topictitle1">Atomic
Operations</h1>
<div><p>Describes the new atomic operations added to <samp class="codeph">euser.dll</samp> and
the kernel. </p>

<p>An atomic operation is an operation that comprises two or more conditions.
When an atomic operation is executed and all conditions are met it results
in success; when one or more conditions are not met it results in failure.
The new atomic operations added to <samp class="codeph">euser.dll</samp> and the kernel
replace the existing ones. The existing operation format is preserved <samp class="codeph">__e32_atomic_xxx_yyyZ</samp> </p>

<p>In the above format: </p>

<ul>
<li><p>z specifies the size of the data type being operated on</p>
</li>

<li><p>yyy specifies the type of memory ordering that is to be enforced (with
memory barriers)</p>
</li>

<li><p>xxx specifies the operation that is to be performed. </p>
</li>

</ul>

<p>The following table outlines the types of memory ordering and operations
available.</p>


<div class="tablenoborder"><a name="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68__GUID-3F63C6B6-E16F-4418-90FF-2BFBED7AB096"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68__GUID-3F63C6B6-E16F-4418-90FF-2BFBED7AB096" frame="border" border="1" rules="all">
<tbody>
<tr>
<td class="cellrowborder" colspan="2" valign="top"><strong>Memory Ordering (yyy)</strong></td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%"><strong>Name </strong></td>

<td class="cellrowborder" valign="top" width="83.5%"><strong>Description</strong></td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">rlx</td>

<td class="cellrowborder" valign="top" width="83.5%">Relaxed memory ordering. In this type of ordering there is no fixed
order in which the atomic operation is observed in relation to other memory
operations.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">acq</td>

<td class="cellrowborder" valign="top" width="83.5%">Acquire semantics. In this type of memory ordering a memory barrier
is placed after the atomic operation.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">rel</td>

<td class="cellrowborder" valign="top" width="83.5%">Release semantics. In this type of ordering a memory barrier is executed
before the atomic operation.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">ord</td>

<td class="cellrowborder" valign="top" width="83.5%">Fully ordered. In this type of ordering a memory barrier is executed
before and after the atomic operation.</td>

</tr>

<tr>
<td class="cellrowborder" colspan="2" valign="top"><strong>Operation (xxx)</strong></td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%"><strong>Name</strong></td>

<td class="cellrowborder" valign="top" width="83.5%"><strong>Description</strong></td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">load</td>

<td class="cellrowborder" valign="top" width="83.5%">Reads the contents of a location.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">store</td>

<td class="cellrowborder" valign="top" width="83.5%">Writes to a location</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">swp</td>

<td class="cellrowborder" valign="top" width="83.5%">Swaps the contents of a specified memory location with a given parameter.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">add</td>

<td class="cellrowborder" valign="top" width="83.5%">Adds a value to the contents of the specified memory location.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">and</td>

<td class="cellrowborder" valign="top" width="83.5%">Logical AND.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">ior</td>

<td class="cellrowborder" valign="top" width="83.5%">Logical OR.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">xor</td>

<td class="cellrowborder" valign="top" width="83.5%">Logical XOR.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">axo</td>

<td class="cellrowborder" valign="top" width="83.5%"> AND then XOR</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">cas</td>

<td class="cellrowborder" valign="top" width="83.5%">Compare and Set<p>Compare the contents of the specified memory location
with another specified location. If the contents of both locations have the
same value, the contents of the original location is set to a specified value.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">tau</td>

<td class="cellrowborder" valign="top" width="83.5%">Threshold and add unsigned<p>If the contents of a specified memory
location is greater than the specified threshold, then add the contents with
one parameter, otherwise add the contents to another. For this operation,
all the parameters are unsigned.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.5%">tas</td>

<td class="cellrowborder" valign="top" width="83.5%"> Threshold and add signed<p>If the contents of a specified memory location
is greater than the specified threshold, then add the contents with one parameter,
otherwise add the contents to another. For this operation, all the parameters
are signed.</p>
</td>

</tr>

</tbody>

</table>
</div>

<p>The meaning of each parameter, depends on the operation (xxx) (the argument
order is from left to right) :</p>


<div class="tablenoborder"><a name="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68__GUID-2CEA8D77-49CB-4C7B-953D-A811C208C6FC"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68__GUID-2CEA8D77-49CB-4C7B-953D-A811C208C6FC" frame="border" border="1" rules="all">
<tbody>
<tr>
<td class="cellrowborder" align="center" valign="top"><strong>Operation (xxx)</strong></td>

<td class="cellrowborder" align="center" valign="top"><strong>First argument</strong></td>

<td class="cellrowborder" align="center" valign="top"><strong>Second Argument</strong></td>

<td class="cellrowborder" align="center" valign="top"><strong>Third Argument</strong></td>

<td class="cellrowborder" align="center" valign="top"><strong>Fourth Argument</strong></td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">load</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">store</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Data to be stored.</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">swp</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Data to be swapped.</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">cas</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Address of the data to be compared.</td>

<td class="cellrowborder" align="center" valign="top">New contents of the address specified in the first parameter,
if the comparison is true.</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">add</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Data to be added.</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">and</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Data to be used in the AND operation .</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">ior</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Data to be used in the OR operation.</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">xor</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Data to be used in the XOR operation.</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">axo</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Data to be used in the AND operation.</td>

<td class="cellrowborder" align="center" valign="top">Data to be used in the XOR operation.</td>

<td class="cellrowborder" align="center" valign="top">N/A</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">tau</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Value of the threshold.</td>

<td class="cellrowborder" align="center" valign="top">See note 1.</td>

<td class="cellrowborder" align="center" valign="top">See note 2.</td>

</tr>

<tr>
<td class="cellrowborder" align="center" valign="top">tas</td>

<td class="cellrowborder" align="center" valign="top">address of the data</td>

<td class="cellrowborder" align="center" valign="top">Value of the threshold.</td>

<td class="cellrowborder" align="center" valign="top">See note 1.</td>

<td class="cellrowborder" align="center" valign="top">See note 2.</td>

</tr>

</tbody>

</table>
</div>

<div class="p"><div class="note"><span class="notetitle">Note:</span> </div>
</div>

<p> 1. Value to add if the value of the data pointed to by the address in
the first parameter, is equal to or greater than the threshold value</p>

<p>2. Value to add if the value of the data pointed to by the address in the
first parameter, is less than the threshold.</p>

<div class="section" id="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68__GUID-C56AD38F-DF1F-4872-9BE9-C7A255695C26"><a name="GUID-1F280171-A3F3-4129-8DBE-3B1C4D629C68__GUID-C56AD38F-DF1F-4872-9BE9-C7A255695C26"><!-- --></a><h2 class="sectiontitle">Example</h2> 
     <p>An example of an atomic operation in use is :</p>
<pre class="codeblock">              if (__e32_atomic_tas_ord32(&amp;buffer.iDisplayDriverCount, 1, -1, 0) == 1)
                  {
                      // All drivers disconnected, deallocate memory.
                      ...
                  }</pre>
<p>In the above example we use a fully ordered
memory to compare a threshold value of 1. If the value of <samp class="codeph">&amp;buffer.iDisplayDriverCount</samp> is
greater than or equal to 1 then it is added with -1 and the final value of <samp class="codeph">&amp;buffer.iDisplayDriverCount</samp> is
returned. If the value of <samp class="codeph">&amp;buffer.iDisplayDriverCount</samp> is
not greater than or equal to 1, the value of <samp class="codeph">&amp;buffer.iDisplayDriverCount</samp> is
added with 0 and returned. The driver are disconnected when the returned value
is equal to 1.</p>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-CE72E71B-6ED3-4961-B4C5-C43D823ACA9D.html" title="Symmetric Multiprocessing (SMP) applies to a multiprocessor computer architecture where 2 or more identical processes can connect to a single shared main memory. SMP allows simultaneous execution of threads. This means that overall performance is improved and ultimately battery life is extended. This section introduces the main concepts applied to SMP including Threading Models, Interrupt Handling, Locking and Memory Barriers.">SMP Concepts</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-387E98B0-568D-4DBB-9A9E-616E41E96B58.html" title="This document introduces Symmetric Multiprocessing (SMP) on the Symbian platform.">SMP - Overview</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>