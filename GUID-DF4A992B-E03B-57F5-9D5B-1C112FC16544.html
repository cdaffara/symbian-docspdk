<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Example for Creating a Default Certificate Store"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-2663ED06-8C97-5867-B7F6-6167EBFEA223.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A5DCCEB1-77DA-53C9-A1A3-07615DFCD403.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-93C32496-036F-5000-B6FD-CAECAD21DEB8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-4462E8C8-CF27-5F3B-ACE3-4213DA6C377C.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Example for Creating a Default Certificate Store</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2858558 id2859383 id2859628 id2859642 id2859657 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html">OS Security Guide</a> &gt; <a href="GUID-2663ED06-8C97-5867-B7F6-6167EBFEA223.html">Crypto Services</a> &gt; <a href="GUID-A5DCCEB1-77DA-53C9-A1A3-07615DFCD403.html">File-Based Certificate and Key Stores</a> &gt; <a href="GUID-93C32496-036F-5000-B6FD-CAECAD21DEB8.html">certtool</a> &gt; <a href="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html">certtool Tutorials</a> &gt; </div>
<h1 class="topictitle1">Example
for Creating a Default Certificate Store</h1>
<div>
<p>This section provides details on how the <samp class="codeph">certtool</samp> can
be used to create a default certstore to be used in a new device. For instance,
a device creator would want to create a default certstore to be shipped with
every device. The default certstore will most likely contain some default
root certificates. </p>

<p>User certificates might be added as well, for instance a device creator
might add a user certificate to allow a particular device to authenticate
itself during a SSL/TLS connection. In this manner the server will be sure
it is interacting with a certain device model. </p>

<p><strong>The internal representation of a certificate store </strong> </p>

<p>The contents of a certificate store are preserved in two files, CAcerts.dat
and certclients.dat. An actual device would store the default files in ROM,
from there the files will be copied to RAM when the certstore is first used.
The original ROM files are copied to RAM only if the files are not there already. </p>

<p>The paths where the files are stored in ROM are: </p>

<ul>
<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-A8FD8FBB-D3E1-51CB-8851-0F3E93875BA6"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-A8FD8FBB-D3E1-51CB-8851-0F3E93875BA6"><!-- --></a><p> <span class="filepath">z:\System\Data\CACerts.dat</span>  </p>
 </li>

<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-840018D2-0200-5276-9696-C6BDA6AD75B0"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-840018D2-0200-5276-9696-C6BDA6AD75B0"><!-- --></a><p> <span class="filepath">z:\System\Data\certclients.dat</span>  </p>
 </li>

</ul>

<p>The paths where the files are stored in RAM are: </p>

<ul>
<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-6C0E43B6-5C5F-5DC8-9030-09376F3E86AF"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-6C0E43B6-5C5F-5DC8-9030-09376F3E86AF"><!-- --></a><p> <span class="filepath">c:\System\Data\CACerts.dat</span>  </p>
 </li>

<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-999CFC77-565B-579A-A64E-2AD9B10B013A"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-999CFC77-565B-579A-A64E-2AD9B10B013A"><!-- --></a><p> <span class="filepath">c:\System\Data\certclients.dat </span>  </p>
 </li>

</ul>

<p>The full paths for the emulator in ROM are: </p>

<ul>
<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-26756A2A-1148-531D-AFCD-A7C101C6C191"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-26756A2A-1148-531D-AFCD-A7C101C6C191"><!-- --></a><p> <span class="filepath">\epoc32\release\(platform)\(build)\z\
             System\Data\CACerts.dat</span>  </p>
 </li>

<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-25213156-B9D1-5A9F-BD4E-26B026D02C6A"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-25213156-B9D1-5A9F-BD4E-26B026D02C6A"><!-- --></a><p> <span class="filepath">\epoc32\release\(platform)\(
build)\z\              System\Data\certclients.dat </span>  </p>
 </li>

</ul>

<p>The full paths for the emulator in RAM are: </p>

<ul>
<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-3A4B028D-A8B4-5B1A-8867-B08A3A48CBB7"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-3A4B028D-A8B4-5B1A-8867-B08A3A48CBB7"><!-- --></a><p> <span class="filepath">\epoc32\(platform)\c\
System\Data\CACerts.dat</span>  </p>
 </li>

<li id="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-021DCED1-D59D-5CDC-AD6B-ED3BD4D0EBF4"><a name="GUID-DF4A992B-E03B-57F5-9D5B-1C112FC16544__GUID-021DCED1-D59D-5CDC-AD6B-ED3BD4D0EBF4"><!-- --></a><p> <span class="filepath">\epoc32\(platform)\c\
System\Data\certclients.dat </span>  </p>
 </li>

</ul>

<p>where (platform) stands for wins, winscw, armi, etc. and (build) for either
udeb or urel. </p>

<p>If the files are not present in RAM, when the certstore is first used the
files are copied from ROM. If the files are not present at all, new empty
ones will be created, this event should not occur in production devices. </p>

<p><strong>Generating a default certificate store </strong> </p>

<p>You can generate a default certificate store (the two files, CACerts.dat
and certclients.dat) using <samp class="codeph">certtool</samp> and the emulator. You
can then take the resulting CACerts.dat and certclients.dat files and insert
them in the final rom. </p>

<p>To have a certificate store containing two certificates <span class="filepath">Class1PrimaryCA.cer</span> and <span class="filepath">serverca.cer</span>,
the first step is to copy them to the emulator c drive. Copy them to a location,
say <span class="filepath">\epoc32\(platform)\c</span>. </p>

<p>Use <samp class="codeph">certtool</samp> to import the two certificates. Start the
eshell: <span class="filepath">\epoc32\release\(platform)\(build)\eshell.exe</span>. </p>

<p>From the shell, import the certificates: </p>

<p><kbd class="userinput">certtool –label “Class 1” –import c:\Class1PrimaryCA.cer</kbd> </p>

<p><kbd class="userinput">certtool –label “Server CA” –import c:\serverca.cer</kbd> </p>

<p>The next step is to set the applicability of the certificates. If the “Class
1” certificate is to be trusted for software installation, SSL/TLS and OCSP,
while the “Server CA” must be trusted for software installation only, you
can then use <samp class="codeph">certtool</samp> in the following manner: </p>

<p><kbd class="userinput">certtool -setapps –apps SWInstall SSL/TLS SWInstallOCSP “Class
1”</kbd> </p>

<p><kbd class="userinput">certtool -setapps –apps SWInstall “Server CA”</kbd> </p>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html">certtool Tutorials</a></div>
</div>
<div class="relinfo relref"><strong>Related reference</strong><br/>
<div><a href="GUID-4462E8C8-CF27-5F3B-ACE3-4213DA6C377C.html">certtool
Reference</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>