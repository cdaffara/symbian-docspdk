<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Decrypting RTCP Packet Data"/>
<meta name="DC.Relation" scheme="URI" content="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-690FD404-5F40-5A0B-BE71-A4A310DF1C0E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-06370120-7738-5694-9A8C-3B5B1E3A4352.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-425A208C-5D2D-55FD-8623-9E00006E2781.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-372B7A9F-261E-5F3F-B114-4BE2FE2EF7C7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-79846EA2-33CD-5D01-8E96-6092C15BD839.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-922F292E-9420-593B-B226-2764C5F29DF9.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6E1AC4C9-7CA3-503A-AFC0-BAF29CCA8290.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B9BD2E0A-F214-5344-91A6-E4E99F0D74C8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Decrypting RTCP Packet Data</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2397554 id2398072 id2398087 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html">Multimedia Protocols Guide</a> &gt; <a href="GUID-690FD404-5F40-5A0B-BE71-A4A310DF1C0E.html" title="The Secure Real-Time Transport Protocol (SRTP) is defined as a profile of RTP. SRTP provides confidentiality, message authentication, and replay protection to the RTP traffic. It also protects the traffic of Real-time Transport Control Protocol (RTCP).">Secure Real-Time Transport Protocol</a> &gt; <a href="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html">Tutorials:Index</a> &gt; </div>
<h1 class="topictitle1">Decrypting
RTCP Packet Data</h1>
<div><div>SRTP generates SRTP packets from the RTP or RTCP stream and forwards
the packets to the receiver. SRTP transforms incoming SRTP packets to RTP/RTCP
packets and passes them up the stack. To ensure the confidentiality of the
packet content, data encryption is used. Encrypted RTP packet data is encapsulated
for transmission in a single lower-layer packet as a unit. The presence of
encryption and the correct usage of key are confirmed by the receiver through
header and payload validity checks.   <p/>
At the receiving end, the packet
is authenticated first. Authentication is followed by is decoding the encrypted
payload. This process is known as decryption. Decryption requires a decryption
key.<p/>
</div>

<div class="p"><p>An SRTP session must be created and initialized before an application
requests for a RTCP payload decryption. </p>
 </div>

<a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-CFD08369-E326-5C0D-B3D1-20B1C8C7BEE2"><!-- --></a><ol id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-CFD08369-E326-5C0D-B3D1-20B1C8C7BEE2"><li class="stepexpand" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-41BF395B-F3A0-5F32-9779-452E83CCDBD3"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-41BF395B-F3A0-5F32-9779-452E83CCDBD3"><!-- --></a><span>An application requests
for decryption of RTCP packet. </span>
</li>
<li class="stepexpand" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-9F86B8B4-D036-5414-BD50-0CBAAF6D4F0E"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-9F86B8B4-D036-5414-BD50-0CBAAF6D4F0E"><!-- --></a><span>The SRTP DLL checks
for the cryptographic context of the input stream. If a match is not found,
SRTP DLL checks for the cryptographic context of the session. </span>
</li>
<li class="stepexpand" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-3E04E9F0-EB72-5225-9769-9F58018F2D22"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-3E04E9F0-EB72-5225-9769-9F58018F2D22"><!-- --></a><span>The SRTP DLL checks
the replay list for the packet index. If a packet with the same index is found
in the replay list the packet is dropped. </span>
</li>
<li class="stepexpand" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-DFD6C096-6EAD-5217-9B58-FA4531FFF2C7"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-DFD6C096-6EAD-5217-9B58-FA4531FFF2C7"><!-- --></a><span>The SRTP DLL computes
the authentication tag for the packet. The computed tag is matched with the
tag in the packet. If the tags match, the packet is accepted and the packet
index is added to the replay list. </span>
</li>
<li class="stepexpand" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-32C9E93C-7AAA-5039-B705-FD8A665E69EA"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-32C9E93C-7AAA-5039-B705-FD8A665E69EA"><!-- --></a><span/><br/>
 The packet is decrypted using <a href="GUID-8B875E75-DD09-3E4D-9FC6-152091869BA2.html"><span class="apiname">UnprotectRTCPL()</span></a> API
of the class <a href="GUID-8B875E75-DD09-3E4D-9FC6-152091869BA2.html"><span class="apiname">CSRTPSession</span></a>.The session
keys in the cryptographic context of the current SRTP session are used for
decryption. 
<a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-64F100C5-B100-5362-B196-053822365927"><!-- --></a><ol type="a" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-64F100C5-B100-5362-B196-053822365927">
<li class="substepexpand" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-CC7F0063-A04A-5878-BCCB-380946857800"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-CC7F0063-A04A-5878-BCCB-380946857800"><!-- --></a><span/><br/>
 The prototype for the <samp class="codeph">API UnprotectRTCPL()</samp> is as described
below. 
 <pre class="codeblock" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-6B0B89C1-9085-5674-8C5F-8E3C6A297AE5"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-6B0B89C1-9085-5674-8C5F-8E3C6A297AE5"><!-- --></a>
                     IMPORT_C HBufC8* UnprotectRTCPL(TUint aSSRC, const TDesC8&amp; aPacket);
                  </pre>
 

 This API is invoked if the session finds a match stream and unprotect
stream. 
 aSSRC is the input parameter that contains the Synchronisation Source(SSRC).
Synchronisation Source is the source for the stream of RTP packets identified
by a 32 bit numeric. SSRC identifier is a part of the RTCP packet header. 
 aPacket is the input parameter that contains packet to be unprotected.
The length of descriptor should match the actual data length. A mismatch in
the length descriptor and actual length may lead to incorrect encryption. 
 HBufC8 is the output parameter that contains the decrypted packet. 
 <p>The API leaves, if matching stream is not found. </p>
 <p>In
late binding cases, the API tries to find a stream with SSRC is equal to zero
and unprotect the packet. </p>
 
</li>

</ol>

</li>
<li class="stepexpand" id="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-13C77140-79F2-5D9B-8483-823C1414889C"><a name="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC__GUID-13C77140-79F2-5D9B-8483-823C1414889C"><!-- --></a><span>The SRTP DLL updates
the count of packets decrypted. </span>
</li>
</ol>

<div class="section"><p>On successful execution of the API, decrypted data is returned. </p>
 <p>If
any of the above mentioned checks fail, the packet is discarded. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html">Tutorials:Index</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-06370120-7738-5694-9A8C-3B5B1E3A4352.html">Creating
an SRTP                 Session</a></div>
<div><a href="GUID-425A208C-5D2D-55FD-8623-9E00006E2781.html">Creating
a                 Cryptographic Context</a></div>
</div>
<div class="relinfo reltasks"><strong>Related tasks</strong><br/>
<div><a href="GUID-372B7A9F-261E-5F3F-B114-4BE2FE2EF7C7.html">Creating
an SRTP                 Stream</a></div>
<div><a href="GUID-79846EA2-33CD-5D01-8E96-6092C15BD839.html">Encrypting
                RTCP Packet Data</a></div>
<div><a href="GUID-922F292E-9420-593B-B226-2764C5F29DF9.html">Encrypting
RTP                 Packet Data</a></div>
<div><a href="GUID-6E1AC4C9-7CA3-503A-AFC0-BAF29CCA8290.html">Decrypting
RTP                 Packet Data</a></div>
<div><a href="GUID-B9BD2E0A-F214-5344-91A6-E4E99F0D74C8.html">Updating
Master                 Key</a></div>
<div><a href="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC.html">Managing
                Master Key</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>