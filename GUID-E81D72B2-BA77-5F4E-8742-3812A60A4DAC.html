<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="How to use modifiable buffer descriptor — TBuf&lt;TInt&gt;"/>
<meta name="abstract" content="Modifiable buffer descriptors are useful for holding strings or data and providing safe ways to access and modify that data."/>
<meta name="description" content="Modifiable buffer descriptors are useful for holding strings or data and providing safe ways to access and modify that data."/>
<meta name="DC.Relation" scheme="URI" content="GUID-E8BEE049-6814-543B-8A88-889E434A5D92.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DBF88873-21B1-5493-8EBF-C9071D314A09.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-11EEFB3D-0414-5BEB-9D78-56A4B9154008.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E8BEE049-6814-543B-8A88-889E434A5D92.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7CB11EAD-260E-551A-85F1-FEAC975FE722.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>How to use modifiable buffer descriptor — TBuf&lt;TInt&gt;</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2392081 id2392600 id2392686 id2392788 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html" title="The User Library allows the applications and services that run on a phone to access the functionality provided by the Symbian platform Kernel.">User Library</a> &gt; <a href="GUID-DBF88873-21B1-5493-8EBF-C9071D314A09.html" title="Links to documents that describe buffers and strings.">Buffers And Strings</a> &gt; <a href="GUID-11EEFB3D-0414-5BEB-9D78-56A4B9154008.html" title="This is a list of documents that describe how to use descriptors.">Using Descriptors</a> &gt; <a href="GUID-E8BEE049-6814-543B-8A88-889E434A5D92.html" title="Explains how to use descriptors for various use cases.">How to Use Descriptors</a> &gt; </div>
<h1 class="topictitle1">How to use modifiable buffer descriptor — TBuf&lt;TInt&gt;</h1>
<div><p>Modifiable buffer descriptors are useful for holding strings
or data and providing safe ways to access and modify that data.</p>

<ul>
<li id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-F276E9FE-B839-54ED-9F50-8E45CB094922"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-F276E9FE-B839-54ED-9F50-8E45CB094922"><!-- --></a><p>For text data,
it is usual to construct a <samp class="codeph">TBuf&lt;TInt&gt;</samp> type and
allow the appropriate variant, either a <samp class="codeph">TBuf8&lt;TInt&gt;</samp> or a <samp class="codeph">TBuf16&lt;TInt&gt;</samp> to be selected at build time.</p>
 </li>

<li id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-9860DB57-62C3-5295-B00E-5F629771FED9"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-9860DB57-62C3-5295-B00E-5F629771FED9"><!-- --></a><p>For binary data,
an explicit <samp class="codeph">TBuf8&lt;TInt&gt;</samp> is used.</p>
 </li>

<li id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-34C95FAB-0F58-5B61-B9FC-A31588855F96"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-34C95FAB-0F58-5B61-B9FC-A31588855F96"><!-- --></a><p>It is rare to
use an explicit <samp class="codeph">TBuf16&lt;TInt&gt;</samp>.</p>
 </li>

</ul>

<p>Although, the following notes refer to the build independent types;
they are equally valid for the explicit 8 bit and 16 bit types.</p>

<div class="section" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-824524FB-98B7-4CDA-A3FD-233C7C0DDD5F"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-824524FB-98B7-4CDA-A3FD-233C7C0DDD5F"><!-- --></a><h2 class="sectiontitle">Constructing
a TBuf&lt;TInt&gt;</h2> <p>A modifiable buffer descriptor can be constructed
in a number of ways:</p>
 <ul>
<li id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-BCFAA769-D038-5A09-B6BF-586C93F08B0B"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-BCFAA769-D038-5A09-B6BF-586C93F08B0B"><!-- --></a><p>as an empty
buffer descriptor.</p>
 </li>

<li id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-9DE61358-D6B9-54CA-9FED-11AC29443093"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-9DE61358-D6B9-54CA-9FED-11AC29443093"><!-- --></a><p>as an empty
buffer descriptor but giving it a length.</p>
 </li>

<li id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-50FB7967-79C8-5F8C-8569-36B40D14894E"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-50FB7967-79C8-5F8C-8569-36B40D14894E"><!-- --></a><p>by copying data
from any other type of descriptor.</p>
 </li>

<li id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-26E1FDDC-F0BB-5441-8F81-EF2CFA61787A"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-26E1FDDC-F0BB-5441-8F81-EF2CFA61787A"><!-- --></a><p>by copying data
from another modifiable buffer descriptor of the same size.</p>
 </li>

</ul>
 <p>The following code fragment constructs a <samp class="codeph">TBuf&lt;16&gt;</samp> object. The buffer descriptor is uninitialised, i.e. it contains
no data. The assignment operator or the <samp class="codeph">Copy()</samp> function
can be used to put data into the buffer descriptor after construction:</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-01CA390C-ECC4-56C2-A1F6-F62C2AA75E57"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-01CA390C-ECC4-56C2-A1F6-F62C2AA75E57"><!-- --></a>_LIT(KText,"Hello World!");
...
TBuf&lt;16&gt; buf1; // length of buf1 is 0
...
buf1 = KText;  // data assigned</pre>
 <p>The source descriptor
is a literal which is converted to descriptor type.</p>
 <p>The following
code fragment constructs a <samp class="codeph">TBuf&lt;16&gt;</samp> object and
sets it length to 12. No data is assigned into the descriptor.</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-FA8A1FE8-7809-5E28-B3EB-420B405DDC32"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-FA8A1FE8-7809-5E28-B3EB-420B405DDC32"><!-- --></a>...
TBuf&lt;16&gt; buf1(12); // length of buf1 is 12
...</pre>
 <p>The following code fragment constructs a <samp class="codeph">TBuf&lt;16&gt;</samp> object, initialised with the 12 characters making
up the English language phrase "Hello World!".</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-74B4614D-4273-5F9E-8A2D-1E9A8A3960D8"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-74B4614D-4273-5F9E-8A2D-1E9A8A3960D8"><!-- --></a>_LIT(KText,"Hello World!");
...
TBuf&lt;16&gt; buf1(KText);</pre>
 <p>The following code fragment
constructs a <samp class="codeph">TBuf&lt;16&gt;</samp> object from another <samp class="codeph">TBuf&lt;16&gt;</samp> object. This is, in effect, copy construction.</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-BE55436F-FDB8-5768-947F-801D02FDA631"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-BE55436F-FDB8-5768-947F-801D02FDA631"><!-- --></a>_LIT(KText,"Hello World!");
...
TBuf&lt;16&gt; buf1(KText);
TBuf&lt;16&gt; buf2(buf1);   // buf2 constructed from the data in buf1</pre>
 <p>In both of these cases, the resulting length of the descriptor
is 12.</p>
 <p>A non-modifiable buffer descriptor can also be constructed
from 'C' style zero terminated string. However, this is rarely necessary
but may make it easier to port legacy 'C' code.</p>
 </div>

<div class="section" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-8A534041-1730-43FB-8FCD-4C5BFDAAE730"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-8A534041-1730-43FB-8FCD-4C5BFDAAE730"><!-- --></a><h2 class="sectiontitle">Replacing
data</h2> <p>Data within a modifiable buffer descriptor can be
completely replaced through the assignment operator or by using the <samp class="codeph">Copy()</samp> function.</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-D990C115-DD84-5E04-89DA-F483A63D03FA"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-D990C115-DD84-5E04-89DA-F483A63D03FA"><!-- --></a>_LIT(KText,"Hello World!");
_LIT(KNewText,"New text");
_LIT(KReplaced,"Replaced");
...
TBuf&lt;16&gt; buf1(KText);
TBuf&lt;16&gt; buf2;
...
buf2 = buf1;               // buf2 now contains "Hello World!"
...
buf2 = KNewText;           // buf2 now contains "New text".
                           // the literal is converted to a descriptor
                           // type.
buf2.Copy(KReplaced);      // buf2 content replaced using Copy()</pre>
 </div>

<div class="section" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-E49444E0-457E-4645-A1D5-C350FF998F9A"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-E49444E0-457E-4645-A1D5-C350FF998F9A"><!-- --></a><h2 class="sectiontitle">Accessing
and changing data</h2> <p>Once a modifiable buffer descriptor has
been constructed, the functions in the base classes, <samp class="codeph">TDesC</samp> and <samp class="codeph">TDes</samp>, are available to be access and change
the data.</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-386035F7-1C0F-5CB3-BA5B-5E0EF18DF6F8"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-386035F7-1C0F-5CB3-BA5B-5E0EF18DF6F8"><!-- --></a>_LIT(KText,"Hello World!");
...
TBufC&lt;16&gt; buf1(KText);
...
buf1.Length();</pre>
 <p>and</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-7BCC4118-4294-5607-A92B-5DBA9E68CBEE"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-7BCC4118-4294-5607-A92B-5DBA9E68CBEE"><!-- --></a>_LIT(KText,"Hello World!");
...
TBufC&lt;16&gt; buf1(KText);   // length is 12 
...
buf1.Delete(6,6);        // length is now 6, leaving "Hello" in
                         // the buffer</pre>
 </div>

<div class="section" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-970BCE5F-CC4D-4F60-91A9-6107975E9C3F"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-970BCE5F-CC4D-4F60-91A9-6107975E9C3F"><!-- --></a><h2 class="sectiontitle">Illegal
access causing an exception</h2> <p>The following code fragment
raises a panic because of an attempt to assign too much data. The
maximum length of the buffer descriptor is 16 but the length of the
data to be copied is 31:</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-38DC46A1-E2A0-52DD-A821-F0D6B2C45430"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-38DC46A1-E2A0-52DD-A821-F0D6B2C45430"><!-- --></a>_LIT(KText,"Hello World! The sun is shining");
...
TBufC&lt;16&gt; buf1(KText);</pre>
 <p>The following code fragment
raises a panic because of an attempt to delete data outside the boundary
defined by the descriptor:</p>
 <pre class="codeblock" id="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-71FB3EFC-BFBA-5072-ADD2-3471E2A08D0C"><a name="GUID-E81D72B2-BA77-5F4E-8742-3812A60A4DAC__GUID-71FB3EFC-BFBA-5072-ADD2-3471E2A08D0C"><!-- --></a>_LIT(KText,"Hello World!");
...
TBufC&lt;16&gt; buf1(KText);
buf1.Delete(99,1);</pre>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-E8BEE049-6814-543B-8A88-889E434A5D92.html" title="Explains how to use descriptors for various use cases.">How to Use Descriptors</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-7CB11EAD-260E-551A-85F1-FEAC975FE722.html" title="Description and how to use literal descriptors.">Literal Descriptors</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>