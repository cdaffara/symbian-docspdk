<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Licensee TSY Tutorial"/>
<meta name="abstract" content="This topic describes how to implement a licensee TSY."/>
<meta name="description" content="This topic describes how to implement a licensee TSY."/>
<meta name="DC.Relation" scheme="URI" content="GUID-F4A99C9F-21E8-57BF-9DE7-EA6C091C22E5.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F4A99C9F-21E8-57BF-9DE7-EA6C091C22E5.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Licensee TSY Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2563496 id2562268 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html" title="Cellular Baseband Services provide a common interface to telephony services for applications and higher level platform components. The framework is independent of the underlying network services.">Cellular Baseband Services Guide</a> &gt; <a href="GUID-F4A99C9F-21E8-57BF-9DE7-EA6C091C22E5.html" title="Telephony server plug-ins translate modem messages into Symbian platform types. Symbian platform provides interfaces which must be implemented in the TSY for effective communication between the modem and Symbian platform. This section describes the telephony server plug-ins (TSYs).">Telephony Server Plug-ins</a> &gt; </div>
<h1 class="topictitle1">Licensee
TSY Tutorial </h1>
<div><p>This topic describes how to implement a licensee TSY. </p>


<div class="section" id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-34A5E710-A1BC-534F-BD8A-FFECCB3845AF"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-34A5E710-A1BC-534F-BD8A-FFECCB3845AF"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p><strong>LTSY
functionality</strong> </p>
 <p>The following functionality is implemented by the
device creators in the LTSY. </p>
 <ul>
<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-EF0607D8-9501-5B78-823B-8D0ADF5F396F"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-EF0607D8-9501-5B78-823B-8D0ADF5F396F"><!-- --></a><p><a href="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6.html#GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-5D167910-A858-52B0-B137-096CD4862CEA">Message Router</a>  </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-A3E2D9C3-6A74-5A00-82F8-E816D4A9591A"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-A3E2D9C3-6A74-5A00-82F8-E816D4A9591A"><!-- --></a><p><a href="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6.html#GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-D8518EB6-687A-52E0-AF2A-70FAC33D2E04">Message handler</a>  </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-1B7B1D3A-732D-52ED-9EBD-E6D5E02BD7E7"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-1B7B1D3A-732D-52ED-9EBD-E6D5E02BD7E7"><!-- --></a><p><a href="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6.html#GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-56B428BB-5D79-5812-B50B-730CBC0F119B">Utility classes</a>  </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-11AC842E-924E-55D2-B24F-AE4E1F65BBE0"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-11AC842E-924E-55D2-B24F-AE4E1F65BBE0"><!-- --></a><p><a href="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6.html#GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-C728078B-A9FC-5779-91F9-482666203A8C">Baseband sender</a>  </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-16B5676D-4351-5510-81BA-3CF51AF4CDC3"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-16B5676D-4351-5510-81BA-3CF51AF4CDC3"><!-- --></a><p><a href="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6.html#GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-5E0A2911-7A6A-5BCF-8832-0F8FF8CB76F2">Baseband receiver</a>  </p>
 </li>

</ul>
  <p>The message router routes the telephony client requests
to the appropriate methods implemented by the licensees in the baseband. CTSY
provides the functionality through the <a href="GUID-70ABA633-AA88-3042-8DB9-78B88BF96D8E.html"><span class="apiname">CMmMessageRouter</span></a> class.
Licensees should implement this class to acknowledge the CTSY messages. The
message router creates and processes all the message handlers. Each CTSY request
is distinguished by a specific Inter Process Communication (IPC) value. The
IPC number is used to route the calls. When a message router receives a request
from the CTSY, it creates baseband sender and baseband receiver objects. </p>
  <p>The main function of the message handlers is
to group the CTSY requests into logical units. There is no limit on the number
of message handlers. The number of message handlers depends on the logical
grouping of baseband messages, decided by the licensees. The message handlers
implement the <a href="GUID-B7024C98-B4C4-3FB1-9339-6057CEEF2A3A.html"><span class="apiname">ExtFuncL()</span></a> entry point. The message handlers
are responsible for handling the CTSY requests and their response from the
baseband. </p>
  <p>The utility class must contain the information that can be
used by the LTSY to adapt baseband data to Symbian platform data format. The
information such as error code mapping is stored in the utility class. </p>
  <p>The purpose of the baseband sender is to send
messages to the baseband. The messages are created based upon the baseband
and should be able to get the information required to acknowledge the CTSY
requests. </p>
  <p>The main purpose of the baseband receiver is to receive
messages from the baseband and forward them to the CTSY. It is also responsible
for verifying the status of baseband and format of the data. The class must
format the data so that it can be processed by the CTSY. </p>
 </div>

<div class="section" id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-7E1BEBC6-F234-4D09-86AD-12A9CB40B1CD"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-7E1BEBC6-F234-4D09-86AD-12A9CB40B1CD"><!-- --></a><h2 class="sectiontitle">Procedure</h2> <a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-27BC9B0E-CC64-5EDC-9F8A-91193E7841BF"><!-- --></a><ol id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-27BC9B0E-CC64-5EDC-9F8A-91193E7841BF">
<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-E75E6914-C4F2-5511-AD8D-C54C1EC7155C"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-E75E6914-C4F2-5511-AD8D-C54C1EC7155C"><!-- --></a><p>Phone engine starts
during the device startup </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-0C672679-1ED4-5259-B2BB-4211DC6A77F3"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-0C672679-1ED4-5259-B2BB-4211DC6A77F3"><!-- --></a><p>Phone engine creates
the PhoneTSY.dll </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-D79F8569-287E-5D43-94A1-4C6B26403789"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-D79F8569-287E-5D43-94A1-4C6B26403789"><!-- --></a><p>PhoneTSY.dll loads the
CommonTSY.dll and the LicenseeTSY.dll </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-1E72A1CD-2D1D-5491-943F-6196ACB5979A"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-1E72A1CD-2D1D-5491-943F-6196ACB5979A"><!-- --></a><p>LicenseeTSY.dll connects
with the baseband to verify that it is ready to receive requests from the
TSY </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-3794A4DD-3514-582D-8A56-5033C964BD71"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-3794A4DD-3514-582D-8A56-5033C964BD71"><!-- --></a><p>The baseband updates
the status to the LTSY </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-DAE40C5D-A6E8-5FEB-88DC-7044721F73CC"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-DAE40C5D-A6E8-5FEB-88DC-7044721F73CC"><!-- --></a><p>Any change in the baseband
status is notified to the CTSY by the LTSY. </p>
 </li>

</ol>
  </div>

<div class="example" id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-A0CD6CFD-8727-5A40-B061-0A1D72DA0585"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-A0CD6CFD-8727-5A40-B061-0A1D72DA0585"><!-- --></a><h2 class="sectiontitle">Voice call
example</h2> <p>If a client application wants to make a call the following
sequence of events takes place after the TSY is initialised: </p>
 <a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-C2C24A4B-CB22-5C2B-A596-521764D65525"><!-- --></a><ol id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-C2C24A4B-CB22-5C2B-A596-521764D65525">
<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-02138921-E7EC-523B-8958-A35A1A5EF321"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-02138921-E7EC-523B-8958-A35A1A5EF321"><!-- --></a><p>The client application
sends a request to the telephony server. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-C6F961EE-76BE-557A-8205-5EA640A6DA46"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-C6F961EE-76BE-557A-8205-5EA640A6DA46"><!-- --></a><p>The server calls the
Dial function through the client side telephony object. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-501BD4FC-F7E2-5D50-8B6D-85E84BC3BF1A"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-501BD4FC-F7E2-5D50-8B6D-85E84BC3BF1A"><!-- --></a><p>The dial request is
processed by the CTSY and forwarded to the message manager. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-0659E831-3F4E-58C7-9D2C-E6FBFC8DD020"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-0659E831-3F4E-58C7-9D2C-E6FBFC8DD020"><!-- --></a><p>The message manager
forwards the request to the message router in LTSY. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-795EBFE4-D57D-5DD5-96C1-15373985CC67"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-795EBFE4-D57D-5DD5-96C1-15373985CC67"><!-- --></a><p>After getting the information
from the message manager, the message router calls the ExtFunc, and forwards
the request to the baseband. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-10B0AFF2-BC25-54C6-8F0D-BBA41F3095DE"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-10B0AFF2-BC25-54C6-8F0D-BBA41F3095DE"><!-- --></a><p>The baseband should
notify of the status changes and the call details to the LTSY. These details
should be forwarded to the CTSY using the Complete() method. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-0FE6C4B2-70F0-5989-AC69-2099ED293CD2"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-0FE6C4B2-70F0-5989-AC69-2099ED293CD2"><!-- --></a><p>The complete method
should return the call details with: </p>
 <ul>
<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-454C0149-12EB-58FF-80D4-FB6F926FA316"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-454C0149-12EB-58FF-80D4-FB6F926FA316"><!-- --></a><p>a <a href="GUID-6CA4F1ED-7947-3087-B618-D35858FAA3BC.html"><span class="apiname">KErrNone</span></a>,
if the call is established successfully. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-B197FB68-9D3A-589B-86E5-82520625A587"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-B197FB68-9D3A-589B-86E5-82520625A587"><!-- --></a><p>one of the GSM error
code, as specified in the <a href="GUID-87AB0DA8-E634-5D87-AD89-EFFB1090C9D0.html#GUID-87AB0DA8-E634-5D87-AD89-EFFB1090C9D0__GUID-B1BDF73C-8C31-5351-936B-CB56239E8B17">reference</a> section,
if the call establishment is unsuccessful. </p>
 </li>

</ul>
 </li>

</ol>
 </div>


<div class="section" id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-7B656AFD-A81A-5A7A-90A2-1F47858FD20C"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-7B656AFD-A81A-5A7A-90A2-1F47858FD20C"><!-- --></a><p>The events can
be logged and debugged with the <samp class="codeph">CommsDebugUtility</samp>. </p>
 <p>The
Common TSY uses the <samp class="codeph">CommsDebugUtility</samp> to log the TSY events.
The <samp class="codeph">CommsDebugUtility</samp> can be enabled by adding <strong>LOG TSY
CTSY</strong> in <em>commsdbg.ini</em> file located at <samp class="codeph">c:\logs</samp>. </p>
 </div>

<div class="section" id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-01C6CDF4-2FC4-4E22-A17C-5C65010EFD2A"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-01C6CDF4-2FC4-4E22-A17C-5C65010EFD2A"><!-- --></a><h2 class="sectiontitle">Intermediate library </h2> <p>This topic describes how
to build and load the licensee TSY. </p>
 <p><strong>System
state manager</strong> </p>
 <p>The system state manager is an ECOM plug-in used
by the CTSY. An alternative to the system state plug-in is available as a
stubbed method in <samp class="codeph">ctsy/systemstateplugin</samp>. </p>
 <p><strong>Licensee TSY intermediate library</strong> </p>
 <p> <span class="filepath">Phonetsy.tsy</span> is
the DLL that loads the common TSY and the Licensee TSY. Each device has its
own LTSY. To load the TSYs dynamically: </p>
 <ul>
<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-81F0E187-B1AF-53C8-B2A3-DA1CD58D43F3"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-81F0E187-B1AF-53C8-B2A3-DA1CD58D43F3"><!-- --></a><p>The LTSY to be used
in the device is known at ROM build time. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-F2D37F7B-7715-5DEC-9701-30F797B4D237"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-F2D37F7B-7715-5DEC-9701-30F797B4D237"><!-- --></a><p>There is only one LTSY
per device. </p>
 </li>

<li id="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-D3A5AB0F-483D-5292-9613-69BD6AB326C7"><a name="GUID-FA5782F2-3E30-5EB9-A9E2-843CB9614FD6__GUID-D3A5AB0F-483D-5292-9613-69BD6AB326C7"><!-- --></a><p>The CTSY must not load
or unload any other TSY at runtime. </p>
 </li>

</ul>
 <p>The common TSY does not use the ECOM plug-in, instead it is developed
as a <samp class="codeph">IMPLIB</samp> target type. The <samp class="codeph">IMPLIB</samp> target
will generates a <samp class="codeph">licenseetsy.lib</samp>. The runtime library is
not available. The run time library must be developed and built by the licensees.
The licensees can name and configure the LTSY modules. </p>
 <p>Licensees should
implement the interface defined by <a href="GUID-C96C7C6B-547A-3917-AA2A-2831096E8C1C.html"><span class="apiname">MLtsyFactoryV1</span></a> class
in <samp class="codeph">ctsy/licenseetsy_lib/inc/mltsyfactory.h</samp>. The UID3 value
used in the intermediate library must be the same UID3 used in the LTSY implementation. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-F4A99C9F-21E8-57BF-9DE7-EA6C091C22E5.html" title="Telephony server plug-ins translate modem messages into Symbian platform types. Symbian platform provides interfaces which must be implemented in the TSY for effective communication between the modem and Symbian platform. This section describes the telephony server plug-ins (TSYs).">Telephony Server Plug-ins</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>