<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Resizable buffer descriptors"/>
<meta name="abstract" content="Describes descriptor behaviour and resizable buffer descriptors."/>
<meta name="description" content="Describes descriptor behaviour and resizable buffer descriptors."/>
<meta name="DC.Relation" scheme="URI" content="GUID-4C4B6098-38B4-5BD0-8E58-712511EBE074.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DBF88873-21B1-5493-8EBF-C9071D314A09.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-11EEFB3D-0414-5BEB-9D78-56A4B9154008.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-4C4B6098-38B4-5BD0-8E58-712511EBE074.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-5107ABD8-6408-5501-8073-ACAF3719247B"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Resizable buffer descriptors</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2392081 id2392600 id2392686 id2392741 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html" title="The User Library allows the applications and services that run on a phone to access the functionality provided by the Symbian platform Kernel.">User Library</a> &gt; <a href="GUID-DBF88873-21B1-5493-8EBF-C9071D314A09.html" title="Links to documents that describe buffers and strings.">Buffers And Strings</a> &gt; <a href="GUID-11EEFB3D-0414-5BEB-9D78-56A4B9154008.html" title="This is a list of documents that describe how to use descriptors.">Using Descriptors</a> &gt; <a href="GUID-4C4B6098-38B4-5BD0-8E58-712511EBE074.html" title="These documents describe the descriptor types">Descriptor Types</a> &gt; </div>
<h1 class="topictitle1">Resizable
buffer descriptors</h1>
<div><p>Describes descriptor behaviour and resizable buffer descriptors.</p>

<p>A resizable buffer descriptor provides a buffer, allocated on the heap,
to contain and access data. The data is not part of the descriptor object. </p>

<p>The data represented by this descriptor can be both accessed and changed
through the descriptor itself. Data is accessed through functions provided
by the base class. The size of the buffer used by this descriptor can also
be changed. Note that unlike dynamic buffers, reallocation is not done automatically;
the descriptor provides an API that allows you to do reallocation. </p>

<p>The descriptor has similarities to the standard heap descriptor,<a href="GUID-A103FB19-60B3-3E45-97A5-1F295934ACA1.html"><span class="apiname">HBufC</span></a>,
but is <em>easier to use</em>. The standard heap descriptor is recommended for
use when the data it represents rarely changes. The resizable buffer descriptor
is recommended for use when the data changes frequently. </p>

<p>This descriptor also has the following additional useful behaviour: </p>

<ul>
<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-A40D7342-C864-51A3-B53B-DA73988501C2"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-A40D7342-C864-51A3-B53B-DA73988501C2"><!-- --></a><p>ownership of an existing
heap descriptor can be transferred to a resizable buffer descriptor. </p>
 </li>

<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-63EA50EE-1DD4-5ABE-9676-0347E95F07CA"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-63EA50EE-1DD4-5ABE-9676-0347E95F07CA"><!-- --></a><p>ownership of memory
that has already been allocated elsewhere can be transferred to a resizable
buffer descriptor; this memory becomes the buffer used by the descriptor. </p>
 </li>

<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-D16CAA95-26A4-5B45-AEA2-58DDB28F16CB"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-D16CAA95-26A4-5B45-AEA2-58DDB28F16CB"><!-- --></a><p>ownership of memory
owned by a resizable buffer descriptor can be transferred to another resizable
buffer descriptor. </p>
 </li>

</ul>

<p>The important point is that the user of the class need not be concerned
about the 'origins' of the memory. </p>

<p>A resizable buffer descriptor is supplied in two variants: </p>

<ul>
<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-017A1851-A5FE-5179-87BC-0F0BF748761A"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-017A1851-A5FE-5179-87BC-0F0BF748761A"><!-- --></a><p>a 16-bit variant, a <a href="GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html"><span class="apiname">RBuf16</span></a>,
to contain wide strings, and 16-bit wide data. </p>
 </li>

<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-55A2D978-C16A-58E7-BE55-9CB681484473"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-55A2D978-C16A-58E7-BE55-9CB681484473"><!-- --></a><p>an 8-bit variant, a <a href="GUID-955061A8-A83E-39E5-8745-8FAC7DEA7BCC.html"><span class="apiname">RBuf8</span></a>,
to contain narrow strings and binary data. </p>
 </li>

</ul>

<p>There is also a build independent type, <a href="GUID-BFBC574B-EFF6-37A4-9189-B71DA1505BC8.html"><span class="apiname">RBuf</span></a>. This is
the type that is most commonly used in program code; this is set (i.e. typedef)
to the appropriate 'real' variant at build time, and by default equates to <a href="GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html"><span class="apiname">RBuf16</span></a>. </p>

<p>You would use an explicit 8-bit variant for binary data. An explicit 16-bit
variant is rarely used. </p>

<p>When discussing a resizable buffer descriptor, we normally refer to <a href="GUID-BFBC574B-EFF6-37A4-9189-B71DA1505BC8.html"><span class="apiname">RBuf</span></a>,
rather than <a href="GUID-955061A8-A83E-39E5-8745-8FAC7DEA7BCC.html"><span class="apiname">RBuf8</span></a> or <a href="GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html"><span class="apiname">RBuf16</span></a>. We only
refer to <samp class="codeph">RBuf8</samp> or <samp class="codeph">RBuf16</samp> when they explicitly
need to be used. </p>

<p>The following drawing shows how an <samp class="codeph">RBuf</samp> type is constructed.
It is derived from <a href="GUID-49D4E917-57EA-39AE-8941-144AA8AC2584.html"><span class="apiname">TDes</span></a> and <a href="GUID-52D07F46-2162-380C-A775-C3BB335C42F5.html"><span class="apiname">TDesC</span></a>; the
member data of these base classes hold the length and maximum length for the
descriptor data. <samp class="codeph">RBuf</samp> itself only contains a single pointer.
The pointer is interpreted in one of two ways, depending on how its buffer
has been set up: </p>

<ul>
<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-8EB79399-9FAF-5CFE-9542-C015215B0D8D"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-8EB79399-9FAF-5CFE-9542-C015215B0D8D"><!-- --></a><p>as a simple pointer
to memory on the heap. </p>
 </li>

<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-645528B9-2786-59E1-9F6F-7DD875AE1B1E"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-645528B9-2786-59E1-9F6F-7DD875AE1B1E"><!-- --></a><p>as a pointer to a previously
created <a href="GUID-A103FB19-60B3-3E45-97A5-1F295934ACA1.html"><span class="apiname">HBufC</span></a> heap descriptor; ownership of the <samp class="codeph">HBufC</samp> descriptor
buffer will have been transferred to the <samp class="codeph">RBuf</samp>. </p>
 </li>

</ul>

<p>The way descriptors in Symbian platform are implemented allows <a href="GUID-BFBC574B-EFF6-37A4-9189-B71DA1505BC8.html"><span class="apiname">RBuf</span></a> to
distinguish between the two. </p>

<p>The following drawing shows the internal representation of an <samp class="codeph">RBuf</samp> object
initialised with a string of five characters representing the English word
"Hello". There are two possibilities: </p>

<ul>
<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-3934910A-431A-582A-A117-3B1C497CE880"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-3934910A-431A-582A-A117-3B1C497CE880"><!-- --></a><p>the case where the buffer
consists of simple memory, either allocated directly by the object itself,
or assigned to it after having been allocated elsewhere. </p>
 </li>

<li id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-5AD86C97-66DF-5B88-95D7-2169D4CFD8A2"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-5AD86C97-66DF-5B88-95D7-2169D4CFD8A2"><!-- --></a><p>the case where the buffer
was originally allocated as a standard heap descriptor, a <a href="GUID-A103FB19-60B3-3E45-97A5-1F295934ACA1.html"><span class="apiname">HBufC</span></a> type,
and whose ownership has been transferred. </p>
 </li>

</ul>

<p>Remember that <samp class="codeph">RBuf</samp> is derived from both <samp class="codeph">TDes</samp> and <samp class="codeph">TDesC</samp>,
and these classes provide the data members the contain the maximum length
and the current length of the data. </p>

<div class="fignone" id="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-50810FFC-9A97-5EC1-B6A6-7E371AEC9FF6"><a name="GUID-5107ABD8-6408-5501-8073-ACAF3719247B__GUID-50810FFC-9A97-5EC1-B6A6-7E371AEC9FF6"><!-- --></a>
<img src="GUID-2F0008EB-715C-50EC-87AD-C78619F44858_d0e326684_href.png"/>
</div>

<p>While an <samp class="codeph">RBuf</samp> descriptor has similarities to a heap descriptor,
it behaves more like a standard 'R' type resource class, i.e. as a handle
to a real resource maintained elsewhere. </p>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-4C4B6098-38B4-5BD0-8E58-712511EBE074.html" title="These documents describe the descriptor types">Descriptor Types</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>