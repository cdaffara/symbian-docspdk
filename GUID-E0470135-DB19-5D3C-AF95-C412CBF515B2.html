<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Multimode Messaging"/>
<meta name="abstract" content="The Multimode telephony API provides a number of specialised messaging classes that are derived from RTelSubSessionBase. One of the classes is responsible for SMS, another for Broadcast and another for USSD messaging."/>
<meta name="description" content="The Multimode telephony API provides a number of specialised messaging classes that are derived from RTelSubSessionBase. One of the classes is responsible for SMS, another for Broadcast and another for USSD messaging."/>
<meta name="DC.Relation" scheme="URI" content="GUID-F54AE37C-EE84-550F-B6AD-47DC213CCCA0.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D49696D1-4B84-56B5-909D-A15F599F4B6D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BBF6E33F-2E9C-5BB1-8404-87289EC73BFF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F54AE37C-EE84-550F-B6AD-47DC213CCCA0.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B8F07736-F598-59F0-A004-02A8CBE40554.html#GUID-B8F07736-F598-59F0-A004-02A8CBE40554/GUID-E6D28D2B-5201-569E-881D-1D5A0BDC41B0"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Multimode Messaging</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2563496 id2563017 id2562829 id2562825 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html" title="Cellular Baseband Services provide a common interface to telephony services for applications and higher level platform components. The framework is independent of the underlying network services.">Cellular Baseband Services Guide</a> &gt; <a href="GUID-D49696D1-4B84-56B5-909D-A15F599F4B6D.html">Telephony Server</a> &gt; <a href="GUID-BBF6E33F-2E9C-5BB1-8404-87289EC73BFF.html" title="The ETel multimode API enables access to common mobile telephony services for a number of air-interface cellular standards or modes. It also enables access to specialised services within the GSM and CDMA IS-95 standards and provides an API that allows switching between supported modes. Currently, GSM, CDMA (IS-95 and cdma2000) and WCDMA (3GPP rel '99) modes are the fully supported modes.">Multimode Telephony</a> &gt; <a href="GUID-F54AE37C-EE84-550F-B6AD-47DC213CCCA0.html">Concepts</a> &gt; </div>
<h1 class="topictitle1">Multimode
Messaging</h1>
<div><p>The Multimode telephony API provides a number of specialised messaging
classes that are derived from <samp class="codeph">RTelSubSessionBase</samp>. One of
the classes is responsible for SMS, another for Broadcast and another for
USSD messaging. </p>

<p>The following table describes the three messaging types. </p>


<div class="tablenoborder"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-E54D8AA1-BC1F-5706-B1BA-9193BB33FE0E"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-E54D8AA1-BC1F-5706-B1BA-9193BB33FE0E" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" id="d2005846e32">Type</th>

<th class="cellrowborder" valign="top" id="d2005846e35">Required</th>

<th class="cellrowborder" valign="top" id="d2005846e38">GSM</th>

<th class="cellrowborder" valign="top" id="d2005846e41">WCDMA</th>

<th class="cellrowborder" valign="top" id="d2005846e44">CDMA</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" headers="d2005846e32 "><p> <a href="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2.html#GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DF523227-DADA-578A-8816-3144C7125663">SMS
messaging</a>  </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e35 "><p>No </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e38 "><p>Yes </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e41 "><p>Yes </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e44 "><p>Yes </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="d2005846e32 "><p> <a href="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2.html#GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DA0E39B0-0051-50AA-9A62-C9BC9E25A7F0">Broadcast
messaging</a>  </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e35 "><p>No </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e38 "><p>Yes </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e41 "><p>Yes </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e44 "><p>Yes </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="d2005846e32 "><p> <a href="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2.html#GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-35CCDB86-E5B2-5CB8-B662-50144F376221">USSD
messaging</a>  </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e35 "><p>No </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e38 "><p>Yes </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e41 "><p>Yes </p>
 </td>

<td class="cellrowborder" valign="top" headers="d2005846e44 "><p>No </p>
 </td>

</tr>

</tbody>

</table>
</div>

<div class="section" id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DF523227-DADA-578A-8816-3144C7125663"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DF523227-DADA-578A-8816-3144C7125663"><!-- --></a><h2 class="sectiontitle">SMS messaging</h2> <p> <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging</span></a> provides access
to the Short Message Service provided by GSM, WCDMA and CDMA networks. </p>
 <p>In
CDMA mode, SMS has three protocol layers: Relay lowest level, Transport and
Teleservice. Relay is the lowest level while Transport and Teleservice are
application level. <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging</span></a> provides
an interface to the Transport layer. Usually, the Teleservice layer is implemented
in a sockets protocol module. The Teleservice layer, rather than <samp class="codeph">RMobileSmsMessaging</samp>,
would be the interface used by applications to send SMS messages. SMS messages
are passed across the API as Packet Data Units (PDUs). </p>
 <p>Segmentation
and reassembly of long SMS messages over 255 bytes is not provided by the
API, and must be provided by a higher-level module such as the <span class="filepath">smsprot.prt</span> protocol
module. </p>
 <p> <samp class="codeph">RMobileSmsMessaging</samp> allows clients to: </p>
 <ul>
<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D1645129-9195-5CB4-9DC5-39952782B309"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D1645129-9195-5CB4-9DC5-39952782B309"><!-- --></a><p>open an SMS sub-session
using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::Open()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-C5FACABA-62EA-5E54-9B89-60BFEFFC8D22"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-C5FACABA-62EA-5E54-9B89-60BFEFFC8D22"><!-- --></a><p>retrieve capabilities
using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::GetCaps()</span></a>.
Capabilities are encapsulated in a packaged <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::TMobileSmsCapsV1</span></a> object. </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-67D3CF37-546D-596C-8A8E-72D3D4DE6F8F"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-67D3CF37-546D-596C-8A8E-72D3D4DE6F8F"><!-- --></a><p>retrieve the mode the
phone uses to handle incoming SMS messages before passing them on to TSY using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::GetReceiveMode()</span></a>. </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-A1687E1D-6105-58CD-A308-213C39682007"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-A1687E1D-6105-58CD-A308-213C39682007"><!-- --></a><p>set the mode the phone
uses to handle incoming SMS messages before passing them on to TSY using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::SetReceiveMode()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-9F6EADDA-BEA0-57D0-8F3E-0330C3841217"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-9F6EADDA-BEA0-57D0-8F3E-0330C3841217"><!-- --></a><p>wait for the next incoming
SMS message using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::ReceiveMessage()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DDF357F7-F520-5365-B943-4A548B888864"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DDF357F7-F520-5365-B943-4A548B888864"><!-- --></a><p>send a positive acknowledgement
for an SMS after successful decoding and storage using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::AckSmsStored()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-2BDABC27-1EA1-5022-8A2B-2C94B3287136"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-2BDABC27-1EA1-5022-8A2B-2C94B3287136"><!-- --></a><p>send a negative acknowledgement
for an SMS after failure in decoding and storage using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::NackSmsStored()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-7C0F5FE5-AAC3-50D5-9457-87C70DD7EFD5"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-7C0F5FE5-AAC3-50D5-9457-87C70DD7EFD5"><!-- --></a><p>tell the network to
resume transferring SMS to the phone, after reception has been suspended because
SMS storage is full using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::ResumeSmsReception()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DBC2E3D5-E2B6-5137-A34C-C5B5822F824C"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DBC2E3D5-E2B6-5137-A34C-C5B5822F824C"><!-- --></a><p>get the bearer type
which is CSD or packet-switched for sending SMS messages using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::SetMoSmsBearer()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-56C1FD58-8DF7-5DE2-A0E2-5A9123F77384"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-56C1FD58-8DF7-5DE2-A0E2-5A9123F77384"><!-- --></a><p>set the bearer type
using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::SetMoSmsBearer()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-ADE3F254-0E6D-5AE9-A3A9-6F70BA5B0CD4"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-ADE3F254-0E6D-5AE9-A3A9-6F70BA5B0CD4"><!-- --></a><p>be notified if the bearer
type changes using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::NotifyMoSmsBearerChange()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D1968BB6-CFBB-58C3-A935-BAE5C8B37F4D"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D1968BB6-CFBB-58C3-A935-BAE5C8B37F4D"><!-- --></a><p>send an SMS message
to the network using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::SendMessage()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-C2DF7C65-DCBF-53DA-BDFC-70BE0F98EAE2"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-C2DF7C65-DCBF-53DA-BDFC-70BE0F98EAE2"><!-- --></a><p>get the number of phone-side
SMS message stores using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::EnumerateMessageStores()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-55AAC64A-826F-5055-8E48-40F2DE17FC68"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-55AAC64A-826F-5055-8E48-40F2DE17FC68"><!-- --></a><p>get information about
a specified SMS message store indicated using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::GetMessageStoreInfo()</span></a>.
Such information is encapsulated in a packaged <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobilePhoneStore::TMobilePhoneStoreInfoV1</span></a> object. </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D1108DBA-BCD7-5D83-955A-7AB53C96C5EE"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D1108DBA-BCD7-5D83-955A-7AB53C96C5EE"><!-- --></a><p>get a list of GSM-specific
SMS parameters stored in SIM . Examples of these parameters are Service Centre
Address. Clients use <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">CRetrieveMobilePhoneSmspList</span></a> to
get the list and returns a <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">CMobilePhoneSmspList</span></a> object.
Each parameter is encapsulated in an <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileSmsMessaging::TMobileSmspEntryV1</span></a> object. </p>
 </li>

</ul>
 <p><strong>Example </strong> </p>
 <p>The following code sends the message <samp class="codeph">aPdu</samp> to
the destination <samp class="codeph">aDest</samp> over GSM. </p>
 <p>The code assumes <samp class="codeph">iMobilePhone</samp> is
an <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobilePhone</span></a> object. </p>
 <pre class="codeblock" id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D70DC6E9-0205-5AB7-B397-E63D29DCE790"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D70DC6E9-0205-5AB7-B397-E63D29DCE790"><!-- --></a>void CClientApp::SendSMSL(
        const RMobileSmsMessaging::TMobileSmsGsmTpdu&amp; aPdu, 
        const TDesC&amp; aDest)
    {
    // Open SMS session
    RMobileSmsMessaging smsSession;
    User::LeaveIfError(smsSession.Open(iMobilePhone));
    CleanupClosePushL(smsSession);

    // Get SMS capabilities
    RMobileSmsMessaging::TMobileSmsCapsV1 smsCaps;
    RMobileSmsMessaging::TMobileSmsCapsV1Pckg smsCapsPckg(smsCaps);
    User::LeaveIfError(smsSession.GetCaps(smsCapsPckg));

    // Test if SMS can be sent over GSM
    if ( smsCaps.iSmsMode &amp; RMobileSmsMessaging::KCapsGsmSms
        &amp; ( (smsCaps.iSmsControl &amp; RMobileSmsMessaging::KCapsSendWithAck ) || 
            (smsCaps.iSmsControl &amp; RMobileSmsMessaging::KCapsSendNoAck )))
        {
        // Set the required bearer
        TRequestStatus status;
        smsSession.SetMoSmsBearer(status, RMobileSmsMessaging::ESmsBearerCircuitPreferred);
        User::WaitForRequest(status);
        User::LeaveIfError(status.Int());

        // Set destination address and data format attributes
        RMobileSmsMessaging::TMobileSmsSendAttributesV1 sendAtts;
        sendAtts.iDestination.iTelNumber = aDest;
        sendAtts.iDataFormat = RMobileSmsMessaging::EFormatGsmTpdu;
        RMobileSmsMessaging::TMobileSmsSendAttributesV1Pckg sendAttsPckg(sendAtts);

        // Send the message
        smsSession.SendMessage(status, aPdu, sendAttsPckg);
        User::WaitForRequest(status);
        User::LeaveIfError(status.Int());
        }
     
    // Clean up
    CleanupStack::PopAndDestroy(); // calls smsSession.Close()
    }
</pre>
 </div>

<div class="section" id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DA0E39B0-0051-50AA-9A62-C9BC9E25A7F0"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-DA0E39B0-0051-50AA-9A62-C9BC9E25A7F0"><!-- --></a><h2 class="sectiontitle">Broadcast messaging</h2> <p> <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging</span></a> provides access
to the broadcast messaging services provided by GSM, WCDMA and CDMA networks. </p>
 <p>Clients
open an <samp class="codeph">RMobileBroadcastMessaging</samp> sub-session and then wait
for incoming broadcast messages. The broadcast messages received can depend
on a message filter that defines the languages and identifiers of acceptable
and unacceptable messages. </p>
 <p> <samp class="codeph">RMobileBroadcastMessaging</samp> allows
clients to: </p>
 <ul>
<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-434C178E-B910-5BF5-8DBD-6BCA5F6B43F5"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-434C178E-B910-5BF5-8DBD-6BCA5F6B43F5"><!-- --></a><p>open a broadcast messaging
sub-session using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::Open()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-20104F53-6D01-5331-9A12-1E180170C920"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-20104F53-6D01-5331-9A12-1E180170C920"><!-- --></a><p>get capabilities using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::GetCaps()</span></a>.
Capabilities are encapsulated in a packaged <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::TMobileBroadcastCapsV1</span></a> object. </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-AC7EBDE6-9A98-5339-8750-E92468B54FBF"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-AC7EBDE6-9A98-5339-8750-E92468B54FBF"><!-- --></a><p>wait for the next incoming
broadcast message using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::ReceiveMessage()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-1082EACA-75A7-53DB-866B-F6033F955EA5"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-1082EACA-75A7-53DB-866B-F6033F955EA5"><!-- --></a><p>get filter on and off
settings using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::GetFilterSetting()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D15B6A4F-8F25-5A69-A072-9C83137AE9E6"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-D15B6A4F-8F25-5A69-A072-9C83137AE9E6"><!-- --></a><p>set filter on and off
settings using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::SetFilterSetting()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-4998DA72-5B42-56D3-AA3E-34C421071AA6"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-4998DA72-5B42-56D3-AA3E-34C421071AA6"><!-- --></a><p>be notified when the
filter on and off settings change using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::NotifyFilterSettingChange()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-014ADE4E-57B7-53D1-87AC-9E1462AB4A2D"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-014ADE4E-57B7-53D1-87AC-9E1462AB4A2D"><!-- --></a><p>get the broadcast message
language filter using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::GetLanguageFilter()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-FACF1599-7D0F-5CC1-8064-B3040721349A"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-FACF1599-7D0F-5CC1-8064-B3040721349A"><!-- --></a><p>set the broadcast message
language filter using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::SetLanguageFilter()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-553BBB69-99AF-5396-9240-24192F7EC399"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-553BBB69-99AF-5396-9240-24192F7EC399"><!-- --></a><p>be notified when the
message language filter changes using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::NotifyLanguageFilterChange()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-4DD55A70-A8BE-5131-B4AB-C1E56650EA45"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-4DD55A70-A8BE-5131-B4AB-C1E56650EA45"><!-- --></a><p>retrieve a list of identifiers
by which to filter messages. Clients use <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">CRetrieveMobilePhoneBroadcastIdList</span></a> to
get the list, a <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">CMobilePhoneBroadcastIdList</span></a> object.
Each identifier is encapsulated in an <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::TMobileBroadcastIdEntryV1</span></a> object. </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-B3815D23-A48D-5833-BA99-9BE45DEB447C"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-B3815D23-A48D-5833-BA99-9BE45DEB447C"><!-- --></a><p>store a new version
of the entire list of filter identifiers using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::StoreBroadcastIdListL()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-16B29B8E-58B7-5B17-AE2B-2F894B0606D2"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-16B29B8E-58B7-5B17-AE2B-2F894B0606D2"><!-- --></a><p>be notified if the filter
identifier list changes using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileBroadcastMessaging::NotifyBroadcastIdListChange()</span></a>  </p>
 </li>

</ul>
 <p><strong>Example </strong> </p>
 <p>The following code gets the contents of the next
GSM broadcast message received in <samp class="codeph">aMessageData</samp>. </p>
 <pre class="codeblock" id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-239DABF4-BBEF-543F-8177-4478BA62DF9B"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-239DABF4-BBEF-543F-8177-4478BA62DF9B"><!-- --></a>void CClientApp::ReceiveBroadcastMessageL(RMobileBroadcastMessaging::TGsmBroadcastMessageData&amp; aMessageData)
    {
    // Open session
    RMobileBroadcastMessaging bmSession;
    User::LeaveIfError(bmSession.Open(iMobilePhone));
    CleanupClosePushL(bmSession);

    // Get BM capabilities
    RMobileBroadcastMessaging::TMobileBroadcastCapsV1 bmCaps;
    RMobileBroadcastMessaging::TMobileBroadcastCapsV1Pckg bmCapsPckg(bmCaps);
    User::LeaveIfError(bmSession.GetCaps(bmCapsPckg));

    // Test if GSM 03.41 cell broadcast messages are supported
    if (bmCaps.iModeCaps &amp; RMobileBroadcastMessaging::KCapsGsmTpduFormat)
        {
        // Get the next received broadcast message
        RMobileBroadcastMessaging::TMobileBroadcastAttributesV1 bmAtts;
        RMobileBroadcastMessaging::TMobileBroadcastAttributesV1Pckg bmAttsPckg(bmAtts);
        TRequestStatus status;
        bmSession.ReceiveMessage(status, aMessageData, bmAttsPckg);
        User::WaitForRequest(status);
        User::LeaveIfError(status.Int());
        }
     
    // Clean up
    CleanupStack::PopAndDestroy(); // calls bmSession.Close()
    }</pre>
 </div>

<div class="section" id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-35CCDB86-E5B2-5CB8-B662-50144F376221"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-35CCDB86-E5B2-5CB8-B662-50144F376221"><!-- --></a><h2 class="sectiontitle">USSD messaging</h2> <p>The
Unstructured Supplementary Service Data (USSD) service provided by GSM/ WCDMA
networks transmits information over the network signalling channels. </p>
 <p>USSD
is incorporated in the messaging functionality because of its potential use
as a bearer for WAP or other overlying protocol. The USSD protocol is therefore
suitable for implementation within a Sockets protocol (.PRT) module. </p>
 <p> <samp class="codeph">RMobileUssdMessaging</samp> allows
clients to: </p>
 <ul>
<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-FC45DB15-C427-53C8-84CA-835C669ED9BB"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-FC45DB15-C427-53C8-84CA-835C669ED9BB"><!-- --></a><p>open a USSD messaging
sub-session using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileUssdMessaging::Open()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-0E276A2D-C581-51A7-BAF7-07E9BB8EFC9D"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-0E276A2D-C581-51A7-BAF7-07E9BB8EFC9D"><!-- --></a><p>get capabilities using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileUssdMessaging::GetCaps()</span></a>. Capabilities
are encapsulated in a packaged <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileUssdMessaging::TMobileUssdCapsV1</span></a> object. </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-9A001189-6CEC-54BA-86CA-0C5094E9374E"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-9A001189-6CEC-54BA-86CA-0C5094E9374E"><!-- --></a><p>wait for the next incoming
USSD message using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileUssdMessaging::ReceiveMessage()</span></a>  </p>
 </li>

<li id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-60174DD0-738C-533D-86DA-159D1E86671C"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-60174DD0-738C-533D-86DA-159D1E86671C"><!-- --></a><p>send a UUSD message
using <a href="GUID-D8BBA972-82CB-3561-8913-4659103C263C.html"><span class="apiname">RMobileUssdMessaging::SendMessage()</span></a>  </p>
 </li>

</ul>
 <p><strong>Example </strong> </p>
 <p>The following code gets in <samp class="codeph">aMessageData</samp> the
contents, and in <samp class="codeph">aUssdAtts</samp> the attributes, of the next USSD
message received. </p>
 <pre class="codeblock" id="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-E82E8B54-2E8A-5D0F-A7EA-5DFEB0EA06E1"><a name="GUID-E0470135-DB19-5D3C-AF95-C412CBF515B2__GUID-E82E8B54-2E8A-5D0F-A7EA-5DFEB0EA06E1"><!-- --></a>void CClientApp::ReceiveUssdMessageL(
    RMobileUssdMessaging::TGsmUssdMessageData&amp; aMessageData,
    RMobileUssdMessaging::TMobileUssdAttributesV1&amp; aUssdAtts)
    {
    // Open session
    RMobileUssdMessaging ussdSession;
    User::LeaveIfError(ussdSession.Open(iMobilePhone));
    CleanupClosePushL(ussdSession);

    // Get ussd capabilities
    RMobileUssdMessaging::TMobileUssdCapsV1 ussdCaps;
    RMobileUssdMessaging::TMobileUssdCapsV1Pckg ussdCapsPckg(ussdCaps);
    User::LeaveIfError(ussdSession.GetCaps(ussdCapsPckg));

    // Test if USSD messages can be received
    if (ussdCaps.iUssdTypes &amp; RMobileUssdMessaging::KCapsMTUssd)
        {
        // Get the next received Ussd message
        RMobileUssdMessaging::TMobileUssdAttributesV1Pckg ussdAttsPckg(aUssdAtts);
        TRequestStatus status;
        ussdSession.ReceiveMessage(status, aMessageData, ussdAttsPckg);
        User::WaitForRequest(status);
        User::LeaveIfError(status.Int());
        }
     
    // Clean up
    CleanupStack::PopAndDestroy(); // calls ussdSession.Close()
    }</pre>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-F54AE37C-EE84-550F-B6AD-47DC213CCCA0.html">Concepts</a></div>
</div>
<div class="relinfo"><strong>Related information</strong><br/>
<div><a href="GUID-B8F07736-F598-59F0-A004-02A8CBE40554.html#GUID-B8F07736-F598-59F0-A004-02A8CBE40554__GUID-E6D28D2B-5201-569E-881D-1D5A0BDC41B0">SMS message store</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>