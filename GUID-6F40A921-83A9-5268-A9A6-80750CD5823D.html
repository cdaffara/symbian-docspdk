<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Example Showing the use of the SDP Codec API"/>
<meta name="DC.Relation" scheme="URI" content="GUID-28636BB0-2C25-5D6C-9777-41AA4F3D8F31.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-057F1F82-56AF-5696-853E-79196A3D567E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-28636BB0-2C25-5D6C-9777-41AA4F3D8F31.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Example Showing the use of the SDP Codec API</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2397554 id2397680 id2397865 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html">Multimedia Protocols Guide</a> &gt; <a href="GUID-057F1F82-56AF-5696-853E-79196A3D567E.html">SIP</a> &gt; <a href="GUID-28636BB0-2C25-5D6C-9777-41AA4F3D8F31.html">SDP Codec API</a> &gt; </div>
<h1 class="topictitle1">Example
Showing the use of the SDP Codec API</h1>
<div>
<p>The following sections explain how to create an SDP description with the
required fields. </p>

<ul>
<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-F95C20F4-0A32-588F-A5A4-25C8C0F1D687"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-F95C20F4-0A32-588F-A5A4-25C8C0F1D687"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-5184D372-53E1-5872-9DC0-63E004232D6D">Creating an SDP description</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-ADA89366-B0CD-5520-A6A1-392525042085"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-ADA89366-B0CD-5520-A6A1-392525042085"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-CD67F58C-5059-50DA-B275-CC07EC5E93EF">Creating a CSdpDocument object</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-ADF16F11-C606-55C8-9E3C-4BCC420342D7"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-ADF16F11-C606-55C8-9E3C-4BCC420342D7"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-35A2A9E8-8AE4-55EA-9DE3-C6F056A3B497">Defining the session name field for the SDP description</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-AAEAAB91-98EB-5A6C-AA18-DA850BED70EB"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-AAEAAB91-98EB-5A6C-AA18-DA850BED70EB"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-6D04653E-711E-53B3-8DC6-9A35EDE98173">Creating an instance of the Origin field class</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-EFFDBB7F-CF7A-593C-826A-480DBF6D13AB"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-EFFDBB7F-CF7A-593C-826A-480DBF6D13AB"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-63EE5D34-4AD2-5FC5-8D4C-E4DDEBE4D546">Fetching the network type and the address type</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-58CDD2CF-CCF2-52B2-8C0A-134508FC14EA"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-58CDD2CF-CCF2-52B2-8C0A-134508FC14EA"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-4CE0F919-97DC-5A4B-81B1-44953792609A">Creating and setting the connection field into the sdpDocument</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-B54A2924-3AAC-5E1B-9A0B-145A532E9306"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-B54A2924-3AAC-5E1B-9A0B-145A532E9306"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-0C8C6767-7D0D-5211-88A1-E07FABFC2EDB">Defining the session part attribute and direction-attribute</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-D35AFF85-8E2D-5352-BE58-E755F3FF7D53"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-D35AFF85-8E2D-5352-BE58-E755F3FF7D53"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-7835F2BC-6D44-58D7-A662-72B636F31154">Creating the first media field</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-86DD7BAC-9C2B-5A23-8B7B-8A1FE7047CC6"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-86DD7BAC-9C2B-5A23-8B7B-8A1FE7047CC6"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-D991055C-4847-5A92-BA72-18917231C00E">Creating the second media field</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-00D37100-7CB9-5A7A-874A-325B89E59A8F"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-00D37100-7CB9-5A7A-874A-325B89E59A8F"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-F8B6AE3F-DD42-5318-9184-C7DE92B7068A">Assigning the media fields to the CSdpDocument object</a>  </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-1785FB44-679F-5C03-8B5B-44A2F5B979D0"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-1785FB44-679F-5C03-8B5B-44A2F5B979D0"><!-- --></a><p> <a href="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D.html#GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-8F23A065-184D-5725-86FC-AC5909B401BB">Deleting the sdpDocument and closing the SdpCodecStringPool</a>  </p>
 </li>

</ul>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-5184D372-53E1-5872-9DC0-63E004232D6D"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-5184D372-53E1-5872-9DC0-63E004232D6D"><!-- --></a><h2 class="sectiontitle"> Creating an
SDP description</h2> <a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-9274DB5E-2266-5CBC-94BE-A140D1AA5B8E"><!-- --></a><ol id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-9274DB5E-2266-5CBC-94BE-A140D1AA5B8E">
<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-1D695593-6D60-5FB6-9D2B-EAF58D9D1451"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-1D695593-6D60-5FB6-9D2B-EAF58D9D1451"><!-- --></a><p>Open the String Pool </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-DF565227-6809-578B-9C75-A5D06DF9DC02"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-DF565227-6809-578B-9C75-A5D06DF9DC02"><!-- --></a><p>Access the predefined
SDP constants in the string table </p>
 </li>

<li id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-44F46943-DCBA-5E12-B68D-A19DBF6DBBF7"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-44F46943-DCBA-5E12-B68D-A19DBF6DBBF7"><!-- --></a><p>Close the String Pool
after you finish with the SDP description </p>
 </li>

</ol>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-AC697A6F-FA2A-5B00-8004-DDCCEB82ADE1"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-AC697A6F-FA2A-5B00-8004-DDCCEB82ADE1"><!-- --></a>SdpCodecStringPool::OpenL();
RStringPool pool = SdpCodecStringPool::StringPoolL();
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-CD67F58C-5059-50DA-B275-CC07EC5E93EF"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-CD67F58C-5059-50DA-B275-CC07EC5E93EF"><!-- --></a><h2 class="sectiontitle"> Creating a
CSdpDocument object</h2> <p>The following code snippet shows how to create
the <a href="GUID-FF6D4EAD-3AAE-3843-8A9C-7C92426FC29F.html"><span class="apiname">CSdpDocument</span></a> object. This includes all SDP fields in
the structural format: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-6A6F8797-0DB3-5FA3-9AEC-F688B998755B"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-6A6F8797-0DB3-5FA3-9AEC-F688B998755B"><!-- --></a>CSdpDocument* sdpDocument = CSdpDocument::NewLC();</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-35A2A9E8-8AE4-55EA-9DE3-C6F056A3B497"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-35A2A9E8-8AE4-55EA-9DE3-C6F056A3B497"><!-- --></a><h2 class="sectiontitle">Defining the
session name field for the SDP description</h2> <p>The following code snippet
shows how to define the session name field for the SDP description: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-14984CDB-2868-5857-9E47-96E280524E2A"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-14984CDB-2868-5857-9E47-96E280524E2A"><!-- --></a>sdpDocument-&gt;SetSessionNameL(_L8("SipSession"));</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-6D04653E-711E-53B3-8DC6-9A35EDE98173"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-6D04653E-711E-53B3-8DC6-9A35EDE98173"><!-- --></a><h2 class="sectiontitle">Creating an
instance of the Origin field class </h2> <p>The following code snippet
shows how to create an instance of the Origin field class and set into the
SDP description: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-BB71093E-DA1F-5BE8-A7A1-7D1BD51AC2AC"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-BB71093E-DA1F-5BE8-A7A1-7D1BD51AC2AC"><!-- --></a>TInt64 sessionId( TUint( 2890844526 ) );
TInt64 sessionVersion( TUint( 2890842807 ) );
TInetAddr address;
const TUint32 KInetAddr = INET_ADDR(10,47,16,5);
address.SetAddress( KInetAddr );
CSdpOriginField* originfield =  CSdpOriginField::NewL(_L8("username"), sessionId, sessionversion, address);
sdpDocument-&gt;SetOriginField(originfield);
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-63EE5D34-4AD2-5FC5-8D4C-E4DDEBE4D546"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-63EE5D34-4AD2-5FC5-8D4C-E4DDEBE4D546"><!-- --></a><h2 class="sectiontitle">Fetching the
network type and the address type</h2><p>The following code snippet shows
how to fetch the predefined network type and the address type for the connection
field from the String Pool:</p>
<pre class="codeblock">RStringF netType = pool.StringF( SdpCodecStringConstants::ENetType, SdpCodecStringConstants::Table );RStringF addressTypeIP4 = pool.StringF( SdpCodecStringConstants::EAddressTypeIP4, SdpCodecStringConstants::Table );
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-4CE0F919-97DC-5A4B-81B1-44953792609A"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-4CE0F919-97DC-5A4B-81B1-44953792609A"><!-- --></a><h2 class="sectiontitle">Creating
and setting the connection field into the sdpDocument</h2> <p>The following
code snippet shows how to create the connection field and set the SDP parameters
of the SIP message into the SDP description: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-C95DB654-C03B-5FAA-B21A-AD7AC7E45117"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-C95DB654-C03B-5FAA-B21A-AD7AC7E45117"><!-- --></a>_LIT8( KAddress, "10.47.16.5" );
CSdpConnectionField* connectionfield = CSdpConnectionField::NewL( netType, addressTypeIP4, KAddress );
sdpDocument-&gt;SetConnectionField(connectionfield);
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-0C8C6767-7D0D-5211-88A1-E07FABFC2EDB"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-0C8C6767-7D0D-5211-88A1-E07FABFC2EDB"><!-- --></a><h2 class="sectiontitle">Defining the
session part attribute and direction-attribute</h2> <p>The following code
snippet shows how to define the session part attribute for the SDP description.
The direction-attribute is not one of the predefined attributes in the string
table, it must be defined dynamically to the String Pool. </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-83943165-3D45-5D50-B4D8-B6F3471CF623"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-83943165-3D45-5D50-B4D8-B6F3471CF623"><!-- --></a>_LIT8(KSDPAttributeDirectionBoth,"both");
RStringF modifier = pool.OpenFStringL(_L8("direction"));
CleanupClosePushL(modifier);
CSdpAttributeField* attrField = CSdpAttributeField::NewL(modifier, KSDPAttributeDirectionBoth);
User::LeaveIfError((sdpDocument-&gt;AttributeFields()).Append(attrField));
CleanupStack::PopAndDestroy();
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-7835F2BC-6D44-58D7-A662-72B636F31154"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-7835F2BC-6D44-58D7-A662-72B636F31154"><!-- --></a><h2 class="sectiontitle"> Creating the
first media field</h2> <p>The following code snippet shows how to create
the first media field: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-5EC0673E-BE80-522E-BD8C-1A258BCF25E3"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-5EC0673E-BE80-522E-BD8C-1A258BCF25E3"><!-- --></a>RStringF mediaVideo = pool.StringF( SdpCodecStringConstants::EMediaVideo, SdpCodecStringPool::StringTableL());
RStringF protocol = pool.StringF(SdpCodecStringConstants::EProtocolRtpAvp, SdpCodecStringPool::StringTableL());
CSdpMediaField* media1 = CSdpMediaField::NewLC(mediaVideo, 49152, protocol, _L8("96"));
</pre>
 <p>Add the sendonly attribute (“a=sendonly”) to the first media
field: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-30DCBB1C-E76A-5BBA-B8CE-CA34EDE86C51"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-30DCBB1C-E76A-5BBA-B8CE-CA34EDE86C51"><!-- --></a>RStringF sendonlyAttr = iPool.StringF( SdpCodecStringConstants:: EAttributeSendonly, SdpCodecStringPool::StringTableL() );
CSdpAttributeField* attr1 = CSdpAttributeField::NewLC(sendonlyAttr, _L8(""));
User::LeaveIfError((media1-&gt;AttributeFields()).Append(attr1));
CleanupStack::Pop(); //attr1
</pre>
 <p>Add the rtpmap attribute (“a=rtpmap:96 H263-2000/90000”) to
the first media field and then add the rtpmap specific attribute (“a=ptime:15”): </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-73BD605A-7C81-50A2-988C-17ABA6B0641B"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-73BD605A-7C81-50A2-988C-17ABA6B0641B"><!-- --></a>_LIT8( KEncodingName, "H263-2000" );
_LIT8( KClockRate, "90000" );
_LIT8( KEncodingParam, "" );
TSdpRtpmapValue rtpmapValue( KEncodingName(), KClockRate(), KEncodingParam() );
HBufC8* rtpmapBuf = rtpmapValue.EncodeL();
CleanupStack::PushL(rtpmapBuf);
RStringF rtpmapStr = pool.StringF( SdpCodecStringConstants::EAttributeRtpmap, SdpCodecStringPool::StringTableL() );
CSdpFmtAttributeField* rtpmapAttribute = CSdpFmtAttributeField::NewLC(rtpmapStr, _L8("96"), *rtpmapBuf);
User::LeaveIfError(media1-&gt;FormatAttributeFields().Append (rtpmapAttribute));
CleanupStack::Pop(); // rtpmapAttribute
CleanupStack::PopAndDestroy(); // rtpmapBuf
// add a rtpmap specific attribute
RStringF ptimeAttrStr = iPool.StringF( SdpCodecStringConstants:: EAttributePtime, SdpCodecStringPool::StringTableL() );
CSdpAttributeField* ptimeAttr = CSdpAttributeField::NewLC(ptimeAttrStr, _L8("15"));
ptimeAttr-&gt;AssignTo(*(media1-&gt;FormatAttributeFields())[0]);
User::LeaveIfError(media1-&gt;AttributeFields().Append(ptimeAttr));
CleanupStack::Pop(); //ptimeAttr
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-D991055C-4847-5A92-BA72-18917231C00E"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-D991055C-4847-5A92-BA72-18917231C00E"><!-- --></a><h2 class="sectiontitle">Creating the
second media field</h2> <p>The following code snippet shows how to create
the second media field: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-9B5EAFE9-66DD-57A7-8AD3-78233430ED53"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-9B5EAFE9-66DD-57A7-8AD3-78233430ED53"><!-- --></a>RStringF mediaAudio = pool.StringF( SdpCodecStringConstants:: EMediaAudio, SdpCodecStringPool::StringTableL());
CSdpMediaField* media2 = CSdpMediaField::NewLC(mediaAudio, 57344, protocol, _L8("97"));
</pre>
 <p>Create the sendonly attribute for the second media field: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-2561B0AD-A8DA-56B0-84E2-833A22F9BE4E"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-2561B0AD-A8DA-56B0-84E2-833A22F9BE4E"><!-- --></a>CSdpAttributeField* attr2 = CSdpAttributeField::NewLC(sendonlyAttr, 
_L8(""));
User::LeaveIfError((media2-&gt;AttributeFields()).Append(attr2));
CleanupStack::Pop();
</pre>
 <p>Create the rtpmap attribute (“a=rtpmap:97 AMR/8000”) for the
second media field: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-18186488-A9C8-5B7A-B3FF-5424C1C4DBD9"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-18186488-A9C8-5B7A-B3FF-5424C1C4DBD9"><!-- --></a>_LIT8( KEncodingName1, "AMR" );
_LIT8( KClockRate1, "8000" );
TSdpRtpmapValue rtpmapValue1( KEncodingName1(), KClockRate1(), KEncodingParam() );
HBufC8* rtpmapBuf1 = rtpmapValue1.EncodeL();
CleanupStack::PushL(rtpmapBuf1);
CSdpFmtAttributeField* rtpmapAttribute1 = CSdpFmtAttributeField::NewLC(rtpmapStr, _L8("97"), *rtpmapBuf1);
User::LeaveIfError(media2-&gt;FormatAttributeFields().Append (rtpmapAttribute1));
CleanupStack::Pop(); // rtpmapAttribute1
CleanupStack::PopAndDestroy(); //rtpmapBuf1
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-F8B6AE3F-DD42-5318-9184-C7DE92B7068A"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-F8B6AE3F-DD42-5318-9184-C7DE92B7068A"><!-- --></a><h2 class="sectiontitle">Assigning the
media fields to the CSdpDocument object </h2> <p>The following code snippet
shows how to assign the media fields to the <a href="GUID-FF6D4EAD-3AAE-3843-8A9C-7C92426FC29F.html"><span class="apiname">CSdpDocument</span></a> object
and then remove the buffers from the cleanup stack: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-44BD57DA-85CD-554A-8801-86F7F47A7D41"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-44BD57DA-85CD-554A-8801-86F7F47A7D41"><!-- --></a>User::LeaveIfError(doc-&gt;MediaFields().Append(media1));
User::LeaveIfError(doc-&gt;MediaFields().Append(media2));
CleanupStack::Pop(); //media2
CleanupStack::Pop(); //media1
</pre>
 </div>

<div class="section" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-8F23A065-184D-5725-86FC-AC5909B401BB"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-8F23A065-184D-5725-86FC-AC5909B401BB"><!-- --></a><h2 class="sectiontitle">Deleting the
sdpDocument and closing the SdpCodecStringPool</h2> <p>To close the String
Pool the <a href="GUID-FF6D4EAD-3AAE-3843-8A9C-7C92426FC29F.html"><span class="apiname">CSdpDocument</span></a> object must be removed and deleted
from the cleanup stack. The following code snippet shows how to remove and
delete the <a href="GUID-FF6D4EAD-3AAE-3843-8A9C-7C92426FC29F.html"><span class="apiname">CSdpDocument</span></a> object from the cleanup stack and
close the String Pool: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-2037F164-73C9-5DC0-95BF-F05E778BF4E1"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-2037F164-73C9-5DC0-95BF-F05E778BF4E1"><!-- --></a>CleanupStack::PopAndDestroy(); //sdpDocument
SdpCodecStringPool::Close();
</pre>
 <p>The SDP description created in the preceding example has the
following fields: </p>
 <pre class="codeblock" id="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-EC361C3C-02D4-5130-AD1B-4C12F1985A06"><a name="GUID-6F40A921-83A9-5268-A9A6-80750CD5823D__GUID-EC361C3C-02D4-5130-AD1B-4C12F1985A06"><!-- --></a>v=0
o=username 2890844526 2890842807 IN IP4 10.47.16.5
s=SipSession
c=IN IP4 10.47.16.5
t=0 0
a=direction:both
m=video 49152 RTP/AVP 96
a=sendonly
a=rtpmap:96 H263-2000/90000
m=audio 57344 RTP/AVP 97
a=sendonly
a=rtpmap:97 AMR/8000
</pre>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-28636BB0-2C25-5D6C-9777-41AA4F3D8F31.html">SDP Codec API</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>