<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Virtual machine model"/>
<meta name="abstract" content="The Kernel provides a 'virtual machine' environment to user processes where each process accesses its data in the same virtual address range."/>
<meta name="description" content="The Kernel provides a 'virtual machine' environment to user processes where each process accesses its data in the same virtual address range."/>
<meta name="DC.Relation" scheme="URI" content="GUID-BFEBCD57-3C83-56D7-B7A3-B8A361725645.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-9636A30F-39EB-54E6-8125-4487D4002FE0.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BFEBCD57-3C83-56D7-B7A3-B8A361725645.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Virtual machine model</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2392081 id2393700 id2393726 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html" title="The User Library allows the applications and services that run on a phone to access the functionality provided by the Symbian platform Kernel.">User Library</a> &gt; <a href="GUID-9636A30F-39EB-54E6-8125-4487D4002FE0.html" title="Memory is allocated to programs in chunks, the documentation in this set explains how to allocate, manage and release that memory.">Memory Management</a> &gt; <a href="GUID-BFEBCD57-3C83-56D7-B7A3-B8A361725645.html" title="Provides an introduction to memory management, especially chunks and heaps.">Memory Management Concepts</a> &gt; </div>
<h1 class="topictitle1">Virtual
machine model</h1>
<div><p>The Kernel provides a 'virtual machine' environment to user processes
where each process accesses its data in the same virtual address range.</p>

<p>The Kernel provides a 'virtual machine' environment to user processes.
Each process accesses its data in the same virtual address range, called the
data section, which ranges from:</p>

<pre class="codeblock" id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-1FE73FDC-5058-5500-BD9D-C41C41DF2481"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-1FE73FDC-5058-5500-BD9D-C41C41DF2481"><!-- --></a>0x00400000 to 0x3FFFFFFF</pre>

<p>but note that the static data always appears at:</p>

<pre class="codeblock" id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-10A112F3-28EF-589F-BE5C-0B53ED736596"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-10A112F3-28EF-589F-BE5C-0B53ED736596"><!-- --></a>0x00400000</pre>

<p>The code chunk for RAM loaded processes always appears at:</p>

<pre class="codeblock" id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-18064043-B6FA-5791-81BC-A8D7859540E3"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-18064043-B6FA-5791-81BC-A8D7859540E3"><!-- --></a>0x20000000</pre>

<p>This allows multiple processes to run, each executing the same code (from
the same code chunk) for each of the processes. For example, multiple word
documents open at the same time, each in a separate instance of the word application.
This reduces RAM usage.</p>

<p>In effect, each user process has the same kind of view. Code instructions
address data using the virtual address; the Memory Management Unit (MMU) is
responsible for the translation of the virtual address to the physical RAM
address.</p>

<p>Only one chunk can occupy a given virtual address range at a time, so a
context switch between different processes involves re-mapping the chunks.
The process chunks of the old process are re-mapped to their home addresses.
These are in the home section, which is the virtual address range from:</p>

<pre class="codeblock" id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-27EFC279-550A-5970-98F5-959647314B44"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-27EFC279-550A-5970-98F5-959647314B44"><!-- --></a>0x80000000 to 0xFFFFFFFF</pre>

<p>ROM code is normally mapped into the address range:</p>

<pre class="codeblock" id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-D75CC9C3-2AD3-5BA0-A8B6-F486CF1D0232"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-D75CC9C3-2AD3-5BA0-A8B6-F486CF1D0232"><!-- --></a>0x50000000 to 0x5FFFFFFF</pre>

<p>The process chunks of the new process are mapped from their home addresses
back to the data section. Chunks which are not accessible by the current user
process reside in the home section, and they have supervisor-mode-only access
permissions, so that only the kernel can access them.</p>

<p>The Kernel's data and stack/heap chunks also reside in the home section.
These are never visible to user processes. Code chunks for RAM-loaded libraries
reside at the top end of the home section and have user read-only access,
so that all user processes can execute code from a loaded library.</p>

<p>A context switch between processes therefore involves:</p>

<ul>
<li id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-F83EAD6D-626D-53B2-9DEB-310617FC03EE"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-F83EAD6D-626D-53B2-9DEB-310617FC03EE"><!-- --></a><p>moving the old process
chunks to the home section, and changing their access permissions to supervisor-only</p>
 </li>

<li id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-7BEBDFDE-DFFB-50F9-A136-5C0018CBD78F"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-7BEBDFDE-DFFB-50F9-A136-5C0018CBD78F"><!-- --></a><p>moving the new process
chunks to the data section and changing their access permissions back to user-accessible.</p>
 </li>

</ul>

<p>This is best seen graphically. In the first diagram shown below, user-process
1 is running and can 'see' all chunks in the clear boxes. Those boxes with
dark background represent chunks which are not visible to user-process 1.</p>

<p>When user-process 2 is running, the context switch re-maps the user-process
2 data to the data section and user process 1 data is re-mapped to the home
section as the second diagram shows.</p>

<div class="fignone" id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-A8C12C7E-7779-5D66-908B-51A1C36E1B63"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-A8C12C7E-7779-5D66-908B-51A1C36E1B63"><!-- --></a><span class="figcap">Figure 1. User process 1's view.</span>

<img src="GUID-09044578-9ADB-540F-A854-A818EA3970B7_d0e345882_href.png"/>
</div>

<div class="fignone" id="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-5F15432A-0CCD-5195-921F-506679F023CC"><a name="GUID-7287F1D4-023E-5C90-91E1-6D8DF78D8241__GUID-5F15432A-0CCD-5195-921F-506679F023CC"><!-- --></a><span class="figcap">Figure 2. User process 2's view.</span>

<img src="GUID-1A7183EC-B55E-5B61-8965-89C939ECB395_d0e345890_href.png"/>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-BFEBCD57-3C83-56D7-B7A3-B8A361725645.html" title="Provides an introduction to memory management, especially chunks and heaps.">Memory Management Concepts</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>