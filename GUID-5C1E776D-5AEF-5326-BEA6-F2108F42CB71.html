<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="condvar: Using Condition Variables"/>
<meta name="abstract" content="Examples that explains how to use condition variables."/>
<meta name="description" content="Examples that explains how to use condition variables."/>
<meta name="DC.Relation" scheme="URI" content="GUID-0D61EBFF-F513-5911-B234-09F36E5E3DC8.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0D61EBFF-F513-5911-B234-09F36E5E3DC8.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>condvar: Using Condition Variables</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2392072 id2392081 id2398849 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87.html" title="Provides a framework for accessing file systems.">User Library and File Server</a> &gt; <a href="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D.html" title="The User Library allows the applications and services that run on a phone to access the functionality provided by the Symbian platform Kernel.">User Library</a> &gt; <a href="GUID-0D61EBFF-F513-5911-B234-09F36E5E3DC8.html" title="This describes the example code for the User Library component.">User Library Example Code</a> &gt; </div>
<h1 class="topictitle1">condvar: Using Condition Variables</h1>
<div><p>Examples that explains how to use condition variables. </p>

<p/>

<ul>
<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-7CD8220E-2844-5FCB-A9B4-9B188F95C6EE"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-7CD8220E-2844-5FCB-A9B4-9B188F95C6EE"><!-- --></a><p><a href="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71.html#GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-8209AA7E-0DFB-512D-9BEB-9063BA617BC5">condvarglobal</a>  </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-74DAFE22-039F-5647-B56E-6BB83B876DED"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-74DAFE22-039F-5647-B56E-6BB83B876DED"><!-- --></a><p><a href="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71.html#GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-8CF8C4E2-4D74-54C8-9601-97CC44B9C943">condvarlocal</a>  </p>
 </li>

</ul>

<div class="section" id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-8209AA7E-0DFB-512D-9BEB-9063BA617BC5"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-8209AA7E-0DFB-512D-9BEB-9063BA617BC5"><!-- --></a><h2 class="sectiontitle">condvarglobal</h2> <p>This example shows the use of the global condition variable IPC
mechanism. The scope of a global condition variable is inter-process.
It can be shared by threads of any process in the system. </p>
 <p><strong>Download</strong> </p>
 <p>Click on the following link to download the
example: <a href="guid-6013a680-57f9-415b-8851-c4fa63356636/zips/guid-ddcb07c8-2646-4414-b33f-086f5758cbfe.zip" target="_blank">condvarglobal .zip</a></p>
<p>Click <a href="guid-6013a680-57f9-415b-8851-c4fa63356636/guid-ddcb07c8-2646-4414-b33f-086f5758cbfe.html"> browse </a> to view the example code</p>
<p><strong>Class
summary</strong></p>
<p> <a href="GUID-D16EF740-78E6-3D08-AE2F-AFA5E812FF2B.html"><span class="apiname">RCondVar </span></a> <a href="GUID-C0FEA3A0-7DD3-3B87-A919-CB973BC05766.html"><span class="apiname">RMutex </span></a> <a href="GUID-326A2F4D-0E99-31C0-A35D-E8BF45913F07.html"><span class="apiname">RChunk </span></a> <a href="GUID-3CECC9FC-58C1-3117-AAF2-FDF88341F56F.html"><span class="apiname">CPeriodic</span></a> </p>
 <p><strong>Description</strong> </p>
 <p>This example uses an adder and subtractor
pattern to show the use of a global condition variable. Two processes,
the adder and the subtractor, modify a shared variable by adding and
subtracting random amounts. The condition variable ensures that the
value remains within given limits, <samp class="codeph">KMaxValue</samp> and <samp class="codeph">KMinValue</samp>, by blocking one of the processes if the value
crosses a warning threshold. </p>
 <p>The adder program creates a global
shared memory chunk. It also creates a global mutex to control access
to the chunk and a global condition variable to signal that the value
in the chunk is '<samp class="codeph">ready for use</samp>'. It then initialises
the value in the chunk to zero and periodically tries to add a random
value between 1 and 10 . If, having added a value, it finds that the
value of the chunk is greater than <samp class="codeph">KUpperThreshold</samp>, it waits for a signal from the condition variable before adding
another value. </p>
 <p>The subtractor program periodically tries to
subtract a random value between 1 and 10 from the global shared memory
chunk. If, having subtracted a value, it finds that the value of the
chunk is less than <samp class="codeph">KLowerThreshold</samp>, it waits for
a signal from the condition variable before subtracting another value. </p>
 <p><strong>Design and implementation</strong> </p>
 <div class="fignone" id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-1FAFB189-D2E4-5A05-8D8B-B3F7D28467FC"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-1FAFB189-D2E4-5A05-8D8B-B3F7D28467FC"><!-- --></a>
<img src="GUID-857A523E-E660-5AFA-98B1-3A5440A8372F_d0e355615_href.jpg"/>
</div>
 <p><strong>Build</strong> </p>
 <p>The ConditionVariable example builds
the following binary files in the standard location (<span class="filepath">\epoc32\release\winscw\
             &lt;build_variant&gt;</span>) for Carbide.c++. </p>
 <ul>
<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-A699F4AF-3A5F-5C24-83CB-1762348AA1D2"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-A699F4AF-3A5F-5C24-83CB-1762348AA1D2"><!-- --></a><p> <strong>adder.exe:</strong> Demonstrates the use of the global condition variable. It creates
a global shared memory chunk and periodically adds random values to
the chunk. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-30A5BE77-8F99-5206-AD42-51E843D0D3C2"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-30A5BE77-8F99-5206-AD42-51E843D0D3C2"><!-- --></a><p> <strong>subtractor.exe:</strong> Demonstrates the use of the global condition variable. It periodically
subtracts random values from the chunk created by <span class="filepath">adder.exe</span>. </p>
 </li>

</ul>
 <p><strong>How to run the Example</strong> </p>
 <p>To run the example,
perform the following steps: </p>
 <a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-312A1E16-C92B-5C33-9D80-83080412E657"><!-- --></a><ol id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-312A1E16-C92B-5C33-9D80-83080412E657">
<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-E8E12006-8AAC-503D-B59A-F171092293F4"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-E8E12006-8AAC-503D-B59A-F171092293F4"><!-- --></a><p>Run <span class="filepath">adder.exe</span>. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-C9F80A69-218F-5467-9DDE-FC5849753E95"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-C9F80A69-218F-5467-9DDE-FC5849753E95"><!-- --></a><p>Run eshell. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-457E6D8F-A383-5CF6-BA6E-D98C8FAC20F4"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-457E6D8F-A383-5CF6-BA6E-D98C8FAC20F4"><!-- --></a><p>Run <span class="filepath">subtract.exe</span> in your new eshell. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-122618AE-028B-5BF9-BB4B-4F95099EE839"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-122618AE-028B-5BF9-BB4B-4F95099EE839"><!-- --></a><p>Switch between
eshells by pressing <strong>CTRL+ALT+SHIFT+T</strong>. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-24CCA548-D350-53A7-9919-270EA0C71EC1"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-24CCA548-D350-53A7-9919-270EA0C71EC1"><!-- --></a><p>To finish, stop
each application by pressing any key. </p>
 </li>

</ol>
 </div>

<div class="section" id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-8CF8C4E2-4D74-54C8-9601-97CC44B9C943"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-8CF8C4E2-4D74-54C8-9601-97CC44B9C943"><!-- --></a><h2 class="sectiontitle">condvarlocal</h2> <p>This example shows the use of the local condition variable IPC
mechanism. The scope of a local condition variable is intra-process.
It can be shared by threads of the process that creates the condition
variable. </p>
 <p><strong>Download</strong> </p>
 <p>Click on the following link
to download the example: <a href="guid-6013a680-57f9-415b-8851-c4fa63356636/zips/guid-527239ad-3eff-4d62-a7fe-b7e43658dd2f.zip" target="_blank">condvarlocal .zip </a></p>
<p>Click <a href="guid-6013a680-57f9-415b-8851-c4fa63356636/guid-527239ad-3eff-4d62-a7fe-b7e43658dd2f.html"> browse </a> to view the example.</p>
 <p><strong>Class
summary</strong></p>
<p> <a href="GUID-C0FEA3A0-7DD3-3B87-A919-CB973BC05766.html"><span class="apiname">RMutex </span></a><a href="GUID-B0E661BC-4058-3256-B9C3-5A4FD52F6DE5.html"><span class="apiname">RThread </span></a>  <a href="GUID-3CECC9FC-58C1-3117-AAF2-FDF88341F56F.html"><span class="apiname">CPeriodic </span></a> <a href="GUID-D16EF740-78E6-3D08-AE2F-AFA5E812FF2B.html"><span class="apiname">RCondVar</span></a></p>
 <p><strong>Description</strong> </p>
 <p>This example uses the producer and the
consumer model to show the use of the local condition variable. </p>
 <p>The example creates two local threads: a producer and a consumer.
The two threads share a buffer, which is an object of the <samp class="codeph">CQueue</samp> class. The CQueue object creates a local condition
variable using the <samp class="codeph">RCondVar::CreateLocal()</samp> function.
It also defines the methods to insert and remove a token from the
queue. The <samp class="codeph">CQueue::Insert()</samp> function inserts a token
into the queue and signals the condition variable. The <samp class="codeph">CQueue::Remove()</samp> function tries to remove a token from the queue. If the queue is
empty, it must wait for a signal from the condition variable. </p>
 <p>An object of the <samp class="codeph">CProducer</samp> class creates and
calls the producer thread. The producer thread is called once every
two seconds using an object of the <a href="GUID-3CECC9FC-58C1-3117-AAF2-FDF88341F56F.html"><span class="apiname">CPeriodic</span></a> class.
This thread inserts a token into the queue when it is called. It calls
the <samp class="codeph">CQueue::Insert()</samp> function on the shared <samp class="codeph">CQueue</samp> object. </p>
 <p>An object of the <samp class="codeph">CConsumer</samp> class creates and calls the consumer thread. The consumer thread
is called once a second using an object of the <a href="GUID-3CECC9FC-58C1-3117-AAF2-FDF88341F56F.html"><span class="apiname">CPeriodic</span></a> class. This thread removes a token from the queue when it is called.
It calls the <samp class="codeph">CQueue::Remove()</samp> function on the shared <samp class="codeph">CQueue</samp> object. </p>
 <p>For more information, refer to <a href="http://support.entegrity.com/private/doclib/docs/osfhtm/develop/appdev/Appde179.htm" target="_blank">Condition Variables</a>. </p>
 <div class="p"> <div class="note"><span class="notetitle">Note:</span>  Symbian
is not responsible for the content of external websites.</div>
  </div>
 <p><strong>Design and implementation</strong> </p>
 <div class="fignone" id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-CA344322-0982-59C3-B93A-7A1F175728F3"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-CA344322-0982-59C3-B93A-7A1F175728F3"><!-- --></a>
<img src="GUID-CAB30473-7829-5F2E-9F45-A2344DEDFC35_d0e355814_href.jpg"/>
</div>
 <p><strong>Build</strong> </p>
 <p>The Symbian build process describes
how to build this example. The ConditionVariable example builds the
following binary files in the standard location (<span class="filepath">\epoc32\release\winscw\
             &lt;build_variant&gt;</span>) for Carbide.c++. </p>
 <p> <span class="filepath">condvarlocal.exe</span>: Demonstrates the use of the
local condition variable. </p>
 <p><strong>How to run the Example</strong> </p>
 <p>To run the example, perform the following steps: </p>
 <a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-D07D5782-6A32-5552-B42B-7D2672F1C94F"><!-- --></a><ol id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-D07D5782-6A32-5552-B42B-7D2672F1C94F">
<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-CD0F5EAF-780F-5BC7-A216-2FE9CA3B284D"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-CD0F5EAF-780F-5BC7-A216-2FE9CA3B284D"><!-- --></a><p>Run <span class="filepath">condvarlocal.exe</span>. The program calls the producer and the
consumer threads periodically as shown in the description section.
It also displays a menu. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-106E7D1D-4ECB-5FA2-A42C-CB1549F4811F"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-106E7D1D-4ECB-5FA2-A42C-CB1549F4811F"><!-- --></a><p>Press <strong>‘d’</strong> to display the contents of the queue. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-AA9ABD22-E280-5F21-A1A1-F47FFAAC58F2"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-AA9ABD22-E280-5F21-A1A1-F47FFAAC58F2"><!-- --></a><p>Press <strong>‘p’</strong> to insert a token into the queue. </p>
 </li>

<li id="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-96C5D556-0700-5632-80A1-E728C97A62C1"><a name="GUID-5C1E776D-5AEF-5326-BEA6-F2108F42CB71__GUID-96C5D556-0700-5632-80A1-E728C97A62C1"><!-- --></a><p>Press any key
to stop the program. </p>
 </li>

</ol>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-0D61EBFF-F513-5911-B234-09F36E5E3DC8.html" title="This describes the example code for the User Library component.">User Library Example Code</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>