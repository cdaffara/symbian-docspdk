<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="cxxClass"/>
<meta name="DC.Title" content="CPolicyServer::TPolicy"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1655BF07-8077-3501-ADC0-96D1256967E2"/>

<title>CPolicyServer::TPolicy</title>

<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="cxxref.css"/></head>
<body class="cxxref" id="GUID-1655BF07-8077-3501-ADC0-96D1256967E2"><a name="GUID-1655BF07-8077-3501-ADC0-96D1256967E2"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2437088 id2437096 id2578593 id2557087 id2441463 id2441468 id2441836 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">
<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt;</div>
<h1 class="topictitle1">CPolicyServer::TPolicy Class Reference</h1>
	<table class="signature"><tr><td>class CPolicyServer::TPolicy</td></tr></table><div class="section"><div>
			<p>Object specifying which security checks to perform on each request number and what action to take if the check fails.</p>

			<p>Explanations of each of the members of this class are detailed below.</p>

			<p>As explained in <a href="GUID-5BDFF5B1-DC1F-393A-879B-9D8DE080B4E2.html#GUID-0C951158-BC08-303F-9CBC-25C536D2DE00">CPolicyServer::CPolicyServer</a>, it is important that the instance of this class (<a href="GUID-1655BF07-8077-3501-ADC0-96D1256967E2.html#GUID-1655BF07-8077-3501-ADC0-96D1256967E2">CPolicyServer::TPolicy</a>) given to the policy server constructor, exists for the lifetime of the server. For this reason, as well as code size considerations, it is recommended that the <a href="GUID-1655BF07-8077-3501-ADC0-96D1256967E2.html#GUID-1655BF07-8077-3501-ADC0-96D1256967E2">TPolicy</a> instance is const static data. The following code segment shows the recommended way of doing this. Further detail on what each of these statements means is given below.</p>

			<div class="p">
				<pre class="codeblock">	const TUint myRangeCount = 4;
	const TInt myRanges[myRangeCount] = 
		{
		0, //range is 0-2 inclusive
		3, //range is 3-6 inclusive
		7, //range is 7
		8, //range is 8-KMaxTInt inclusive
		};
	const TUint8 myElementsIndex[myRangeCount] = 
		{
		1, 								//applies to 0th range (req num: 0-2)
		CPolicyServer::ECustomCheck, 	//applies to 1st range (req num: 3-6)
		0, 								//applies to 2nd range (req num: 7)
		CPolicyServer::ENotSupported,	//applies to 3rd range (req num: 8-KMaxTInt)
		};
	const CPolicyServer::TPolicyElement myElements[] = 
		{
		{_INIT_SECURITY_POLICY_C1(ECapabilityDiskAdmin), CPolicyServer::EFailClient},
		{_INIT_SECURITY_POLICY_C1(ECapabilityLocation), CMyPolicyServer::EQueryUser},
		}
	const CPolicySErver::TPolicy myPolicy =
		{
		CPolicyServer::EAlwaysPass, //specifies all connect attempts should pass
		myRangeCount,					
		myRanges,
		myElementsIndex,
		myElements,
		}</pre>
 </div>

		</div></div>
<div class="section member-index"><table border="0" class="member-index"><thead><tr><th colspan="2">Public Attributes</th></tr></thead><tbody><tr><td align="right" valign="top">const <a href="GUID-9E96B24F-717B-304A-96F9-A6F6A4BB2CED.html">TPolicyElement</a> *</td><td><a href="#GUID-BF5CDE0E-E4DF-3D3C-B7B1-B2203DB8F217">iElements</a></td></tr><tr class="bg"><td align="right" valign="top">const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint8</a> *</td><td><a href="#GUID-90AA7F0E-A0CF-322B-8A33-86EBAFB1189A">iElementsIndex</a></td></tr><tr><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint8</a>
				</td><td><a href="#GUID-B77831F6-6912-31AA-A0B5-01867C5D30A0">iOnConnect</a></td></tr><tr class="bg"><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint16</a>
				</td><td><a href="#GUID-D87FD6C9-55E8-3195-A255-791B2FC08AB9">iRangeCount</a></td></tr><tr><td align="right" valign="top">const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> *</td><td><a href="#GUID-D1271FDB-4B24-338B-9DC4-2336E307219D">iRanges</a></td></tr></tbody></table></div><h1 class="pageHeading topictitle1">Member Data Documentation</h1><div class="nested1" id="GUID-BF5CDE0E-E4DF-3D3C-B7B1-B2203DB8F217"><a name="GUID-BF5CDE0E-E4DF-3D3C-B7B1-B2203DB8F217"><!-- --></a>
		<h2 class="topictitle2">const TPolicyElement * iElements</h2>
		<table class="signature"><tr><td>const <a href="GUID-9E96B24F-717B-304A-96F9-A6F6A4BB2CED.html">TPolicyElement</a> *</td><td>iElements</td></tr></table><div class="section"><div>
				<p>A pointer to an array of distinct policy elements.</p>

				<div class="p">Continuing with the previous examples: <pre class="codeblock">		const TInt myRanges[4] = {0, 3, 7, 8};
		const TUInt8 myElementsIndex[4] = {
			1, 
			CPolicyServer::ECustomCheck, 
			0, 
			CPolicyServer::ENotSupported
			};
		const TPolicyElement iElements[] = {
			{_INIT_SECURITY_POLICY_C1(ECapabilityDiskAdmin), CPolicyServer::EFailClient},
			{_INIT_SECURITY_POLICY_C1(ECapabilityLocation), CMyPolicyServer::EQueryUser}
			}</pre>
</div>

				<div class="p">The instantiation of iElements specifies that:<ol><li><p>Request numbers 0-2 require the Location capability. As the iAction member of the 1st element specifies a custom action (represented by the negative number, CMyPolicyServer::EQueryUser), requests without Location will passed to the reimplementation of CustomFailureActionL.</p>
</li>
<li><p>Request number 7 requires the DiskAdmin capability. Requestors without DiskAdmin will have their request completed with KErrPermissionDenied. </p>
</li>
</ol>
</div>

			</div></div>

	</div>
<div class="nested1" id="GUID-90AA7F0E-A0CF-322B-8A33-86EBAFB1189A"><a name="GUID-90AA7F0E-A0CF-322B-8A33-86EBAFB1189A"><!-- --></a>
		<h2 class="topictitle2">const TUint8 * iElementsIndex</h2>
		<table class="signature"><tr><td>const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint8</a> *</td><td>iElementsIndex</td></tr></table><div class="section"><div>
				<p>A pointer to an array of TUint8 values specifying the appropriate action to take for each range in iRanges. For example, the 0th element of iElementsIndex specifies the appropriate action to take for the 0th range in iRanges. As such, iElementsIndex must have precisely the same number of elements as iRanges.</p>

				<div class="p">The following rules apply to the value of each element in iElementsIndex:<ol><li><p>Each value must be a valid index into iElements (that is, less than the number of elements in iElements) OR a valid value from TSpecialCase.</p>
</li>
<li><p>Elements' values need not follow any special ordering.</p>
</li>
<li><p>Elements may repeat values.</p>
</li>
</ol>
</div>

				<div class="p">Continuing the example from iRanges: <pre class="codeblock">		const TInt myRanges[4] = {0, 3, 7, 8};
		const TUInt8 myElementsIndex[4] = {
			1, 
			CPolicyServer::ECustomCheck, 
			0, 
			CPolicyServer::ENotSupported
			};</pre>
 This means that:<ol><li><p>Requests within the first range of myRanges (request numbers 0-2) will be checked against the policy specified by the 1st element of iElements.</p>
</li>
<li><p>Requests with the the second range of myRanges (request numbers 3-6) require a custom check to determine if they are allowed. This requires derived server implementations to implement <a href="GUID-5BDFF5B1-DC1F-393A-879B-9D8DE080B4E2.html#GUID-84750FFA-EA5F-3288-BB64-6625714BB8C3">CustomSecurityCheckL()</a></p>
</li>
<li><p>Requests within the third range of myRanges (request number 7) will be checked against the policy specified by the 0th element of iElements.</p>
</li>
<li><p>Requests within the fourth range of myRanges (request numbers 8-KMaxTInt) will automatically be completed with KErrNotSupported by the policy server framework. </p>
</li>
</ol>
</div>

			</div></div>

	</div>
<div class="nested1" id="GUID-B77831F6-6912-31AA-A0B5-01867C5D30A0"><a name="GUID-B77831F6-6912-31AA-A0B5-01867C5D30A0"><!-- --></a>
		<h2 class="topictitle2">
					TUint8
				 iOnConnect</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint8</a>
				</td><td>iOnConnect</td></tr></table><div class="section"><div>
				<p>The index into iElements, or an allowed value of TSpecialCase, that is used to check a connection attempt . </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-D87FD6C9-55E8-3195-A255-791B2FC08AB9"><a name="GUID-D87FD6C9-55E8-3195-A255-791B2FC08AB9"><!-- --></a>
		<h2 class="topictitle2">
					TUint16
				 iRangeCount</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint16</a>
				</td><td>iRangeCount</td></tr></table><div class="section"><div>
				<p>Number of ranges in the iRanges array. </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-D1271FDB-4B24-338B-9DC4-2336E307219D"><a name="GUID-D1271FDB-4B24-338B-9DC4-2336E307219D"><!-- --></a>
		<h2 class="topictitle2">const TInt * iRanges</h2>
		<table class="signature"><tr><td>const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> *</td><td>iRanges</td></tr></table><div class="section"><div>
				<div class="p">A pointer to an array of ordered ranges of request numbers. Each element in this array refers to the starting request number of a range. The range of the previous element is up to and including the current element minus 1. Thus an array like: <pre class="codeblock">		const TInt myRanges[4] = {0, 3, 7, 8};</pre>
 means that:<ul><li><p>the 0th range is 0-2 (inclusive).</p>
</li>
<li><p>the 1st range is 3-6 (inclusive).</p>
</li>
<li><p>the 2nd range is solely request number 7.</p>
</li>
<li><p>the 3rd range is 8-KMaxTInt (inclusive).</p>
</li>
</ul>
</div>

				<p>Note that the all possible request numbers must be accounted for. This implies that the first element must be 0. It also implies that the last range goes from the that element to KMaxTint. Finally, each element must be strictly greater than the previous element. As the first element is 0, this clearly implies that iRanges must not contain negative elements. </p>

			</div></div>

	</div>

	
	
	
	
	
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>