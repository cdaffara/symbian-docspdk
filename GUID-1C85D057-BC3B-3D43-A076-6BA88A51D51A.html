<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="cxxFile"/>
<meta name="DC.Title" content="atslogger.h"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A"/>

<title>atslogger.h</title>

<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="cxxref.css"/></head>
<body class="cxxref" id="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A"><a name="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2437088 id2437096 id2578593 id2409949 id2410885 id2411369 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">
<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt;</div>
<h1 class="topictitle1">atslogger.h File Reference</h1>
	<div class="nested1" id="GUID-A160E446-2591-3465-962E-65B0114145BB"><a name="GUID-A160E446-2591-3465-962E-65B0114145BB"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"AtsLogger")/2 &gt; KAtsLogger</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"AtsLogger")/2 &gt;</td><td>KAtsLogger</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-B68FDDBD-6EBE-3D8A-9F06-3BD33DBF1878"><a name="GUID-B68FDDBD-6EBE-3D8A-9F06-3BD33DBF1878"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"NA")/2 &gt; KAtsLoggerNa</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"NA")/2 &gt;</td><td>KAtsLoggerNa</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-37285736-DC03-376F-AA00-C5A5C2B826F8"><a name="GUID-37285736-DC03-376F-AA00-C5A5C2B826F8"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"PASSED")/2 &gt; KAtsLoggerPassed</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"PASSED")/2 &gt;</td><td>KAtsLoggerPassed</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-9A9F58A0-6D62-3903-816C-3B89A956C098"><a name="GUID-9A9F58A0-6D62-3903-816C-3B89A956C098"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"FAILED")/2 &gt; KAtsLoggerFailed</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"FAILED")/2 &gt;</td><td>KAtsLoggerFailed</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-B7C6EAE3-E212-309C-82DE-FE7DA101B276"><a name="GUID-B7C6EAE3-E212-309C-82DE-FE7DA101B276"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"SKIPPED")/2 &gt; KAtsLoggerSkipped</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"SKIPPED")/2 &gt;</td><td>KAtsLoggerSkipped</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-C0BA0380-87DD-3C12-B855-E8B4B6932D9E"><a name="GUID-C0BA0380-87DD-3C12-B855-E8B4B6932D9E"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"")/2 &gt; KAtsLoggerEmpty</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"")/2 &gt;</td><td>KAtsLoggerEmpty</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-AF812968-66AF-3262-A673-FE80F5B15237"><a name="GUID-AF812968-66AF-3262-A673-FE80F5B15237"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"AtsLogger")/2 &gt; KAtsLoggerSemaphore</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"AtsLogger")/2 &gt;</td><td>KAtsLoggerSemaphore</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-69A47C23-634E-376C-B051-100075A129C8"><a name="GUID-69A47C23-634E-376C-B051-100075A129C8"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"\\SPD_LOGS\\XML\\")/2 &gt; KAtsLoggerXmlDirectory</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"\\SPD_LOGS\\XML\\")/2 &gt;</td><td>KAtsLoggerXmlDirectory</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-82A194BA-2501-3401-95B4-7219686D5557"><a name="GUID-82A194BA-2501-3401-95B4-7219686D5557"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"\\SPD_LOGS\\RAW\\")/2 &gt; KAtsLoggerRawDirectory</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"\\SPD_LOGS\\RAW\\")/2 &gt;</td><td>KAtsLoggerRawDirectory</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-4D378479-628D-3BD0-8430-D61678CDEE79"><a name="GUID-4D378479-628D-3BD0-8430-D61678CDEE79"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L".xml")/2 &gt; KAtsLoggerXmlSuffix</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L".xml")/2 &gt;</td><td>KAtsLoggerXmlSuffix</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-99DC910C-C6AC-3F62-B315-46F85656CFC0"><a name="GUID-99DC910C-C6AC-3F62-B315-46F85656CFC0"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L".log")/2 &gt; KAtsLoggerRawSuffix</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L".log")/2 &gt;</td><td>KAtsLoggerRawSuffix</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-DA31FF8F-C915-33BC-A185-047423236B93"><a name="GUID-DA31FF8F-C915-33BC-A185-047423236B93"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"&lt;")/2 &gt;KAtsLoggerTagOpen={sizeof(L"&lt;")/2-1, L"&lt;"};const static TLitC&lt; sizeof(L" ")/2 &gt;KAtsLoggerSpace={sizeof(L" ")/2-1, L" "};const static TLitC&lt; sizeof(L"=\"")/2 &gt;KAtsLoggerAttr={sizeof(L"=\"")/2-1, L"=\""};const static TLitC&lt; sizeof(L"\"&gt;")/2 &gt;KAtsLoggerAttrClose={sizeof(L"\"&gt;")/2-1, L"\"&gt;</h2>
		<table class="signature"><tr><td>const</td><td>TLitC&lt; sizeof(L"&lt;")/2 &gt;KAtsLoggerTagOpen={sizeof(L"&lt;")/2-1, L"&lt;"};const static TLitC&lt; sizeof(L" ")/2 &gt;KAtsLoggerSpace={sizeof(L" ")/2-1, L" "};const static TLitC&lt; sizeof(L"=\"")/2 &gt;KAtsLoggerAttr={sizeof(L"=\"")/2-1, L"=\""};const static TLitC&lt; sizeof(L"\"&gt;")/2 &gt;KAtsLoggerAttrClose={sizeof(L"\"&gt;")/2-1, L"\"&gt;</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-F4F765C5-5A1A-3402-AB63-A225F6CBCA86"><a name="GUID-F4F765C5-5A1A-3402-AB63-A225F6CBCA86"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"&gt; KAtsLoggerTagPost</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&gt;</td><td>KAtsLoggerTagPost</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-5BC65259-548F-3F16-BB33-9858D3FAB9A8"><a name="GUID-5BC65259-548F-3F16-BB33-9858D3FAB9A8"><!-- --></a>
		<h2 class="topictitle2">const TLitC&lt; sizeof(L"&lt;/")/2 &gt; KAtsLoggerTagClose={sizeof(L"&lt;/")/2-1, L"&lt;/"};const static TLitC&lt; sizeof(L"\n")/2 &gt; KAtsLoggerLf={sizeof(L"\n")/2-1, L"\n"};const static TLitC&lt; sizeof(L" ")/2 &gt; KAtsLoggerIndent={sizeof(L" ")/2-1, L" "};const static TLitC8&lt; sizeof(" ")&gt; KAtsLoggerIndent8={sizeof(" ")-1," "};const static TLitC&lt; sizeof(L"&lt;!--")/2 &gt; KAtsLoggerCommentOpen={sizeof(L"&lt;!--")/2-1, L"&lt;!--"};const static TLitC&lt; sizeof(L"--&gt;")/2 &gt; KAtsLoggerCommentClose={sizeof(L"--&gt;")/2-1, L"--&gt;"};const static TLitC&lt; sizeof(L"&amp;quot;")/2 &gt; KAtsLoggerQuot={sizeof(L"&amp;quot;")/2-1, L"&amp;quot;"};const static TLitC&lt; sizeof(L"&amp;amp;")/2 &gt; KAtsLoggerAmp={sizeof(L"&amp;amp;")/2-1, L"&amp;amp;"};const static TLitC&lt; sizeof(L"&amp;apos;")/2 &gt; KAtsLoggerApos={sizeof(L"&amp;apos;")/2-1, L"&amp;apos;"};const static TLitC&lt; sizeof(L"&amp;lt;")/2 &gt; KAtsLoggerLt={sizeof(L"&amp;lt;")/2-1, L"&amp;lt;"};const static TLitC&lt; sizeof(L"&amp;gt;")/2 &gt; KAtsLoggerGt={sizeof(L"&amp;gt;")/2-1, L"&amp;gt;"};const static TLitC8&lt; sizeof("&amp;quot;")&gt; KAtsLoggerQuot8={sizeof("&amp;quot;")-1,"&amp;quot;"};const static TLitC8&lt; sizeof("&amp;amp;")&gt; KAtsLoggerAmp8={sizeof("&amp;amp;")-1,"&amp;amp;"};const static TLitC8&lt; sizeof("&amp;apos;")&gt; KAtsLoggerApos8={sizeof("&amp;apos;")-1,"&amp;apos;"};const static TLitC8&lt; sizeof("&amp;lt;")&gt; KAtsLoggerLt8={sizeof("&amp;lt;")-1,"&amp;lt;"};const static TLitC8&lt; sizeof("&amp;gt;")&gt; KAtsLoggerGt8={sizeof("&amp;gt;")-1,"&amp;gt;"};const static TLitC8&lt; sizeof("")&gt; KAtsLoggerEmpty8={sizeof("")-1,""};const static TLitC&lt; sizeof(L"test-report")/2 &gt; KAtsLoggerTagTestReport={sizeof(L"test-report")/2-1, L"test-report"};const static TLitC&lt; sizeof(L"test-batch")/2 &gt; KAtsLoggerTagTestSet={sizeof(L"test-batch")/2-1, L"test-batch"};const static TLitC&lt; sizeof(L"test-case")/2 &gt; KAtsLoggerTagTestCase={sizeof(L"test-case")/2-1, L"test-case"};const static TLitC&lt; sizeof(L"batch-init")/2 &gt; KAtsLoggerTagTestSetInit={sizeof(L"batch-init")/2-1, L"batch-init"};const static TLitC&lt; sizeof(L"description")/2 &gt; KAtsLoggerTagDescription={sizeof(L"description")/2-1, L"description"};const static TLitC&lt; sizeof(L"date")/2 &gt; KAtsLoggerTagDate={sizeof(L"date")/2-1, L"date"};const static TLitC&lt; sizeof(L"factory")/2 &gt; KAtsLoggerTagFactory={sizeof(L"factory")/2-1, L"factory"};const static TLitC&lt; sizeof(L"component")/2 &gt; KAtsLoggerTagComponent={sizeof(L"component")/2-1, L"component"};const static TLitC&lt; sizeof(L"name")/2 &gt; KAtsLoggerTagName={sizeof(L"name")/2-1, L"name"};const static TLitC&lt; sizeof(L"version")/2 &gt; KAtsLoggerTagVersion={sizeof(L"version")/2-1, L"version"};const static TLitC&lt; sizeof(L"batch-result")/2 &gt; KAtsLoggerTagTestSetResult={sizeof(L"batch-result")/2-1, L"batch-result"};const static TLitC&lt; sizeof(L"id")/2 &gt; KAtsLoggerTagId={sizeof(L"id")/2-1, L"id"};const static TLitC&lt; sizeof(L"case-init")/2 &gt; KAtsLoggerTagTestCaseInit={sizeof(L"case-init")/2-1, L"case-init"};const static TLitC&lt; sizeof(L"expected-result")/2 &gt; KAtsLoggerTagExpected={sizeof(L"expected-result")/2-1, L"expected-result"};const static TLitC&lt; sizeof(L"run-time")/2 &gt; KAtsLoggerTagRunTime={sizeof(L"run-time")/2-1, L"run-time"};const static TLitC&lt; sizeof(L"case-result")/2 &gt; KAtsLoggerTagTestCaseResult={sizeof(L"case-result")/2-1, L"case-result"};const static TLitC&lt; sizeof(L"actual-result")/2 &gt; KAtsLoggerTagActual={sizeof(L"actual-result")/2-1, L"actual-result"};const static TLitC&lt; sizeof(L"debug-info")/2 &gt; KAtsLoggerTagDebug={sizeof(L"debug-info")/2-1, L"debug-info"};const static TLitC&lt; sizeof(L"warning")/2 &gt; KAtsLoggerTagWarning={sizeof(L"warning")/2-1, L"warning"};const static TLitC&lt; sizeof(L"error")/2 &gt; KAtsLoggerTagError={sizeof(L"error")/2-1, L"error"};const static TLitC&lt; sizeof(L"status")/2 &gt; KAtsLoggerTagStatus={sizeof(L"status")/2-1, L"status"};const static TLitC&lt; sizeof(L"time-stamp")/2 &gt; KAtsLoggerTimeStamp={sizeof(L"time-stamp")/2-1, L"time-stamp"};const TInt KAtsLoggerBufferSegmentGranularity=32;class CAtsLogger:public CBase{public:enum TReportStage{ENone, EUninitialized, EBeginTestReport, EBeginTestSet, EBeginTestCase, ESetTestCaseVerdict, EEndTestCase, EEndTestSet, EEndTestReport, EFinished};private:public:IMPORT_C static CAtsLogger *NewL(const TDesC &amp;aName, TBool aAfterReboot=EFalse);IMPORT_C~CAtsLogger();public:IMPORT_C static const TPtrC ErrorMessage(const TInt &amp;aError);IMPORT_C void CloseL();IMPORT_C TBool IsValid();IMPORT_C void BeginTestReportL();IMPORT_C void EndTestReportL();IMPORT_C void SaveForRebootL();IMPORT_C void ContinueAfterRebootL();IMPORT_C void BeginTestSetL(const TDesC &amp;aFactory=KAtsLoggerNa, const TDesC &amp;aComponent=KAtsLoggerNa, const TDesC &amp;aVersion=KAtsLoggerNa, const TDesC &amp;aDescription=KAtsLoggerEmpty);IMPORT_C void EndTestSetL();IMPORT_C void BeginTestCaseL(const TDesC &amp;aId, const TDesC &amp;aExpected=KAtsLoggerNa, const TDesC &amp;aInfo=KAtsLoggerEmpty, const TDesC &amp;aVersion=KAtsLoggerEmpty);IMPORT_C void BeginTestCaseL(const TDesC &amp;aId, const TInt aExpected, const TDesC &amp;aInfo=KAtsLoggerEmpty, const TDesC &amp;aVersion=KAtsLoggerEmpty);IMPORT_C void BeginTestCaseReportL(const TDesC &amp;aId, const TDesC &amp;aExpected, const TTime &amp;aStartTime, const TDesC &amp;aInfo=KAtsLoggerEmpty, const TDesC &amp;aVersion=KAtsLoggerEmpty);IMPORT_C void BeginTestCaseReportL(const TDesC &amp;aId, const TInt aExpected, const TTime &amp;aStartTime, const TDesC &amp;aInfo=KAtsLoggerEmpty, const TDesC &amp;aVersion=KAtsLoggerEmpty);IMPORT_C void EndTestCaseL();IMPORT_C void TestCasePassed();IMPORT_C void TestCaseFailed();IMPORT_C void TestCaseSkipped();IMPORT_C void TestCaseNa();IMPORT_C void SetTestCaseResultL(const TInt aResult);IMPORT_C void SetTestCaseResultL(const TDesC &amp;aResult=KAtsLoggerEmpty);IMPORT_C void SetTestCaseResultL(TRefByValue&lt; const TDesC &gt; aFmt,...);IMPORT_C void DebugL(const TDesC &amp;aMsg);IMPORT_C void DebugL(TRefByValue&lt; const TDesC &gt; aFmt,...);IMPORT_C void WarningL(const TDesC &amp;aMsg);IMPORT_C void WarningL(TRefByValue&lt; const TDesC &gt; aFmt,...);IMPORT_C void ErrorL(const TDesC &amp;aMsg);IMPORT_C void ErrorL(TRefByValue&lt; const TDesC &gt; aFmt,...);IMPORT_C void CommentL(const TDesC &amp;aMsg);IMPORT_C void CommentL(TRefByValue&lt; const TDesC &gt; aFmt,...);IMPORT_C TInt RawLogL(const TDesC &amp;aMsg);IMPORT_C TInt RawLogL(TRefByValue&lt; const TDesC &gt; aFmt,...);IMPORT_C void DebugOutput(const TDesC &amp;aMsg);IMPORT_C void SetFullReporting(TBool aFlag);IMPORT_C void SetDebugOutput(TBool aFlag);IMPORT_C void SetIndentation(TBool aFlag);public:protected:void TagL(const TDesC &amp;aTag, const TDesC &amp;aMsg);void TagL(const TDesC &amp;aTag, const TDesC &amp;aMsg, const TDesC &amp;aAttribute, const TDesC &amp;aValue);void TimeStampedMessageL(const TDesC &amp;aTag, const TDesC &amp;aMsg);void OpenTagL(const TDesC &amp;aTag);void OpenTagL(const TDesC &amp;aTag, const TDesC &amp;aAttribute, const TDesC &amp;aValue);void OpenTagIndentL(const TDesC &amp;aTag);void OpenTagIndentL(const TDesC &amp;aTag, const TDesC &amp;aAttribute, const TDesC &amp;aValue);void CloseTagL(const TDesC &amp;aTag);void CloseTagIndentL(const TDesC &amp;aTag);void LineFeedL();void WriteL(const TDesC &amp;aData, RFile &amp;aFile);void WriteL(const TDesC &amp;aData);HBufC *EncodeLC(const TDesC &amp;aMsg);TBool IsTransitionLegal(const TReportStage &amp;aNewStage);protected:protected:private:void ConstructL(TBool aAfterReboot);CAtsLogger(const TDesC &amp;aName);TBool CheckDirectoryL(const TDesC &amp;aDirName, TChar &amp;aDrive);TInt ReplaceFileL(const TDesC &amp;aFileName);TInt OpenExistingFileL(const TDesC &amp;aFileName);HBufC *FormatDateLC(TDateTime aDate);HBufC *FormatTimeLC(TTimeIntervalMicroSeconds aTime);TInt BufferL(CBufBase *aBufBase, TInt &amp;aLength, const TDesC &amp;aBuf);TInt WriteBufferToFileL(CBufBase *aCBufBase, const TDesC &amp;aFileName);TInt WriteBufferToDebugPortL(CBufBase *aCBufBase);protected:class TTestSet{public:TTime iStartTime;};class TTestCase{public:TTestCase(){iResult=NULL;}~TTestCase(){if(iResult){delete iResult;iResult=NULL;}}public:HBufC *iResult;TPtrC iStatus;TTime iStartTime;};CAtsLogger::TTestSet iTestSet;CAtsLogger::TTestCase iTestCase;CAtsLogger::TReportStage iReportStage;const TFileName iName;private:CBufBase *iXmlBuffer;TInt iXmlBufferLength;int iIndentLevel;RFs iRfs;TFileName iXmlLogFileName;TFileName iRawLogFileName;TBool iRawLog;TBool iXmlLog;TBool iValid;TBool iLineFeedDone;TBool iInTestCase;TBool iClosed;TBool iFullReportingMode;TBool iDoDebugOutput;TBool iDoIndentation;public:protected:private:};#20"X:/sf/os/osrndtools/stif/atslogger/src/atslogger.cpp"2CAtsLogger::CAtsLogger(const TDesC &amp;aName):iReportStage(EUninitialized), iName(aName), iIndentLevel(0), iRawLog(EFalse), iXmlLog(EFalse), iValid(EFalse), iLineFeedDone(EFalse), iInTestCase(EFalse), iClosed(EFalse), iFullReportingMode(ETrue), iDoDebugOutput(EFalse), iDoIndentation(ETrue){}void CAtsLogger::ConstructL(TBool aAfterReboot){TChar xmlDrive;iXmlLog=CheckDirectoryL(KAtsLoggerXmlDirectory, xmlDrive);TChar rawDrive;iRawLog=CheckDirectoryL(KAtsLoggerRawDirectory, rawDrive);if(iXmlLog){iXmlLogFileName.Copy((TPtrC((const TText *) L"?:")));iXmlLogFileName.Append(KAtsLoggerXmlDirectory);iXmlLogFileName.Append(iName);iXmlLogFileName.Append(KAtsLoggerXmlSuffix);iXmlLogFileName[0]=(TUint8) xmlDrive;if(aAfterReboot){User::LeaveIfError(OpenExistingFileL(iXmlLogFileName));}else{User::LeaveIfError(ReplaceFileL(iXmlLogFileName));}iValid=ETrue;}else{iValid=EFalse;}if(iRawLog){iRawLogFileName.Copy((TPtrC((const TText *) L"?:")));iRawLogFileName.Append(KAtsLoggerRawDirectory);iRawLogFileName.Append(iName);iRawLogFileName.Append(KAtsLoggerRawSuffix);iRawLogFileName[0]=(TUint8) rawDrive;if(aAfterReboot){User::LeaveIfError(OpenExistingFileL(iRawLogFileName));}else{User::LeaveIfError(ReplaceFileL(iRawLogFileName));}}iXmlBuffer=CBufSeg::NewL(KAtsLoggerBufferSegmentGranularity);iXmlBufferLength=0;}TBool CAtsLogger::CheckDirectoryL(const TDesC &amp;aDirName, TChar &amp;aDrive){User::LeaveIfError(iRfs.Connect());TDriveList driveList;iRfs.DriveList(driveList);TBool dirFound=EFalse;TFileName dir;for(TInt i=0;i&lt; driveList.Length()&amp;&amp;!dirFound;i++){TChar drive;if(driveList[i]!=0){iRfs.DriveToChar(i, drive);dir.Copy((TPtrC((const TText *) L"?:")));dir.Append(aDirName);dir[0]=(TUint8) drive;RDir rDir;TInt error=rDir.Open(iRfs, dir, KEntryAttNormal);if(error==KErrNone){dirFound=ETrue;aDrive=drive;}else{dirFound=EFalse;aDrive= '?';}rDir.Close();}}iRfs.Close();return dirFound;}TInt CAtsLogger::ReplaceFileL(const TDesC &amp;aFileName){User::LeaveIfError(iRfs.Connect());RFile file;TInt err=file.Replace(iRfs, aFileName, EFileWrite|EFileShareAny);file.Close();iRfs.Close();return err;}TInt CAtsLogger::OpenExistingFileL(const TDesC &amp;aFileName){User::LeaveIfError(iRfs.Connect());RFile file;TInt err=file.Open(iRfs, aFileName, EFileWrite|EFileShareAny);file.Close();iRfs.Close();return err;}EXPORT_C CAtsLogger::~CAtsLogger(){if(!iClosed){CloseL();}if(iXmlBuffer){delete iXmlBuffer;iXmlBuffer=0;}}EXPORT_C void CAtsLogger::CloseL(){if(iClosed){return;}User::LeaveIfError(iRfs.Connect());if(iXmlLog){RFile file;TInt err=file.Open(iRfs, iXmlLogFileName, EFileWrite|EFileShareAny);if(err==KErrNone){TInt fileSize=0;file.Size(fileSize);file.Close();if(fileSize==0){iRfs.Delete(iXmlLogFileName);}}}if(iRawLog){RFile file;TInt err=file.Open(iRfs, iRawLogFileName, EFileWrite|EFileShareAny);if(err==KErrNone){TInt fileSize=0;file.Size(fileSize);file.Close();if(fileSize==0){iRfs.Delete(iRawLogFileName);}}}iRfs.Close();iClosed=ETrue;}EXPORT_C CAtsLogger *CAtsLogger::NewL(const TDesC &amp;aName, TBool aAfterReboot){(void)((aName.Length() &gt; 0)||(User::Leave(KErrBadName),0));RFs rfs;User::LeaveIfError(rfs.Connect());(void)((rfs.IsValidName(aName))||(User::Leave(KErrBadName),0));rfs.Close();CAtsLogger *self=new(ELeave) CAtsLogger(aName);CleanupStack::PushL(self);self-&gt;ConstructL(aAfterReboot);CleanupStack::Pop(self);return self;}EXPORT_C TBool CAtsLogger::IsValid(){return iValid;}EXPORT_C void CAtsLogger::BeginTestReportL(){if(iFullReportingMode){if(!IsTransitionLegal(EBeginTestReport)){User::Leave(EBeginTestReport);}iReportStage=EBeginTestReport;OpenTagIndentL(KAtsLoggerTagTestReport());}else{iTestSet.iStartTime.HomeTime();}}EXPORT_C void CAtsLogger::EndTestReportL(){if(iFullReportingMode){if(!IsTransitionLegal(EEndTestReport)){User::Leave(EEndTestReport);}iReportStage=EEndTestReport;CloseTagIndentL(KAtsLoggerTagTestReport());}if(iDoDebugOutput){WriteBufferToDebugPortL(iXmlBuffer);}if(iXmlLog &amp;&amp;!iInTestCase &amp;&amp;iXmlBufferLength &gt; 0){WriteBufferToFileL(iXmlBuffer, iXmlLogFileName);}iXmlBuffer-&gt; Reset</h2>
		<table class="signature"><tr><td>const <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&lt;/")/2 &gt; KAtsLoggerTagClose={sizeof(L"&lt;/")/2-1, L"&lt;/"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"\n")/2 &gt; KAtsLoggerLf={sizeof(L"\n")/2-1, L"\n"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L" ")/2 &gt; KAtsLoggerIndent={sizeof(L" ")/2-1, L" "};const static <a href="GUID-A188447C-9DAA-3963-B6F2-893910450FC7.html">TLitC8</a>&lt; sizeof(" ")&gt; KAtsLoggerIndent8={sizeof(" ")-1," "};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&lt;!--")/2 &gt; KAtsLoggerCommentOpen={sizeof(L"&lt;!--")/2-1, L"&lt;!--"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"--&gt;")/2 &gt; KAtsLoggerCommentClose={sizeof(L"--&gt;")/2-1, L"--&gt;"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&amp;quot;")/2 &gt; KAtsLoggerQuot={sizeof(L"&amp;quot;")/2-1, L"&amp;quot;"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&amp;amp;")/2 &gt; KAtsLoggerAmp={sizeof(L"&amp;amp;")/2-1, L"&amp;amp;"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&amp;apos;")/2 &gt; KAtsLoggerApos={sizeof(L"&amp;apos;")/2-1, L"&amp;apos;"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&amp;lt;")/2 &gt; KAtsLoggerLt={sizeof(L"&amp;lt;")/2-1, L"&amp;lt;"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"&amp;gt;")/2 &gt; KAtsLoggerGt={sizeof(L"&amp;gt;")/2-1, L"&amp;gt;"};const static <a href="GUID-A188447C-9DAA-3963-B6F2-893910450FC7.html">TLitC8</a>&lt; sizeof("&amp;quot;")&gt; KAtsLoggerQuot8={sizeof("&amp;quot;")-1,"&amp;quot;"};const static <a href="GUID-A188447C-9DAA-3963-B6F2-893910450FC7.html">TLitC8</a>&lt; sizeof("&amp;amp;")&gt; KAtsLoggerAmp8={sizeof("&amp;amp;")-1,"&amp;amp;"};const static <a href="GUID-A188447C-9DAA-3963-B6F2-893910450FC7.html">TLitC8</a>&lt; sizeof("&amp;apos;")&gt; KAtsLoggerApos8={sizeof("&amp;apos;")-1,"&amp;apos;"};const static <a href="GUID-A188447C-9DAA-3963-B6F2-893910450FC7.html">TLitC8</a>&lt; sizeof("&amp;lt;")&gt; KAtsLoggerLt8={sizeof("&amp;lt;")-1,"&amp;lt;"};const static <a href="GUID-A188447C-9DAA-3963-B6F2-893910450FC7.html">TLitC8</a>&lt; sizeof("&amp;gt;")&gt; KAtsLoggerGt8={sizeof("&amp;gt;")-1,"&amp;gt;"};const static <a href="GUID-A188447C-9DAA-3963-B6F2-893910450FC7.html">TLitC8</a>&lt; sizeof("")&gt; KAtsLoggerEmpty8={sizeof("")-1,""};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"test-report")/2 &gt; KAtsLoggerTagTestReport={sizeof(L"test-report")/2-1, L"test-report"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"test-batch")/2 &gt; KAtsLoggerTagTestSet={sizeof(L"test-batch")/2-1, L"test-batch"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"test-case")/2 &gt; KAtsLoggerTagTestCase={sizeof(L"test-case")/2-1, L"test-case"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"batch-init")/2 &gt; KAtsLoggerTagTestSetInit={sizeof(L"batch-init")/2-1, L"batch-init"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"description")/2 &gt; KAtsLoggerTagDescription={sizeof(L"description")/2-1, L"description"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"date")/2 &gt; KAtsLoggerTagDate={sizeof(L"date")/2-1, L"date"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"factory")/2 &gt; KAtsLoggerTagFactory={sizeof(L"factory")/2-1, L"factory"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"component")/2 &gt; KAtsLoggerTagComponent={sizeof(L"component")/2-1, L"component"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"name")/2 &gt; KAtsLoggerTagName={sizeof(L"name")/2-1, L"name"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"version")/2 &gt; KAtsLoggerTagVersion={sizeof(L"version")/2-1, L"version"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"batch-result")/2 &gt; KAtsLoggerTagTestSetResult={sizeof(L"batch-result")/2-1, L"batch-result"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"id")/2 &gt; KAtsLoggerTagId={sizeof(L"id")/2-1, L"id"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"case-init")/2 &gt; KAtsLoggerTagTestCaseInit={sizeof(L"case-init")/2-1, L"case-init"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"expected-result")/2 &gt; KAtsLoggerTagExpected={sizeof(L"expected-result")/2-1, L"expected-result"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"run-time")/2 &gt; KAtsLoggerTagRunTime={sizeof(L"run-time")/2-1, L"run-time"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"case-result")/2 &gt; KAtsLoggerTagTestCaseResult={sizeof(L"case-result")/2-1, L"case-result"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"actual-result")/2 &gt; KAtsLoggerTagActual={sizeof(L"actual-result")/2-1, L"actual-result"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"debug-info")/2 &gt; KAtsLoggerTagDebug={sizeof(L"debug-info")/2-1, L"debug-info"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"warning")/2 &gt; KAtsLoggerTagWarning={sizeof(L"warning")/2-1, L"warning"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"error")/2 &gt; KAtsLoggerTagError={sizeof(L"error")/2-1, L"error"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"status")/2 &gt; KAtsLoggerTagStatus={sizeof(L"status")/2-1, L"status"};const static <a href="GUID-02059516-298A-3DB3-937C-9D9B2C1DBE07.html">TLitC</a>&lt; sizeof(L"time-stamp")/2 &gt; KAtsLoggerTimeStamp={sizeof(L"time-stamp")/2-1, L"time-stamp"};const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> KAtsLoggerBufferSegmentGranularity=32;class CAtsLogger:public <a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase</a>{public:enum TReportStage{ENone, EUninitialized, EBeginTestReport, EBeginTestSet, EBeginTestCase, ESetTestCaseVerdict, EEndTestCase, EEndTestSet, EEndTestReport, EFinished};private:public:IMPORT_C static CAtsLogger *NewL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aName, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aAfterReboot=EFalse);IMPORT_C~CAtsLogger();public:IMPORT_C static const <a href="GUID-8FE95467-D48B-3E61-9028-29C0F15F567E.html">TPtrC</a> ErrorMessage(const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> &amp;aError);IMPORT_C void CloseL();IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> IsValid();IMPORT_C void BeginTestReportL();IMPORT_C void EndTestReportL();IMPORT_C void SaveForRebootL();IMPORT_C void ContinueAfterRebootL();IMPORT_C void BeginTestSetL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aFactory=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerNa</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aComponent=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerNa</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aVersion=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerNa</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aDescription=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>);IMPORT_C void EndTestSetL();IMPORT_C void BeginTestCaseL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aId, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aExpected=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerNa</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aInfo=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aVersion=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>);IMPORT_C void BeginTestCaseL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aId, const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aExpected, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aInfo=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aVersion=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>);IMPORT_C void BeginTestCaseReportL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aId, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aExpected, const <a href="GUID-A2D3BA72-9B27-3BFF-950A-D7E3B2004821.html">TTime</a> &amp;aStartTime, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aInfo=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aVersion=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>);IMPORT_C void BeginTestCaseReportL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aId, const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aExpected, const <a href="GUID-A2D3BA72-9B27-3BFF-950A-D7E3B2004821.html">TTime</a> &amp;aStartTime, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aInfo=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aVersion=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>);IMPORT_C void EndTestCaseL();IMPORT_C void TestCasePassed();IMPORT_C void TestCaseFailed();IMPORT_C void TestCaseSkipped();IMPORT_C void TestCaseNa();IMPORT_C void SetTestCaseResultL(const <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> aResult);IMPORT_C void SetTestCaseResultL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aResult=<a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">KAtsLoggerEmpty</a>);IMPORT_C void SetTestCaseResultL(<a href="GUID-5391E485-A019-358F-85D2-3B55BA439BD1.html">TRefByValue</a>&lt; const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &gt; aFmt,...);IMPORT_C void DebugL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);IMPORT_C void DebugL(<a href="GUID-5391E485-A019-358F-85D2-3B55BA439BD1.html">TRefByValue</a>&lt; const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &gt; aFmt,...);IMPORT_C void WarningL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);IMPORT_C void WarningL(<a href="GUID-5391E485-A019-358F-85D2-3B55BA439BD1.html">TRefByValue</a>&lt; const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &gt; aFmt,...);IMPORT_C void ErrorL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);IMPORT_C void ErrorL(<a href="GUID-5391E485-A019-358F-85D2-3B55BA439BD1.html">TRefByValue</a>&lt; const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &gt; aFmt,...);IMPORT_C void CommentL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);IMPORT_C void CommentL(<a href="GUID-5391E485-A019-358F-85D2-3B55BA439BD1.html">TRefByValue</a>&lt; const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &gt; aFmt,...);IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> RawLogL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> RawLogL(<a href="GUID-5391E485-A019-358F-85D2-3B55BA439BD1.html">TRefByValue</a>&lt; const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &gt; aFmt,...);IMPORT_C void DebugOutput(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);IMPORT_C void SetFullReporting(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aFlag);IMPORT_C void SetDebugOutput(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aFlag);IMPORT_C void SetIndentation(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aFlag);public:protected:void TagL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);void TagL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aAttribute, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aValue);void TimeStampedMessageL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);void OpenTagL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag);void OpenTagL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aAttribute, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aValue);void OpenTagIndentL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag);void OpenTagIndentL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aAttribute, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aValue);void CloseTagL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag);void CloseTagIndentL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aTag);void LineFeedL();void WriteL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aData, <a href="GUID-BE0804F6-4375-3C8A-8C83-968F510466E0.html">RFile</a> &amp;aFile);void WriteL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aData);<a href="GUID-3D3D9CD7-C8FD-3F81-9CC5-1A71D4F9751E.html">HBufC</a> *EncodeLC(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aMsg);<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> IsTransitionLegal(const TReportStage &amp;aNewStage);protected:protected:private:void ConstructL(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aAfterReboot);CAtsLogger(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aName);<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> CheckDirectoryL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aDirName, <a href="GUID-CDCFA2A5-EA8A-3B39-B90F-77AC41571E2D.html">TChar</a> &amp;aDrive);<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> ReplaceFileL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aFileName);<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> OpenExistingFileL(const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aFileName);<a href="GUID-3D3D9CD7-C8FD-3F81-9CC5-1A71D4F9751E.html">HBufC</a> *FormatDateLC(<a href="GUID-13A9DD2B-8ABC-3D62-B54E-4F5DD5B9228B.html">TDateTime</a> aDate);<a href="GUID-3D3D9CD7-C8FD-3F81-9CC5-1A71D4F9751E.html">HBufC</a> *FormatTimeLC(<a href="GUID-B7D6F874-1ABD-3AC6-9329-19DC54C12F18.html">TTimeIntervalMicroSeconds</a> aTime);<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> BufferL(<a href="GUID-33BEE1B4-20A1-392B-89B3-DA5D4F46418E.html">CBufBase</a> *aBufBase, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> &amp;aLength, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aBuf);<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> WriteBufferToFileL(<a href="GUID-33BEE1B4-20A1-392B-89B3-DA5D4F46418E.html">CBufBase</a> *aCBufBase, const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;aFileName);<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> WriteBufferToDebugPortL(<a href="GUID-33BEE1B4-20A1-392B-89B3-DA5D4F46418E.html">CBufBase</a> *aCBufBase);protected:class TTestSet{public:TTime iStartTime;};class TTestCase{public:TTestCase(){iResult=NULL;}~TTestCase(){if(iResult){delete iResult;iResult=NULL;}}public:HBufC *iResult;<a href="GUID-8FE95467-D48B-3E61-9028-29C0F15F567E.html">TPtrC</a> iStatus;<a href="GUID-A2D3BA72-9B27-3BFF-950A-D7E3B2004821.html">TTime</a> iStartTime;};CAtsLogger::TTestSet iTestSet;CAtsLogger::TTestCase iTestCase;CAtsLogger::TReportStage iReportStage;const <a href="GUID-0B9C8884-6BFF-35E2-AA6F-E4057B85AFCF.html">TFileName</a> iName;private:CBufBase *iXmlBuffer;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> <a href="GUID-1C85D057-BC3B-3D43-A076-6BA88A51D51A.html">iXmlBufferLength</a>;int iIndentLevel;<a href="GUID-E263C747-946F-35AA-9F1D-41833BD350FC.html">RFs</a> iRfs;<a href="GUID-0B9C8884-6BFF-35E2-AA6F-E4057B85AFCF.html">TFileName</a> iXmlLogFileName;<a href="GUID-0B9C8884-6BFF-35E2-AA6F-E4057B85AFCF.html">TFileName</a> iRawLogFileName;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iRawLog;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iXmlLog;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iValid;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iLineFeedDone;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iInTestCase;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iClosed;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iFullReportingMode;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iDoDebugOutput;<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> iDoIndentation;public:protected:private:};#20"X:/sf/os/osrndtools/stif/atslogger/src/atslogger.cpp"2CAtsLogger::CAtsLogger(const TDesC &amp;aName):iReportStage(EUninitialized), iName(aName), iIndentLevel(0), iRawLog(EFalse), iXmlLog(EFalse), iValid(EFalse), iLineFeedDone(EFalse), iInTestCase(EFalse), iClosed(EFalse), iFullReportingMode(ETrue), iDoDebugOutput(EFalse), iDoIndentation(ETrue){}void CAtsLogger::ConstructL(TBool aAfterReboot){TChar xmlDrive;iXmlLog=CheckDirectoryL(KAtsLoggerXmlDirectory, xmlDrive);TChar rawDrive;iRawLog=CheckDirectoryL(KAtsLoggerRawDirectory, rawDrive);if(iXmlLog){iXmlLogFileName.Copy((TPtrC((const TText *) L"?:")));iXmlLogFileName.Append(KAtsLoggerXmlDirectory);iXmlLogFileName.Append(iName);iXmlLogFileName.Append(KAtsLoggerXmlSuffix);iXmlLogFileName[0]=(TUint8) xmlDrive;if(aAfterReboot){User::LeaveIfError(OpenExistingFileL(iXmlLogFileName));}else{User::LeaveIfError(ReplaceFileL(iXmlLogFileName));}iValid=ETrue;}else{iValid=EFalse;}if(iRawLog){iRawLogFileName.Copy((TPtrC((const TText *) L"?:")));iRawLogFileName.Append(KAtsLoggerRawDirectory);iRawLogFileName.Append(iName);iRawLogFileName.Append(KAtsLoggerRawSuffix);iRawLogFileName[0]=(TUint8) rawDrive;if(aAfterReboot){User::LeaveIfError(OpenExistingFileL(iRawLogFileName));}else{User::LeaveIfError(ReplaceFileL(iRawLogFileName));}}iXmlBuffer=CBufSeg::NewL(KAtsLoggerBufferSegmentGranularity);iXmlBufferLength=0;}TBool CAtsLogger::CheckDirectoryL(const TDesC &amp;aDirName, TChar &amp;aDrive){User::LeaveIfError(iRfs.Connect());TDriveList driveList;iRfs.DriveList(driveList);TBool dirFound=EFalse;TFileName dir;for(TInt i=0;i&lt; driveList.Length()&amp;&amp;!dirFound;i++){TChar drive;if(driveList[i]!=0){iRfs.DriveToChar(i, drive);dir.Copy((TPtrC((const TText *) L"?:")));dir.Append(aDirName);dir[0]=(TUint8) drive;RDir rDir;TInt error=rDir.Open(iRfs, dir, KEntryAttNormal);if(error==KErrNone){dirFound=ETrue;aDrive=drive;}else{dirFound=EFalse;aDrive= '?';}rDir.Close();}}iRfs.Close();return dirFound;}TInt CAtsLogger::ReplaceFileL(const TDesC &amp;aFileName){User::LeaveIfError(iRfs.Connect());RFile file;TInt err=file.Replace(iRfs, aFileName, EFileWrite|EFileShareAny);file.Close();iRfs.Close();return err;}TInt CAtsLogger::OpenExistingFileL(const TDesC &amp;aFileName){User::LeaveIfError(iRfs.Connect());RFile file;TInt err=file.Open(iRfs, aFileName, EFileWrite|EFileShareAny);file.Close();iRfs.Close();return err;}EXPORT_C CAtsLogger::~CAtsLogger(){if(!iClosed){CloseL();}if(iXmlBuffer){delete iXmlBuffer;iXmlBuffer=0;}}EXPORT_C void CAtsLogger::CloseL(){if(iClosed){return;}User::LeaveIfError(iRfs.Connect());if(iXmlLog){RFile file;TInt err=file.Open(iRfs, iXmlLogFileName, EFileWrite|EFileShareAny);if(err==KErrNone){TInt fileSize=0;file.Size(fileSize);file.Close();if(fileSize==0){iRfs.Delete(iXmlLogFileName);}}}if(iRawLog){RFile file;TInt err=file.Open(iRfs, iRawLogFileName, EFileWrite|EFileShareAny);if(err==KErrNone){TInt fileSize=0;file.Size(fileSize);file.Close();if(fileSize==0){iRfs.Delete(iRawLogFileName);}}}iRfs.Close();iClosed=ETrue;}EXPORT_C CAtsLogger *CAtsLogger::NewL(const TDesC &amp;aName, TBool aAfterReboot){(void)((aName.Length() &gt; 0)||(User::Leave(KErrBadName),0));RFs rfs;User::LeaveIfError(rfs.Connect());(void)((rfs.IsValidName(aName))||(User::Leave(KErrBadName),0));rfs.Close();CAtsLogger *self=new(ELeave) CAtsLogger(aName);CleanupStack::PushL(self);self-&gt;ConstructL(aAfterReboot);CleanupStack::Pop(self);return self;}EXPORT_C TBool CAtsLogger::IsValid(){return iValid;}EXPORT_C void CAtsLogger::BeginTestReportL(){if(iFullReportingMode){if(!IsTransitionLegal(EBeginTestReport)){User::Leave(EBeginTestReport);}iReportStage=EBeginTestReport;OpenTagIndentL(KAtsLoggerTagTestReport());}else{iTestSet.iStartTime.HomeTime();}}EXPORT_C void CAtsLogger::EndTestReportL(){if(iFullReportingMode){if(!IsTransitionLegal(EEndTestReport)){User::Leave(EEndTestReport);}iReportStage=EEndTestReport;CloseTagIndentL(KAtsLoggerTagTestReport());}if(iDoDebugOutput){WriteBufferToDebugPortL(iXmlBuffer);}if(iXmlLog &amp;&amp;!iInTestCase &amp;&amp;iXmlBufferLength &gt; 0){WriteBufferToFileL(iXmlBuffer, iXmlLogFileName);}iXmlBuffer-&gt;</td><td>Reset</td><td>[static]</td></tr></table><div class="section"></div>

	</div>

	<div class="nested1" id="GUID-3DD0DCE6-3136-358B-B8A6-5507762077CB"><a name="GUID-3DD0DCE6-3136-358B-B8A6-5507762077CB"><!-- --></a>
		<h2 class="topictitle2"> iXmlBufferLength</h2>
		<table class="signature"><tr><td/><td>iXmlBufferLength</td></tr></table><div class="section"></div>

	</div>

	
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>