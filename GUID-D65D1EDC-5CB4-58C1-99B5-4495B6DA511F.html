<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Text resource utility overview"/>
<meta name="DC.Relation" scheme="URI" content="GUID-61B965D9-B85E-5F40-8D56-1C0FA77D2492.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-94005A46-B4C6-4A30-A8E8-1B9C2D583D50.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E079315A-E5B6-4D33-B7E3-88697A3F11A4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-61B965D9-B85E-5F40-8D56-1C0FA77D2492.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Text resource utility overview</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F"><a name="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2561792 id2839629 id2839138 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-94005A46-B4C6-4A30-A8E8-1B9C2D583D50.html">Classic UI Guide</a> &gt; <a href="GUID-E079315A-E5B6-4D33-B7E3-88697A3F11A4.html">Control and animation framework</a> &gt; <a href="GUID-61B965D9-B85E-5F40-8D56-1C0FA77D2492.html" title="This section explains the Symbian Text Utility components and the miscellaneous user interface utility functions relating to fonts, colors and drawing.">Using UI Graphics Utilities (EGUL) and Text Utilities (ETUL)</a> &gt; </div>
<h1 class="topictitle1">Text resource
utility overview</h1>
<div>
<div class="section" id="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-C6857C66-B599-4AA0-9ABE-469ADDE4BA5D"><a name="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-C6857C66-B599-4AA0-9ABE-469ADDE4BA5D"><!-- --></a><h2 class="sectiontitle">Purpose</h2> <p>Text
Resource Utility is part of the Symbian Text Utilities. It is an API class,
which provides static methods for loading and formatting resource strings.
The purpose of Text Resource Utility is to make localization of the software
easier by allowing variable order in indexing of the key strings in the resource
string. </p>
 <p>Text Resource Utility provides resource string loading and
formatting methods for other subsystems. Through simple <samp class="codeph">Load()</samp> and <samp class="codeph">Format()</samp> operation
calls, the user can access resource strings which may contain formatting parameters
(<samp class="codeph">%U</samp> for text or <samp class="codeph">%N</samp> for numerical). Strings
can contain multiple instances of the same parameter. The <samp class="codeph">0x0001</samp> character
has special meaning in strings; it is used to delimit different options for
displayable string. The client of <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">TulTextResourceUtils</span></a> is
responsible for choosing the proper string to display from given options. </p>
 </div>

<div class="section" id="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-BAEBDD2B-2A9D-4BE6-9078-7835CF9B4E05"><a name="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-BAEBDD2B-2A9D-4BE6-9078-7835CF9B4E05"><!-- --></a><h2 class="sectiontitle">Architectural
Relationships</h2> <p>The implementation requires a <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">CCoeEnv</span></a> instance
(given as reference by the user or <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">CCoeEnv::Static</span></a>)
to access the resource files. </p>
 <p>All interface methods are static, so
there is no need to explicitly allocate memory for the interface class. All
functionality is accessed through exported methods of the <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">TulTextResourceUtils</span></a> class. </p>
 <p>The
interface is accessed through the <samp class="codeph">tultextresourceutils.h</samp> header
file. Binaries are linked to the <samp class="codeph">etul.dll</samp> library. </p>
 </div>

<div class="section" id="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-3694DAEC-D25F-4E28-87EA-E1D230571003"><a name="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-3694DAEC-D25F-4E28-87EA-E1D230571003"><!-- --></a><h2 class="sectiontitle">Description</h2> <p><strong>Usage</strong> </p>
 <p>Applications
load and format resource strings from normal resources with static methods
of the <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">TulTextResourceUtils</span></a> class.
The loading is done with the <samp class="codeph">LoadL()</samp> and <samp class="codeph">LoadLC()</samp> methods
and with the <samp class="codeph">Load()</samp> method in situations where memory allocation
from the heap is not possible. Formatting is done automatically after loading
in the <samp class="codeph">LoadL()</samp> and <samp class="codeph">LoadLC() </samp> methods, but
it can also be done separately with the <samp class="codeph">Format() </samp> method
in situations where memory allocation from the heap is not possible. </p>
 <p>For
reading the resource strings with the<samp class="codeph"> Load()</samp>, <samp class="codeph">LoadL()</samp> and <samp class="codeph">LoadLC()</samp> methods,
the user should provide a pointer to <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">CCoeEnv</span></a> for
efficiency reasons. If the pointer is not provided, the implementation uses
the <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">CCoeEnv::Static</span></a> method
internally to get it. The user can get a pointer to <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">CCoeEnv</span></a>,
for example, via the <samp class="codeph">iEikonEnv</samp> macro (for which see <samp class="codeph">&lt;eikdef.h&gt;</samp>). </p>
 <p><strong>Scalable
UI Support</strong> </p>
 <p>Different size displays can handle different length
strings. To take full advantage of this fact, <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">TulTextResourceUtils</span></a> supports
resource strings with multiple options for string separated by <samp class="codeph">0x0001</samp> character.
Each such string can contain same or different sub string keys (<samp class="codeph">%U</samp> and <samp class="codeph">%N</samp>). <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">TulTextResourceUtils</span></a> returns all strings,
it is the responsibility of the caller to parse the result and choose the
proper string to display. </p>
 <p><strong>Setting the Maximum Substring Length</strong> </p>
 <p>This
may be done in the text resources. Sub string maximum lengths can be localized
separately for every language. </p>
 <p>The maximum sub string length is of
the format: </p>
 <pre class="codeblock" id="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-AA1192AA-292D-59B4-9235-178AD1CC6681"><a name="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-AA1192AA-292D-59B4-9235-178AD1CC6681"><!-- --></a>%U[NN] </pre>
 <p>where <samp class="codeph">NN</samp> is
a number <samp class="codeph">[01..99]</samp>. Please note that <samp class="codeph">NN</samp> must
always consist of two characters, in other words, if the sub string maximum
length is eight characters, the value to be used is <samp class="codeph">08</samp>, not
plain <samp class="codeph">8</samp>. </p>
 <p>If the number of characters exceeds the
maximum length, the sub string is cut to fit and the last character is replaced
with an ellipsis character. </p>
 <p><strong>Error Handling</strong> </p>
 <p>The leave
mechanism is used to handle memory exhaustion. Errors in application programming
are handled with the panic mechanism. The error codes used are as follows: </p>
 
<div class="tablenoborder"><a name="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-3320467E-C326-523F-9B44-EB8BC916BFA5"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-3320467E-C326-523F-9B44-EB8BC916BFA5" frame="border" border="1" rules="all">
<tbody>
<tr>
<td class="cellrowborder" valign="top"><p><samp class="codeph">ETooFewArguments</samp> </p>
 </td>

<td class="cellrowborder" valign="top"><p>= 0: Unsolved parameters in the resource string. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p><samp class="codeph">ETooManyArguments</samp> </p>
 </td>

<td class="cellrowborder" valign="top"><p>= 1: Already solved all parameters in the resource string. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p><samp class="codeph">EKeyStringNotFound</samp> </p>
 </td>

<td class="cellrowborder" valign="top"><p>= 2: The key string was not found in formatting. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p><samp class="codeph">EInvalidIndex</samp> </p>
 </td>

<td class="cellrowborder" valign="top"><p>= 3: Invalid index in the Format method. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p><samp class="codeph">EDescriptorTooSmall</samp> </p>
 </td>

<td class="cellrowborder" valign="top"><p>= 4: Too small destination descriptor. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p><samp class="codeph">ECCoeEnvNotInitialized</samp> </p>
 </td>

<td class="cellrowborder" valign="top"><p>= 5: <samp class="codeph">CCoeEnv</samp> not initialized. </p>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p><samp class="codeph">EInvalidSubstitute</samp> </p>
 </td>

<td class="cellrowborder" valign="top"><p>= 6: Substituted string contains substring separator (i.e. 0x0001). </p>
 </td>

</tr>

</tbody>

</table>
</div>
 <p><strong>Example</strong> </p>
 <p>The following example describes the usage
of the Text Resource Utility component: </p>
 <pre class="codeblock" id="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-6B0C9F3E-DC2C-511B-B58B-03CF363B794D"><a name="GUID-D65D1EDC-5CB4-58C1-99B5-4495B6DA511F__GUID-6B0C9F3E-DC2C-511B-B58B-03CF363B794D"><!-- --></a>/*  Using examples: */

#include &lt;tultextresourceutils.h&gt;

// Get CCoeEnv instance
CEikonEnv* iEikonEnv = CEikonEnv::Static();

/*
*   One TInt to add:
*/

//(In .loc -file)
#define TEXT_EXAMPLE "You have %N undone tasks."

//(In .rss -file)
RESOURCE TBUF R_TEXT_EXAMPLE { buf = TEXT_EXAMPLE; }

//(In the .cpp -file)
TInt number( 324 );

//
//iEikonEnv is needed for loading the resource string.
//
HBufC* stringholder = TulTextResourceUtils::LoadL( R_TEXT_EXAMPLE, number, iEikonEnv );

//
//The TInt in number is added to the resource string. The result is
//that stringholder points to a heap descriptor containing string:
//"You have 324 undone tasks."
//

/*
*   Several strings to add:
*/

//(In a .loc -file)
#define TEXT_EXAMPLE "I'm %2U%1U %3U%0U fine." 

//(In an .rss -file)
RESOURCE TBUF R_TEXT_EXAMPLE { buf = TEXT_EXAMPLE; }

//(In the .cpp -file)
CDesCArrayFlat* strings = new CDesCArrayFlat( 4 );
CleanupStack::PushL( strings );

strings-&gt;AppendL( _L("orking") ); //First string

strings-&gt;AppendL( _L("ll") ); //Second string

strings-&gt;AppendL( _L("sti") ); //Third string

strings-&gt;AppendL( _L("w") ); //Fourth string

//
//iEikonEnv is needed for loading the resource string.
//
HBufC* stringholder = TulTextResourceUtils::LoadL( R_TEXT_EXAMPLE, *strings, iEikonEnv );

//
//The strings in strings are added to the resource string. The result is
//that stringholder points to a heap descriptor containing string:
//"I'm still working fine."
//

/*
* Scalable UI support
*/
//(In .loc -file)
#define TEXT_EXAMPLE "You have missed %N messages from %U."&lt;0x0001&gt;"Missed %N msgs from %U."&lt;0x0001&gt;"Missed %N msgs."

//(In .rss -file)
RESOURCE TBUF R_TEXT_EXAMPLE { buf = TEXT_EXAMPLE; }

//(In the .cpp -file)
TInt number( 12 );
_LIT(name, “John Doe”);

//
//iEikonEnv is needed for loading the resource string.
//
HBufC* stringholder = TulTextResourceUtils::LoadL(R_TEXT_EXAMPLE,name,number,iEikonEnv);

//
//The number and name are added to the resource string. The result is
//that stringholder points to a heap descriptor containing string:
//"You have missed 12 messages from John Doe.\001Missed 12 msgs from John
// Doe.\001Missed 12 msgs."
//

CleanupStack::PopAndDestroy(); //strings
</pre>
 <p>For more information on individual methods, please see the
reference API for <a href="GUID-E19C9DB8-2C8B-366B-B650-2673B066256D.html"><span class="apiname">TulTextResourceUtils</span></a>. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-61B965D9-B85E-5F40-8D56-1C0FA77D2492.html" title="This section explains the Symbian Text Utility components and the miscellaneous user interface utility functions relating to fonts, colors and drawing.">Using UI Graphics Utilities (EGUL) and Text Utilities (ETUL)</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>