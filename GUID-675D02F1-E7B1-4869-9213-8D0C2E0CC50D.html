<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Adding, Removing and Accessing Header Field Parts"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F6CF2920-9095-568B-B332-D5F4A05BD23A.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C0D38954-2FC5-4E8B-BC11-229464DCF16C.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-1E8904E3-43AC-5332-A2EF-F11F5728DBE8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B4A54501-4AA4-5ACB-96D7-4427C7752639.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F6CF2920-9095-568B-B332-D5F4A05BD23A.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Adding, Removing and Accessing Header Field Parts</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D"><a name="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387372 id2387380 id2387389 id2387497 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C0D38954-2FC5-4E8B-BC11-229464DCF16C.html">High Level Internet Protocols Guide</a> &gt; <a href="GUID-1E8904E3-43AC-5332-A2EF-F11F5728DBE8.html">Application Layer Protocols</a> &gt; <a href="GUID-B4A54501-4AA4-5ACB-96D7-4427C7752639.html">Using HTTP Client</a> &gt; <a href="GUID-F6CF2920-9095-568B-B332-D5F4A05BD23A.html">Headers</a> &gt; </div>
<h1 class="topictitle1">Adding,
Removing and Accessing Header Field Parts</h1>
<div>
<div class="section" id="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-F273A4FC-D2C7-45A2-A2CA-12D9B6C8531C"><a name="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-F273A4FC-D2C7-45A2-A2CA-12D9B6C8531C"><!-- --></a> <p>Header field parts are added by repeated invocation of the <a href="GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9.html#GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9__GUID-A8708AE6-8EAE-37C9-BAD2-87E4A7DCE266"><span class="apiname">RHTTPHeaders::SetFieldL()</span></a> method.
On the first invocation, when no field of that name exists in the header,
a new field is created with a single part. On subsequent invocations, additional
parts are added to the existing header field. </p>
 <p>This behaviour is consistent
with HTTP/1.1 in which: </p>
 <pre class="codeblock" id="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-16F90813-AABE-5855-A7EB-6CB4C4D52225"><a name="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-16F90813-AABE-5855-A7EB-6CB4C4D52225"><!-- --></a>Accept: text/*, text/html</pre>
 <p>is
preferable to </p>
 <pre class="codeblock" id="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-7290C356-D37B-5A79-9C11-470D500647CC"><a name="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-7290C356-D37B-5A79-9C11-470D500647CC"><!-- --></a>Accept: text/* text/html</pre>
 <p>Although
the two are semantically equivalent, the API will not output the second variant
under any circumstance. </p>
 <p>When parts are added to a header field, they
are given an index number. The first part to be added has index 0, the second
is index 1, and so on. This index is necessary when identifying parts for
retrieval (using <a href="GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9.html#GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9__GUID-E89FA67E-7E0B-3C37-B920-B6E594A31BFE"><span class="apiname">RHTTPHeaders::GetField()</span></a>). </p>
 <p>To
remove a single header field part, <a href="GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9.html#GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9__GUID-656EF7AC-479E-3408-B00C-9FAE3022A37B"><span class="apiname">RHTTPHeaders::RemoveFieldPart()</span></a> is
used, specifying a part index. To remove a header field entirely, <a href="GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9.html#GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9__GUID-2C6BE5F2-E486-39E9-8594-2E5A5E936C1A"><span class="apiname">RHTTPHeaders::RemoveField()</span></a> is
used. </p>
 <p>Part values are accessed using <a href="GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9.html#GUID-54F9A87B-FE2F-3429-9793-0A24B83466B9__GUID-E89FA67E-7E0B-3C37-B920-B6E594A31BFE"><span class="apiname">RHTTPHeaders::GetField()</span></a>.
The client must supply a part index and an uninitialized <a href="GUID-DEE8279A-3BEC-316F-97B8-6C49FEDBD5B3.html"><span class="apiname">THTTPHdrVal</span></a>,
which will be filled by the method. This example, from <span class="filepath">HTTPEXAMPLECLIENT</span>,
retrieves all response headers and prints their values: </p>
 <pre class="codeblock" id="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-034F2800-1177-5E78-8253-134E5B2C2323"><a name="GUID-675D02F1-E7B1-4869-9213-8D0C2E0CC50D__GUID-034F2800-1177-5E78-8253-134E5B2C2323"><!-- --></a>void CHttpEventHandler::DumpRespHeadersL(RHTTPTransaction&amp; aTrans)
    {
    RHTTPResponse resp = aTrans.Response();
    RStringPool strP = aTrans.Session().StringPool();
    RHTTPHeaders hdr = resp.GetHeaderCollection();
    THTTPHdrFieldIter it = hdr.Fields();

    TBuf&lt;KMaxHeaderNameLen&gt;  fieldName16;
    TBuf&lt;KMaxHeaderValueLen&gt; fieldVal16;

    while (it.AtEnd() == EFalse)
        {
        RStringTokenF fieldName = it();
        RStringF fieldNameStr = strP.StringF(fieldName);
        THTTPHdrVal fieldVal;
        if (hdr.GetField(fieldNameStr,0,fieldVal) == KErrNone)
            {
            const TDesC8&amp; fieldNameDesC = fieldNameStr.DesC();
            fieldName16.Copy(fieldNameDesC.Left(KMaxHeaderNameLen));
            switch (fieldVal.Type())
                {
            case THTTPHdrVal::KTIntVal:
                iUtils.Test().Printf(_L("%S: %d\n"), &amp;fieldName16, fieldVal.Int());
                break;
            case THTTPHdrVal::KStrFVal:
                {
                RStringF fieldValStr = strP.StringF(fieldVal.StrF());
                const TDesC8&amp; fieldValDesC = fieldValStr.DesC();
                fieldVal16.Copy(fieldValDesC.Left(KMaxHeaderValueLen));
                iUtils.Test().Printf(_L("%S: %S\n"), &amp;fieldName16, &amp;fieldVal16);
                fieldValStr.Close();
                }
                break;
            case THTTPHdrVal::KStrVal:
                {
                RString fieldValStr = strP.String(fieldVal.Str());
                const TDesC8&amp; fieldValDesC = fieldValStr.DesC();
                fieldVal16.Copy(fieldValDesC.Left(KMaxHeaderValueLen));
                iUtils.Test().Printf(_L("%S: %S\n"), &amp;fieldName16, &amp;fieldVal16);
                fieldValStr.Close();
                }
                break;
            case THTTPHdrVal::KDateVal:
                {
                TDateTime date = fieldVal.DateTime();
                TBuf&lt;40&gt; dateTimeString;
                TTime t(date);
                t.FormatL(dateTimeString,KDateFormat);
                iUtils.Test().Printf(_L("%S: %S\n"), &amp;fieldName16, &amp;dateTimeString);
                } 
                break;
            default:
                iUtils.Test().Printf(_L("%S: &lt;unrecognised value type&gt;\n"), &amp;fieldName16);
                break;
                }
            ...
            }
        // Advance the iterator to get the next field
        ++it;
        }
     }</pre>
 <p>Note that in this example, only the first part of each
header field is displayed. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-F6CF2920-9095-568B-B332-D5F4A05BD23A.html">Headers</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>