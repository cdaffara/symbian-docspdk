<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Creating Email Messages in Rich Text Format"/>
<meta name="abstract" content="This tutorial explains how to store the email message data in rich text format. Storing email messages in rich text format results in increased RAM storage space, when compared to storing messages in plain text format."/>
<meta name="description" content="This tutorial explains how to store the email message data in rich text format. Storing email messages in rich text format results in increased RAM storage space, when compared to storing messages in plain text format."/>
<meta name="DC.Relation" scheme="URI" content="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B394A824-8745-505E-8429-8B9B6D418387.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-179099DA-1CD9-5912-B41B-363C132C7A86.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Creating Email Messages in Rich Text Format</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2404348 id2404397 id2404434 id2404652 id2404788 id2404819 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4.html">Messaging Middleware Guide</a> &gt; <a href="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388.html">Messaging Framework</a> &gt; <a href="GUID-B394A824-8745-505E-8429-8B9B6D418387.html">Message Server and Store</a> &gt; <a href="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6.html">Message Server and Store Tutorials</a> &gt; <a href="GUID-179099DA-1CD9-5912-B41B-363C132C7A86.html">Processing Email in Chunks</a> &gt; <a href="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html">Creating and Reading Email Messages in Chunks</a> &gt; </div>
<h1 class="topictitle1">Creating
Email Messages in Rich Text Format</h1>
<div><p>This tutorial explains how to store the email message data in rich
text format. Storing email messages in rich text format results in increased
RAM storage space, when compared to storing messages in plain text format.</p>

<div class="section"><h2 class="sectiontitle">Procedure</h2> <a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-F7EF7462-A65E-50B0-BCDA-C915EB69DAAE"><!-- --></a><ol id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-F7EF7462-A65E-50B0-BCDA-C915EB69DAAE">
<li id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-022C69C9-BFBF-5540-ABA1-DEAB836BCC26"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-022C69C9-BFBF-5540-ABA1-DEAB836BCC26"><!-- --></a><p>Create an email entry
in the message store using <a href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498__GUID-FCDC47D2-0446-3CD7-A246-4DCED7C8A063"><span class="apiname">CImEmailOperation::CreateNewL()</span></a>,
which takes all the following nine parameters. </p>
 <div class="p"><pre class="codeblock" id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-5BAB9612-275D-56C7-91B7-ED6D7AF93CA6"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-5BAB9612-275D-56C7-91B7-ED6D7AF93CA6"><!-- --></a>static IMPORT_C CImEmailOperation *CreateNewL(TRequestStatus &amp;aObserverRequestStatus,
CMsvSession &amp;aMsvSession, TMsvId aDestination, TMsvId aSmtpServiceId,
TMsvPartList aPartList, const TMsvEmailTypeList &amp;aMsvEmailTypeList,
TUid aMsgType, TInt aPriority, TBool aUsePlainTextStorage);</pre>
 </div>
 </li>

<li id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-83FDEF9F-DD2A-502B-9A80-3FBA28347261"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-83FDEF9F-DD2A-502B-9A80-3FBA28347261"><!-- --></a><p>Set the <a href="GUID-4B942C06-1BAC-3A21-B3B1-89FB5C51ADA0.html"><span class="apiname">TBool</span></a> parameter
to <samp class="codeph">EFalse</samp>. </p>
 </li>

<li id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-DC8EEF57-35F8-5A28-83E7-7C98069C357C"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-DC8EEF57-35F8-5A28-83E7-7C98069C357C"><!-- --></a><p>Use the <a href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498__GUID-38E7EABD-1300-3DF2-B9DF-B65EEABD8A31"><span class="apiname">CImEmailOperation::ProgressL()</span></a> function
to obtain the <a href="GUID-A4B1F874-27C0-3BB6-9D29-C35C75A5DB98.html"><span class="apiname">TMsvId</span></a> parameter of the newly created email.
This is returned through a <a href="GUID-36B29964-420D-38D0-AF08-4DA70BED8B6E.html"><span class="apiname">TPckgC</span></a> &lt;<a href="GUID-A4B1F874-27C0-3BB6-9D29-C35C75A5DB98.html"><span class="apiname">TMsvId</span></a> &gt;
descriptor. </p>
 </li>

<li id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-16CDC45A-B8A6-5141-80A1-569182A2E642"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-16CDC45A-B8A6-5141-80A1-569182A2E642"><!-- --></a><p>Create a <a href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><span class="apiname">CMsvEntry</span></a> object
using the <a href="GUID-A4B1F874-27C0-3BB6-9D29-C35C75A5DB98.html"><span class="apiname">TMsvId</span></a>  <samp class="codeph">aMessageId</samp> parameter
of the newly created email. </p>
 </li>

<li id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-FBDF917D-2265-524A-B574-500DC13F0095"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-FBDF917D-2265-524A-B574-500DC13F0095"><!-- --></a><p>Use the <a href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><span class="apiname">CMsvEntry</span></a> object
to the create a <a href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html"><span class="apiname">CImEmailMessage</span></a> object. </p>
 </li>

<li id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-F52E2F63-5A8C-566A-B1B9-7B7D3EBEB4FE"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-F52E2F63-5A8C-566A-B1B9-7B7D3EBEB4FE"><!-- --></a><p>Create the body text
of the email and insert into a <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html"><span class="apiname">CRichText</span></a> object. </p>
 </li>

<li id="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-D1E2F8C6-8DB8-564F-8F46-08AD7329BA99"><a name="GUID-F9F45DE7-6688-5C31-90F0-0BEA72E74034__GUID-D1E2F8C6-8DB8-564F-8F46-08AD7329BA99"><!-- --></a><p>Call the <a href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44__GUID-791117B4-C946-3D43-AE1E-68DDC10F85A3"><span class="apiname">CImEmailMessage::StoreBodyTextL()</span></a> function
and pass the <a href="GUID-39945DA4-B362-3DF6-BF9E-DD079EEA7934.html"><span class="apiname">CRichText</span></a> class that contains the body text
of the message. </p>
 </li>

</ol>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-9A3E0279-4F87-594D-A987-66DC77F408A0.html">Creating and Reading Email Messages in Chunks</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-2C8653F9-8873-59E8-9FD2-4215F6877ABC.html">Chunk Method
to Process Emails</a></div>
<div><a href="GUID-D73AD200-BE4D-50BF-BCF9-14627DE530B7.html">Imap4Example:
An Email manager using IMAP4 and SMTP</a></div>
<div><a href="GUID-BB35DBCC-FE56-547F-BADA-9EF854691ADC.html">Pop3Example:
An Email manager using POP3 and SMTP</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>