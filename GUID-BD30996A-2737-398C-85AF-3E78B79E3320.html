<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="cxxClass"/>
<meta name="DC.Title" content="RShBuf"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-BD30996A-2737-398C-85AF-3E78B79E3320"/>

<title>RShBuf</title>

<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="cxxref.css"/></head>
<body class="cxxref" id="GUID-BD30996A-2737-398C-85AF-3E78B79E3320"><a name="GUID-BD30996A-2737-398C-85AF-3E78B79E3320"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2437088 id2437096 id2578593 id2557087 id2441463 id2441468 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">
<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt;</div>
<h1 class="topictitle1">RShBuf Class Reference</h1>
	<table class="signature"><tr><td>class RShBuf : public RHandleBase</td></tr></table><div class="section"><div>
			<p>A handle to a shared buffer within a pool.</p>

			<p>A user-side or kernel-side component allocates the buffer and then passes the handle to the recipient.</p>

			<p>Upon receiving a buffer handle. the recipient may map the buffer memory into its address space if not already done so.</p>

			<p>When finished with the buffer, the recipient must <a href="GUID-BD30996A-2737-398C-85AF-3E78B79E3320.html#GUID-8F402CFF-310E-37CB-A3A7-F0FD659D2B63">Close()</a> the handle. This invalidates the handle; any further attempt to use it will panic the thread.</p>

			<p>Buffers are reference-counted and will only be freed and returned to the pool when all users have closed them.</p>

			<p>These handles are process-relative.</p>

		</div></div>
<div class="section derivation"><h2 class="sectiontitle">Inherits from</h2><ul class="derivation derivation-root"><li class="derivation-depth-0 ">RShBuf<ul class="derivation"><li class="derivation-depth-1 "><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase</a></li></ul></li></ul></div>
<div class="section member-index"><table border="0" class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code"/><td><a href="#GUID-17125A95-009E-3B2D-B573-DC117D4E15CC">RShBuf</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><a href="#GUID-37A31176-8897-3A19-9839-A62E37897480">Alloc</a>(<a href="GUID-69A28019-A2D4-3498-8205-ABE6F5F5A213.html">RShPool</a> &amp;, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-8F402CFF-310E-37CB-A3A7-F0FD659D2B63">Close</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><a href="#GUID-DFF0D347-7C2D-30D6-9EBA-7F1D45E663F8">Map</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a>)</td></tr><tr><td align="right" class="code">IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint8</a> *</td><td><a href="#GUID-5FF88888-6F70-31CE-A63B-3C23C2DAF50A">Ptr</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td><a href="#GUID-C7301F59-F0E4-3A4A-AAF0-360F1B0FC559">Size</a>()</td></tr><tr><td align="right" class="code">IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><a href="#GUID-6F809995-F645-3834-9D79-84740D291CD2">UnMap</a>()</td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Functions</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::Attributes()const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::BTraceId()const</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::DoExtendedClose()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::Duplicate(const RThread &amp;,TOwnerType)</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::FullName()const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::FullName(TDes &amp;)const</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::Handle()const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::HandleInfo(THandleInfo *)</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::Name()const</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::NotifyDestruction(TRequestStatus &amp;)</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::Open(const TFindHandleBase &amp;,TOwnerType)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::OpenByName(const TDesC &amp;,TOwnerType,TInt)</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::RHandleBase()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::RHandleBase(TInt)</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::SetHandle(TInt)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::SetHandleNC(TInt)</a></td></tr><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::SetReturnedHandle(TInt)</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::SetReturnedHandle(TInt,RHandleBase &amp;)</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Enumerations</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase:TAttributes</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Private Attributes</th></tr></thead><tbody><tr><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TLinAddr</a>
				</td><td><a href="#GUID-4CD9181F-C7EC-3E0E-846E-004F7EA5D79B">iBase</a></td></tr><tr class="bg"><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
				</td><td><a href="#GUID-32CED7A6-BA8D-350C-89DD-0E34FA571729">iSize</a></td></tr><tr><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
				</td><td><a href="#GUID-4CB4CABF-50B9-3054-A7BC-C30F71A187B8">iSpare1</a></td></tr><tr class="bg"><td align="right" valign="top">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
				</td><td><a href="#GUID-94377381-1430-33FC-81A2-B2C6AD1B4FE5">iSpare2</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Attributes</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html">RHandleBase::iHandle</a></td></tr></tbody></table></div><h1 class="pageHeading topictitle1">Constructor &amp; Destructor Documentation</h1><div class="nested1" id="GUID-17125A95-009E-3B2D-B573-DC117D4E15CC"><a name="GUID-17125A95-009E-3B2D-B573-DC117D4E15CC"><!-- --></a>
		<h2 class="topictitle2">RShBuf()</h2>
		<table class="signature"><tr><td>RShBuf</td><td>(</td><td>)</td><td>[inline]</td></tr></table><div class="section"></div>

	</div>
<h1 class="pageHeading topictitle1">Member Functions Documentation</h1><div class="nested1" id="GUID-37A31176-8897-3A19-9839-A62E37897480"><a name="GUID-37A31176-8897-3A19-9839-A62E37897480"><!-- --></a>
		<h2 class="topictitle2">Alloc(RShPool &amp;, TUint)</h2>
		<table class="signature"><tr><td>IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>Alloc</td><td>(</td><td><a href="GUID-69A28019-A2D4-3498-8205-ABE6F5F5A213.html">RShPool</a> &amp;</td><td>aPool,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td>aFlags = 0</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"/></tr></table><div class="section"><div>
				<p>Allocates a shared data buffer.</p>

				<p>By default this method will return immediately with KErrNoMemory if no buffer is available on the pool's free list, even if the pool could grow automatically.</p>

				<p>By default it will also map the allocated buffer into the calling process's address space.</p>

				<p>Setting EShPoolAllocCanWait in the flags indicates that the caller is prepared to wait while the pool is grown if a buffer is not immediately available on the free list.</p>

				<p>Setting EShPoolAllocNoMap in the flags indicates that the caller does not want the buffer to be automatically mapped into its address space. This can improve performance on buffers from page-aligned pools if the caller will not need to access the data in the buffer (e.g. if it will just be passing it on to another component). This only prevents mapping if the pool is set to not automatically map buffers into processes' address space.</p>

				<p>
					<a href="GUID-76A2B8B4-CFF7-3094-833D-96D261EAC253.html#GUID-FD76DE7E-86B8-337E-B503-EF9FF4CD9CDD">TShPoolAllocFlags</a> </p>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-69A28019-A2D4-3498-8205-ABE6F5F5A213.html">RShPool</a> &amp; aPool</td><td>Pool handle  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> aFlags = 0</td><td>Bitwise OR of values from TShPoolAllocFlags to specify non-default behaviour. </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-8F402CFF-310E-37CB-A3A7-F0FD659D2B63"><a name="GUID-8F402CFF-310E-37CB-A3A7-F0FD659D2B63"><!-- --></a>
		<h2 class="topictitle2">Close()</h2>
		<table class="signature"><tr><td>IMPORT_C void</td><td>Close</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Closes the handle.</p>

				<p>This has the effect of closing the associated kernel side object.</p>

				<p>As the associated object is a reference counting object, it is destroyed if there are no other open references to it.</p>

				<p>
					<a href="GUID-9230EF62-376A-389C-B720-7C1EDCB7EA97.html#GUID-9230EF62-376A-389C-B720-7C1EDCB7EA97">CObject</a> </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-DFF0D347-7C2D-30D6-9EBA-7F1D45E663F8"><a name="GUID-DFF0D347-7C2D-30D6-9EBA-7F1D45E663F8"><!-- --></a>
		<h2 class="topictitle2">Map(TBool)</h2>
		<table class="signature"><tr><td>IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>Map</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>aReadOnly = EFalse</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Maps the buffer into the calling process's virtual address space if not already done.</p>

				<p>It is not necessary to call this method on buffers from non-page-aligned pools, although it will cause no harm to do so (and will result in KErrNone being returned).</p>

				<p>It is not necessary to call this method on buffers from page-aligned pools returned by <a href="GUID-BD30996A-2737-398C-85AF-3E78B79E3320.html#GUID-37A31176-8897-3A19-9839-A62E37897480">Alloc()</a> unless EShPoolAllocNoMap was specified.</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aReadOnly = EFalse</td><td>Indicates whether the buffer should be mapped as read-only. The default is that of pool in the clients address space. </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-5FF88888-6F70-31CE-A63B-3C23C2DAF50A"><a name="GUID-5FF88888-6F70-31CE-A63B-3C23C2DAF50A"><!-- --></a>
		<h2 class="topictitle2">Ptr()</h2>
		<table class="signature"><tr><td>IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint8</a> *</td><td>Ptr</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p/>

			</div></div>

	</div>
<div class="nested1" id="GUID-C7301F59-F0E4-3A4A-AAF0-360F1B0FC559"><a name="GUID-C7301F59-F0E4-3A4A-AAF0-360F1B0FC559"><!-- --></a>
		<h2 class="topictitle2">Size()</h2>
		<table class="signature"><tr><td>IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td>Size</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p/>

			</div></div>

	</div>
<div class="nested1" id="GUID-6F809995-F645-3834-9D79-84740D291CD2"><a name="GUID-6F809995-F645-3834-9D79-84740D291CD2"><!-- --></a>
		<h2 class="topictitle2">UnMap()</h2>
		<table class="signature"><tr><td>IMPORT_C <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>UnMap</td><td>(</td><td>)</td><td/></tr></table><div class="section"><div>
				<p>Unmaps the buffer from the calling process's virtual address space.</p>

				<p/>

			</div></div>

	</div>
<h1 class="pageHeading topictitle1">Member Data Documentation</h1><div class="nested1" id="GUID-4CD9181F-C7EC-3E0E-846E-004F7EA5D79B"><a name="GUID-4CD9181F-C7EC-3E0E-846E-004F7EA5D79B"><!-- --></a>
		<h2 class="topictitle2">
					TLinAddr
				 iBase</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TLinAddr</a>
				</td><td>iBase</td><td>[private]</td></tr></table><div class="section"></div>

	</div>
<div class="nested1" id="GUID-32CED7A6-BA8D-350C-89DD-0E34FA571729"><a name="GUID-32CED7A6-BA8D-350C-89DD-0E34FA571729"><!-- --></a>
		<h2 class="topictitle2">
					TUint
				 iSize</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
				</td><td>iSize</td><td>[private]</td></tr></table><div class="section"></div>

	</div>
<div class="nested1" id="GUID-4CB4CABF-50B9-3054-A7BC-C30F71A187B8"><a name="GUID-4CB4CABF-50B9-3054-A7BC-C30F71A187B8"><!-- --></a>
		<h2 class="topictitle2">
					TUint
				 iSpare1</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
				</td><td>iSpare1</td><td>[private]</td></tr></table><div class="section"></div>

	</div>
<div class="nested1" id="GUID-94377381-1430-33FC-81A2-B2C6AD1B4FE5"><a name="GUID-94377381-1430-33FC-81A2-B2C6AD1B4FE5"><!-- --></a>
		<h2 class="topictitle2">
					TUint
				 iSpare2</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
				</td><td>iSpare2</td><td>[private]</td></tr></table><div class="section"></div>

	</div>

	
	
	
	
	
	
	
	
	
	
	
	
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>