<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Files Containing Multiple Content Objects"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E6762A98-36A4-5860-B3F9-2AEBBCEAAB2A.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E6C91CF2-A616-5E52-8BB2-630C42C8D540.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-7EE46FD9-DC9E-5C1F-9AC5-48F5212AF0CA.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E6762A98-36A4-5860-B3F9-2AEBBCEAAB2A.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Files Containing Multiple Content Objects</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423"><a name="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2858558 id2858692 id2858712 id2858727 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html">OS Security Guide</a> &gt; <a href="GUID-E6C91CF2-A616-5E52-8BB2-630C42C8D540.html">Content Management</a> &gt; <a href="GUID-7EE46FD9-DC9E-5C1F-9AC5-48F5212AF0CA.html">Content Access Framework</a> &gt; <a href="GUID-E6762A98-36A4-5860-B3F9-2AEBBCEAAB2A.html">Content Access Framework Concepts</a> &gt; </div>
<h1 class="topictitle1">Files
Containing Multiple Content Objects</h1>
<div>
<p>Content Access Framework provides a generic mechanism for exploring files
that contain multiple content objects. These files are often referred to as
archive files. This can be <span class="filepath">.ZIP</span> compression archive or
a DRM protected archive, such as an OMA <span class="filepath">.DCF</span> file. An
application can explore the content objects inside a file using the <a href="GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601.html#GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601__GUID-FC40011B-32D3-328B-BB59-35BEF46A215A"><span class="apiname">ContentAccess::CContent</span></a> class. </p>

<div class="section"><h2 class="sectiontitle">Structure of a file containing multiple content objects</h2> <p>An
archive file can have content objects and meta-data or information associated
with the content. This meta-data can include information, such as the MIME
type of the content, the encryption algorithm, the compressed size of the
content. This information can be retrieved from the attributes related to
a content object, see <a href="GUID-B6912FE7-4C2A-5FC7-BDA8-702CA2C0214A.html">Content
Object Attributes</a>. </p>
 <p>The content and meta-data may also be arranged
in a hierachy with container objects grouping content objects together. A
typical archive can have a complex structure as the example shown below: </p>
 <div class="fignone" id="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-13E44820-5D67-580F-BC0D-26A935EB1F72"><a name="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-13E44820-5D67-580F-BC0D-26A935EB1F72"><!-- --></a>
<img src="GUID-4B7410B2-849B-5E89-97BF-E06613F600CB_d0e583985_href.png"/>
</div>
 <p>In this scenario, the file itself can be considered as the top level
container. All other content, containers and meta-data are nested inside.
In an archive file, applications can quickly search for the content objects
they are interested in by using <a href="GUID-FC40011B-32D3-328B-BB59-35BEF46A215A.html#GUID-FC40011B-32D3-328B-BB59-35BEF46A215A__GUID-FA4BB868-3297-39F0-BAB8-C4BF4F5A2B60"><span class="apiname">ContentAccess::CContent::Search()</span></a>,
see <a href="GUID-09A760FD-4C2A-5F79-91F2-DCC25A63699C.html">Consumer API Tutorial</a>. </p>
 </div>

<div class="section" id="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-34F8F3F7-B497-5BBE-B282-33DF7DB0D560"><a name="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-34F8F3F7-B497-5BBE-B282-33DF7DB0D560"><!-- --></a><h2 class="sectiontitle">Identifying
a content object within a file</h2> <p>Archive files containing several
content objects cannot be referred to using just the URI of the file. The
Content Access Framework uses a concept of virtual paths to identify content
objects within a file. The virtual path is a combination of the file URI and
a unique identifier supplied by the agent: </p>
 <ul>
<li id="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-CA623AF7-3752-5369-BFE2-1CDADC963A26"><a name="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-CA623AF7-3752-5369-BFE2-1CDADC963A26"><!-- --></a><p> <samp class="codeph">URI</samp>:
the location of the file. </p>
 </li>

<li id="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-9455FFE0-129D-5EDB-B7E9-BC4D907DE53C"><a name="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-9455FFE0-129D-5EDB-B7E9-BC4D907DE53C"><!-- --></a><p> <samp class="codeph">UniqueId</samp>:
the content object inside the file. </p>
 </li>

</ul>
 <p>A content file is only handled by the agent that recognises it. The
unique identifier is not required to be decoded by anyone other than the agent
that generated it, so the format is left for the agent to implement as it
sees fit. For instance, an OMA DRM agent may put the Content ID (CID) in the <samp class="codeph">UniqueId</samp> field. </p>
 <p>The
only constraint is that the <samp class="codeph">UniqueId</samp> must be unique within
the file. An application must be able to directly reference a content object
just using the <samp class="codeph">UniqueId</samp>. </p>
 </div>

<div class="section" id="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-28BE6074-E800-5320-89DD-D047F5C0FD86"><a name="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-28BE6074-E800-5320-89DD-D047F5C0FD86"><!-- --></a><h2 class="sectiontitle">Objects used
to identify a content object within a file</h2> <p><strong>Virtual path pointer
objects on the stack </strong> </p>
 <p>The <a href="GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601.html#GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601__GUID-70925BDF-36EF-3705-9C95-9EE211543517"><span class="apiname">ContentAccess::TVirtualPathPtr</span></a> is
used to point to two descriptors holding the URI of a file and the <samp class="codeph">UniqueId</samp> of
a content object within the file. It can also be used to point to another <samp class="codeph">TVirtualPathPtr</samp>.
Since it is only a pointer, the original descriptors used to initalise the <samp class="codeph">TVirtualPathPtr</samp> must
not be destroyed or modified while the <samp class="codeph">TVirtualPathPtr</samp> is
still in use. </p>
 <p><strong>Virtual path objects on the heap </strong> </p>
 <p>The <a href="GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601.html#GUID-0F5CE9B5-E674-3962-8376-CFB1ECB2F601__GUID-D56FD380-1335-33BB-B42E-6C1911274B06"><span class="apiname">ContentAccess::CVirtualPath</span></a> class
stores the file URI and content object <samp class="codeph">UniqueId</samp> in its own
descriptors. There is a cast operator that allows the <samp class="codeph">CVirtualPath</samp> to
be used as if it were a <samp class="codeph">TVirtualPathPtr</samp> . </p>
 <p><strong>Examples </strong> </p>
 <pre class="codeblock" id="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-C2E6E29D-C2DF-5D7C-B262-B979FC91A1A8"><a name="GUID-B5CC77D2-5871-51D8-B359-77EFC081B423__GUID-C2E6E29D-C2DF-5D7C-B262-B979FC91A1A8"><!-- --></a>// Open a CContent object to browse the objects inside a file 
CContent *c = CContent::NewL(_L("C:\file.dcf")); 
CleanupStack::PushL(c); 

// Create an array to store the embedded objects 
RStreamablePtrArray&lt;CEmbeddedObject&gt; myArray; 

// Get an array of the embedded objects within the current container in the file 
c-&gt;GetEmbeddedObjects(myArray); 

// If necessary we can get a "mangled" version of the URI that 
// references the particular object within the file 
// i.e. "C:\file.dcf\\OBJECT1" 
                
CData* data = iContent-&gt;OpenContentL(EPlay,myArray[0]-&gt;UniqueId());

TFileName uri;
data-&gt;GetStringAttribute(EPreviewURI,uri); 
.
.
.
// Now we can use our TPtrC later to create a TVirtualPath object from a URI 
TVirtualPathPtr aPtr = aURI; 

// print the file URI "C:\file.dcf" 
printf(aPtr.URI()); 
                         
// print the content object's UniqueId "OBJECT1" 
printf(aPtr.UniqueId()); 

// Create a copy of the virtual path on the heap so we don't have any ownership problems 
CVirtualPath *myVirtualpath =  CVirtualPath::NewL(aPtr) 

// Can now delete the CContent object without losing our VirtualPath
CleanupStack::PopAndDestroy(c);</pre>
 </div>

<div class="section"><h2 class="sectiontitle">Special cases for the UniqueId field</h2> <p><strong>KNullDesC16()
- "" </strong> </p>
 <p>A zero length <samp class="codeph">UniqueId</samp> is used to refer
to the entire file. If a file is opened this way, no translation of the contents
is performed. The ability to open the file with no translation is required
for example to attach the file to an outgoing message. As with any other function
in CAF, access to the file is at the agent's discretion. </p>
 <p><strong>KDefaultContentObject()
- "DEFAULT" </strong> </p>
 <p>Allows an application to refer to the default content
object within a file. In the case of an unprotected file handled by the <samp class="codeph">F32Agent</samp>,
it is the entire file, the same as if the <samp class="codeph">UniqueId</samp>  <samp class="codeph">""</samp> was
used. Other agents, particularly those with a single content object embedded
within the file, use <samp class="codeph">"DEFAULT"</samp> to refer to their only content
object. </p>
 <p>Even though the <samp class="codeph">DEFAULT</samp> content object is
supported, it is recommended that agents always use <samp class="codeph">CContent</samp> to
enumerate the objects within the file. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-E6762A98-36A4-5860-B3F9-2AEBBCEAAB2A.html">Content Access Framework Concepts</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>