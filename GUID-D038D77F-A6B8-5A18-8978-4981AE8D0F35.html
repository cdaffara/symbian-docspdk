<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Using the Encoded H264 Video Frames to Capture Video"/>
<meta name="abstract" content="This topic describes how to use the encoded H264 video frames in the Ecam video capture function to capture the video data."/>
<meta name="description" content="This topic describes how to use the encoded H264 video frames in the Ecam video capture function to capture the video data."/>
<meta name="DC.Relation" scheme="URI" content="GUID-55A1A47A-A7DD-5B1A-88E1-4818CB65B782.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3E341F9F-2635-589B-A59A-B999FE7DF9BE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-98499337-5CB4-5A9C-907A-95FF57775983.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-BDB622BF-1CFA-5F1C-81FB-5579C8599689.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-55A1A47A-A7DD-5B1A-88E1-4818CB65B782.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-FAB548CF-24EB-52D1-A7A1-9446BA67C7A5.html"/>
<meta name="DC.Relation" scheme="URI" content="Chunk1339282415.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Using the Encoded H264 Video Frames to Capture Video</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2405098 id2405245 id2405260 id2405298 id2405312 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html">Multimedia Guide</a> &gt; <a href="GUID-3E341F9F-2635-589B-A59A-B999FE7DF9BE.html">Multimedia APIs and Frameworks Collection</a> &gt; <a href="GUID-98499337-5CB4-5A9C-907A-95FF57775983.html">Camera Framework</a> &gt; <a href="GUID-BDB622BF-1CFA-5F1C-81FB-5579C8599689.html">Camera Library</a> &gt; <a href="GUID-55A1A47A-A7DD-5B1A-88E1-4818CB65B782.html" title="The tutorials in this section show you how to use the Camera API.">Tutorials</a> &gt; </div>
<h1 class="topictitle1"> Using
the Encoded H264 Video Frames to Capture Video</h1>
<div><p>This topic describes how to use the encoded H264 video frames in
the Ecam video capture function to capture the video data. </p>

<div class="p" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-E8812B46-29C5-56D8-9658-B0B03D601B2C"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-E8812B46-29C5-56D8-9658-B0B03D601B2C"><!-- --></a><p>You need to be familiar
with the <a href="Chunk234347991.html">Capturing
a Video Clip</a> tutorial. </p>
 </div>

<div class="section" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-3B0CFDEE-297B-56D0-A73A-B45C2E8C550C"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-3B0CFDEE-297B-56D0-A73A-B45C2E8C550C"><!-- --></a><p>The H264 video
encoder provides a new, high quality video data encoding format for Ecam.
Ecam allows the device to capture video frames which are encoded in the H264
format. The Ecam video capture function supports the H264 video capture format
by default. You can select the H264 video capture format when preparing video
capture. </p>
 </div>

<a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-459D27D6-C0F7-5B94-8E34-C250AF3B6B77"><!-- --></a><ol id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-459D27D6-C0F7-5B94-8E34-C250AF3B6B77"><li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-4A02BBE6-CDAE-5FD1-8F05-30867627197B"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-4A02BBE6-CDAE-5FD1-8F05-30867627197B"><!-- --></a><span/><br/>
 Call the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-657990CF-32FF-34A0-9D82-FAC1E7913494"><span class="apiname">CCamera::CCameraVideoCaptureControl::NewL(CCamera
&amp;,MCaptureVideoObserver &amp;)</span></a> function to create an object
that maps the exported call to an internal object of the <a href="GUID-11495CEA-9F67-3B9A-A35C-E7555ED28316.html"><span class="apiname">MCameraVideoCaptureControl</span></a> function. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-480FA9CE-DC0A-5586-A4C2-A2DEB1D7BCEE"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-480FA9CE-DC0A-5586-A4C2-A2DEB1D7BCEE"><!-- --></a><span/><br/>
 Pass a handle to the <a href="GUID-11495CEA-9F67-3B9A-A35C-E7555ED28316.html"><span class="apiname">MCameraVideoCaptureControl</span></a> function.
This implementation creates a handle to the <a href="GUID-021C509B-C821-3401-B2F4-DE7F52BB16D4.html#GUID-021C509B-C821-3401-B2F4-DE7F52BB16D4__GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460"><span class="apiname">CCamera::CCameraVideoCaptureControl</span></a> object
by the active <a href="GUID-021C509B-C821-3401-B2F4-DE7F52BB16D4.html"><span class="apiname">CCamera</span></a> during the construction phase. 
 The <samp class="codeph">CCameraVideoCaptureControl</samp> object makes an internal
call to the <a href="GUID-021C509B-C821-3401-B2F4-DE7F52BB16D4.html#GUID-021C509B-C821-3401-B2F4-DE7F52BB16D4__GUID-2F2F5EB8-1009-306D-A7C4-25BE5A39AA39"><span class="apiname">CCamera::CustomInterface(TUid)</span></a> function of
the active <samp class="codeph">CCamera</samp> implementation. The <samp class="codeph">CustomInterface()</samp> function
passes a UID <samp class="codeph">KECamMCameraVideoCaptureControlUid</samp> value for
the <samp class="codeph">CCamera</samp> implementation. 
 The <samp class="codeph">CCamera</samp> implementation creates the concrete implementation
of the <samp class="codeph">MCameraVideoCaptureControl</samp> function and passes back
a handle to the <samp class="codeph">CCameraVideoCaptureControl</samp> object. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-1F00FA5C-498E-505F-8A2B-B1DB2E5528C4"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-1F00FA5C-498E-505F-8A2B-B1DB2E5528C4"><!-- --></a><span/><br/>
 Call the <a href="GUID-7FAEB878-52B1-3A54-9607-69AE09AB8AEB.html"><span class="apiname">MCaptureVideoObserver</span></a> function to notify
when the video capture operations are ready. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-02A5B55C-7BF4-5740-9AA6-DE93C764F572"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-02A5B55C-7BF4-5740-9AA6-DE93C764F572"><!-- --></a><span/><br/>
 Call <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-4876C362-8BA1-3E91-9A3A-203FCC6F70DB"><span class="apiname">CCamera::CCameraVideoCaptureControl::GetVideoCaptureSupportInfoL(TInt
&amp;)const</span></a> to identify which video capture modes are supported
by the <samp class="codeph">CCamera</samp> implementation. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-4618EA07-9B5A-509C-8196-4C545A2CA014"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-4618EA07-9B5A-509C-8196-4C545A2CA014"><!-- --></a><span/><br/>
 Call the <a href="GUID-1D8E709A-35E2-3CBE-A222-F8BA17A294DA.html#GUID-1D8E709A-35E2-3CBE-A222-F8BA17A294DA__GUID-9069A4C8-CBEE-351B-8512-F5858F6387CD"><span class="apiname">CCamera::CCameraVideoCaptureControl::TPrepareVideoParameters::SetVideoCaptureType(CCamera::CCameraVideoCaptureControl::TVideoCaptureType)</span></a> function to set the desired video capture mode as the <samp class="codeph">EClientVideoCapture</samp> or <samp class="codeph">EDirectVideoCapture</samp> mode. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-F2EE097C-A418-51EB-9870-3E0C665B5D9D"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-F2EE097C-A418-51EB-9870-3E0C665B5D9D"><!-- --></a><span/><br/>
 Set the value of <a href="GUID-007358AE-9795-33EB-A3BE-4788D309135D.html#GUID-007358AE-9795-33EB-A3BE-4788D309135D__GUID-B533837C-5670-3115-9DAC-3C45B0A274E4"><span class="apiname">CCamera::CCameraVideoCaptureControl::TPrepareVideoParameters::iFormat</span></a> to
the <samp class="codeph">EFormatEncodedH264</samp> value for the <samp class="codeph">CCamera</samp> implementation.
This <samp class="codeph">CCamera</samp> implementation supports the H264 video encoding
data format. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-84015E19-B259-59DD-B178-7B04EBAC7514"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-84015E19-B259-59DD-B178-7B04EBAC7514"><!-- --></a><span/><br/>
 Prepare video capture by using the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-91EA4417-6AF2-391E-BBB2-A6E202F835BB"><span class="apiname">CCamera::CCameraVideoCaptureControl::PrepareVideoCapture(const
TPrepareVideoParameters &amp;)</span></a> asynchronous function. The <samp class="codeph">PrepareVideoCapture()</samp> function
performs setup and allocation of memory before calling the <samp class="codeph">StartVideoCapture()</samp> function,
in order to keep minimum latency of the <samp class="codeph">PrepareVideoCapture()</samp> function. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-BEE6A815-D252-5958-A7CA-CD481FB30A9C"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-BEE6A815-D252-5958-A7CA-CD481FB30A9C"><!-- --></a><span/><br/>
 Notify the Ecam client to complete the video capture preparation using
the <a href="GUID-203BEBE6-F7B8-30EA-824B-AA45B88304E1.html"><span class="apiname">KUidECamEventVideoCaptureControlPrepareComplete</span></a> event. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-629707E2-1139-5A1D-A366-4442440A77F2"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-629707E2-1139-5A1D-A366-4442440A77F2"><!-- --></a><span/><br/>
 Call the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-774897D4-271E-3D7D-AAA6-033D34A39D74"><span class="apiname">CCamera::CCameraVideoCaptureControl::StartVideoCaptureL()</span></a> function
to start video capture. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-0AC88670-8F5A-53D6-88C8-4D3C741D7114"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-0AC88670-8F5A-53D6-88C8-4D3C741D7114"><!-- --></a><span/><br/>
 Call the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-5EB82FE6-4025-3F78-9DAD-6851086A46C6"><span class="apiname">CCamera::CCameraVideoCaptureControl::PauseVideoCapture()</span></a> function
to pause the on-going video capture. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-072B351C-23E9-5BCD-8E25-371B24B6708F"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-072B351C-23E9-5BCD-8E25-371B24B6708F"><!-- --></a><span/><br/>
 Call the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-AAECC4A5-742A-3B17-9FBE-8051EF891476"><span class="apiname">CCamera::CCameraVideoCaptureControl::GetPrepareVideoParametersL(TPrepareVideoParameters
&amp;)const</span></a> function to retrieve the current prepare video parameters.
The current video capture type is retrieved by the <a href="GUID-007358AE-9795-33EB-A3BE-4788D309135D.html#GUID-007358AE-9795-33EB-A3BE-4788D309135D__GUID-ED307366-65E3-3557-9479-463A595D34BC"><span class="apiname">CCamera::CCameraVideoCaptureControl::TPrepareVideoParameters::VideoCaptureType()const</span></a> function. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-DFED1955-7B01-549E-8966-69E972DAACD2"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-DFED1955-7B01-549E-8966-69E972DAACD2"><!-- --></a><span/><br/>
 Call the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-D9BECEAD-8695-3B8B-A537-9F7B96EF1A2A"><span class="apiname">CCamera::CCameraVideoCaptureControl::ResumeVideoCaptureL()</span></a> function
to resume the on-going video capture. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-4A7B8939-36FF-5484-9450-7914DA5E52E7"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-4A7B8939-36FF-5484-9450-7914DA5E52E7"><!-- --></a><span/><br/>
 Call the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-017E7D68-9971-3966-B863-95471AC8636F"><span class="apiname">CCamera::CCameraVideoCaptureControl::StopVideoCapture()</span></a> function
to stop video capture. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-799FED22-0DBA-5625-BF8E-20B2FEF87D99"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-799FED22-0DBA-5625-BF8E-20B2FEF87D99"><!-- --></a><span/><br/>
 Call the <a href="GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460.html#GUID-D74635DE-C5D8-3A9A-ABDD-8324D8EFF460__GUID-3234F65D-A8FC-334E-B1A5-4382862B071C"><span class="apiname">CCamera::CCameraVideoCaptureControl::ReleaseVideoResource()()</span></a> function
to release the video resource, which is allocated while performing the <samp class="codeph">PrepareVideoCapture()</samp> function. 
</li>
<li class="stepexpand" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-941398B5-722A-57CA-95FF-220E3C6DECE6"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-941398B5-722A-57CA-95FF-220E3C6DECE6"><!-- --></a><span/><br/>
 If an error occurs while performing video capture, call the <a href="GUID-7FAEB878-52B1-3A54-9607-69AE09AB8AEB.html#GUID-7FAEB878-52B1-3A54-9607-69AE09AB8AEB__GUID-5B505097-BA38-3CF9-86D8-EA62EC2CFBB4"><span class="apiname">MCaptureVideoObserver::DirectVideoCaptureFailed(TInt)</span></a> function. Any video capture operation is stopped. 
</li>
</ol>

<div class="example"><h2 class="sectiontitle">Example</h2> <p>The following example code snippet illustrates
video capture using H264 encoding: </p>
 <pre class="codeblock" id="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-20E7DB2D-56B3-5E64-8B8F-C91188BB93D7"><a name="GUID-D038D77F-A6B8-5A18-8978-4981AE8D0F35__GUID-20E7DB2D-56B3-5E64-8B8F-C91188BB93D7"><!-- --></a>

CCamera* camera = NULL;
MCameraObserver2* observer2 = NULL;

CCamera::CCameraVideoCaptureControl* videocapture = NULL;
MCaptureVideoObserver* videoObserver = NULL;

camera = CCamera::New2L(*observer2, 0, 0);

videocapture  = CCamera::CCameraVideoCaptureControl::NewL(*camera, *videoObserver);

CCamera::CCameraVideoCaptureControl::TPrepareVideoParameters prepareVideoParameters;

TInt supportedDVCType = -1;

// To retrieve the supported video capture mode
videocapture-&gt;GetVideoCaptureSupportInfoL(supportedDVCType); 
 
// To set the video capture mode, if supported by the CCamera implementation
prepareVideoParameters.SetVideoCaptureType(CCamera::CCameraVideoCaptureControl::EDirectVideoCapture);  

// To set encoding for the H264 video data format
prepareVideoParameters.iFormat = CCamera::EFormatEncodedH264; 

// To set aspect ratio for the chosen H264 video format 
prepareVideoParameters.iPixelAspectRatio = CCamera::CCameraAdvancedSettings::EEPixelAspect40To33;  

videocapture-&gt;PrepareVideoCapture(prepareVideoParameters);

videocapture-&gt;StartVideoCaptureL();

videocapture-&gt;StopVideoCapture();
    
CCamera::CCameraVideoCaptureControl::TPrepareVideoParameters retrievedVideoParam;
videocapture-&gt;GetPrepareVideoParametersL(retrievedVideoParam);

CCamera::CCameraVideoCaptureControl::TVideoCaptureType retrievedVideoCaptureType;
retrievedVideoCaptureType = retrievedVideoParam.VideoCaptureType();


</pre>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-55A1A47A-A7DD-5B1A-88E1-4818CB65B782.html" title="The tutorials in this section show you how to use the Camera API.">Tutorials</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="Chunk1339282415.html">Capturing
Still Images</a></div>
</div>
<div class="relinfo"><strong>Related information</strong><br/>
<div><a href="GUID-FAB548CF-24EB-52D1-A7A1-9446BA67C7A5.html">Camera Preset
Support</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>