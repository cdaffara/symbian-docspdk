<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="RSubConnection API Tutorial"/>
<meta name="abstract" content="How to use an RSubConnection."/>
<meta name="description" content="How to use an RSubConnection."/>
<meta name="DC.Relation" scheme="URI" content="GUID-550ED2C7-C2F1-5D48-AC5A-C652EB51FCA8.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B144EAB9-53AB-579B-9E12-B16518E4FC01.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B5E17404-4D2D-5EE3-B30B-DFDC5E0739FF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-9A20701F-5744-5F5F-BB0C-AB58EFB7D087.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-550ED2C7-C2F1-5D48-AC5A-C652EB51FCA8.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-D043376C-29D2-5196-96F4-15E99CFB5639"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>RSubConnection API Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2398162 id2398193 id2398259 id2398297 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-B144EAB9-53AB-579B-9E12-B16518E4FC01.html" title="Networking Services provides a standard framework for accessing network services and actual implementations of network protocols. The components of the Networking Services are closely related to the framework provided by the Communications Framework module.">Networking Services Guide</a> &gt; <a href="GUID-B5E17404-4D2D-5EE3-B30B-DFDC5E0739FF.html" title="This collection contains plugins which implement the Control plane part of a Network Layer protocol. These include the Connection Provider and Sub-connection Providers for the Quality of Service protocol and the Internet Protocol.">Network Control</a> &gt; <a href="GUID-9A20701F-5744-5F5F-BB0C-AB58EFB7D087.html" title="This document provides an introduction to the concepts and tutorials of the Quality of Service (QoS).">Quality of Service</a> &gt; <a href="GUID-550ED2C7-C2F1-5D48-AC5A-C652EB51FCA8.html" title="This topic lists the tutorials of the QoS.">Tutorials</a> &gt; </div>
<h1 class="topictitle1"> RSubConnection
API Tutorial</h1>
<div><p>How to use an <samp class="codeph">RSubConnection</samp>. </p>

<div class="section" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-254081A7-16C0-45C5-B964-4B47D6EB4590"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-254081A7-16C0-45C5-B964-4B47D6EB4590"><!-- --></a><h2 class="sectiontitle">Procedure</h2> <a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-C81387B5-9ED3-59ED-A5DC-C6FE807B2E1C"><!-- --></a><ol id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-C81387B5-9ED3-59ED-A5DC-C6FE807B2E1C">
<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-46077726-D57D-5A89-A022-D1EDD45FFE3C"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-46077726-D57D-5A89-A022-D1EDD45FFE3C"><!-- --></a><p>Use the <samp class="codeph">Open()</samp> method
to open an <a href="GUID-0AFDA357-EE44-3788-9CAB-162B874134BF.html"><span class="apiname">RSubConnection</span></a> object on an ESOCK session. </p>
 <p>The <a href="GUID-BED8A733-2ED7-31AD-A911-C1F4707C67FD.html"><span class="apiname">RConnection</span></a> must
already be active. A sub-connection type is passed as a parameter to this
method. It is then attached to the default sub-connection that is the <a href="GUID-BED8A733-2ED7-31AD-A911-C1F4707C67FD.html"><span class="apiname">RConnection</span></a>,
or creates a sub-connection. When an application calls the <a href="GUID-0AFDA357-EE44-3788-9CAB-162B874134BF.html"><span class="apiname">RSubConnection</span></a> API,
a system wide error code is returned. When it is successful, it returns <samp class="codeph">KErrNone</samp>. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-32926A01-B170-5413-8FAC-0022F80EE1D1"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-32926A01-B170-5413-8FAC-0022F80EE1D1"><!-- --></a><p>Use the <samp class="codeph">Add()</samp> method
to move the socket from the default sub-connection to the <a href="GUID-0AFDA357-EE44-3788-9CAB-162B874134BF.html"><span class="apiname">RSubConnection</span></a>. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-BD4E28EF-3DAA-5DC5-8F68-2889C4B826B9"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-BD4E28EF-3DAA-5DC5-8F68-2889C4B826B9"><!-- --></a><p>The <samp class="codeph">Remove()</samp> method
returns the socket to the default sub-connection. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-49044666-971D-59E6-8FBB-3AD1410726B7"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-49044666-971D-59E6-8FBB-3AD1410726B7"><!-- --></a><p>Use the <samp class="codeph">GetParameters()</samp> and <samp class="codeph">SetParameters()</samp> methods
are to retrieve and set bundles of properties on the sub-connection. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-FC5ABE8D-AA9C-502B-8E9F-BC8F2ECB2D1F"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-FC5ABE8D-AA9C-502B-8E9F-BC8F2ECB2D1F"><!-- --></a><p>The <samp class="codeph">GetParameters()</samp> returns <samp class="codeph">KErrNotReady</samp> if
properties are not negotiated. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-1B1C7EE8-2B94-5BC9-9797-9D560C5F8E39"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-1B1C7EE8-2B94-5BC9-9797-9D560C5F8E39"><!-- --></a><p>The <samp class="codeph">SetParameters()</samp> method,
like the <samp class="codeph">Add()</samp> and <samp class="codeph">Remove()</samp> methods returns
an error code indicating the success or failure of the request to perform
the action. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-CB745754-DF5D-5392-BA7C-79CB5DA2F708"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-CB745754-DF5D-5392-BA7C-79CB5DA2F708"><!-- --></a><p>When the properties
are negotiated either the <samp class="codeph">CSubConGenEventParamsGranted</samp> or <samp class="codeph">CSubConGenEventParamsRejected</samp> event
is notified for each family within the parameter bundle. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-4D290B37-0C6D-5794-A8C7-3CCDF872FCA8"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-4D290B37-0C6D-5794-A8C7-3CCDF872FCA8"><!-- --></a><p>Use the <samp class="codeph">EventNotification()</samp> methods
to asynchronously register for event notifications. </p>
 <p>The methods support
filtering of events in two different ways, through a Boolean flag to receive
notification of generic or all events, and through an array of <samp class="codeph">TEventFilter</samp>. </p>
 </li>

<li id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-9728A1AA-E0AC-589D-A251-B46CB369F90E"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-9728A1AA-E0AC-589D-A251-B46CB369F90E"><!-- --></a><p>Use <a href="GUID-B25D68E9-BAD2-358F-9FB0-956E3A2AEDCE.html"><span class="apiname">CancelEventNotification()</span></a> method
cancel the registration for event notifications. </p>
 </li>

</ol>
 </div>

<div class="example"><h2 class="sectiontitle">Connecting to the default SubConnection example</h2> <p>In
the following example, the application connects to the default sub-connection
to set the properties. When it has set properties on the default sub-connection,
the application tries to connect a socket over the default sub-connection. </p>
 <pre class="codeblock" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-A30FEC87-9D24-5BEF-A47C-85721B73DB70"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-A30FEC87-9D24-5BEF-A47C-85721B73DB70"><!-- --></a>RSocketServ ss;
RConnection conn;
RSubConnection subconn;
RSocket sock;
TRequestStatus status;

// Connect to ESOCK
ss.Connect();

// Open a Connection
conn.Open(ss, KAfInet);

// Start the connection
conn.Start(status);
User::WaitForRequest(status);

// Attach to the default sub-connection
subconn.Open(ss, RSubConnection::EAttachToDefault, conn);

// Set Properties of the default sub-connection
subconn.SetParameters(…);

// Open a TCP socket on the connection (this is the same as using the default sub-connection)
sock.Open(ss, KAfInet, KSockStream, KProtocolInetTcp, conn);

_LIT(KRasAddr,"10.159.24.13");
const TInt KEchoPort = 7;

TInetAddr destAddr;
destAddr.Input(KRasAddr);
destAddr.SetPort(KEchoPort);

// Request the Socket to connect to the destination over the default sub-connection
sock.Connect(destAddr, status);
</pre>
 </div>

<div class="section" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-D707232A-A1B5-4F8F-98D4-D6EBC253DF94"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-D707232A-A1B5-4F8F-98D4-D6EBC253DF94"><!-- --></a><h2 class="sectiontitle">Creating a
sub-connection - Socket connected over the           SubConnection example</h2> <p>The
following example shows how an application can use a sub-connection through
an <a href="GUID-0AFDA357-EE44-3788-9CAB-162B874134BF.html"><span class="apiname">RSubConnection</span></a> instance. It attaches an <samp class="codeph">RSocket</samp> to
the sub-connection. </p>
 <pre class="codeblock" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-F7E8A10E-4A1C-5547-A2F5-783D0A914EA3"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-F7E8A10E-4A1C-5547-A2F5-783D0A914EA3"><!-- --></a>RSocketServ ss;
RConnection conn;
RSubConnection subconn;
RSocket sock;
TRequestStatus status;

// Connect to ESOCK
ss.Connect();

// Open an Connection
conn.Open(ss, KAfInet);

// Start the connection
conn.Start(status);
User::WaitForRequest(status);

// Create a new sub-connection
subconn.Open(ss, RSubConnection::ECreateNew, conn);

// Set Properties of the sub-connection
subconn.SetParameters(…);

// Open a TCP socket on the sub-connection
sock.Open(ss, KAfInet, KSockStream, KProtocolInetTcp, subconn);

_LIT(KRasAddr,"10.159.24.13");
const TInt KEchoPort = 7;

TInetAddr destAddr;
destAddr.Input(KRasAddr);
destAddr.SetPort(KEchoPort);

// Request the Socket to connect to the destination over the sub-connection
sock.Connect(destAddr, status);
</pre>
 </div>

<div class="section" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-0766B25A-8073-47E7-A86E-4D172D050064"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-0766B25A-8073-47E7-A86E-4D172D050064"><!-- --></a><h2 class="sectiontitle">Creating a
new sub-connection - Adding an already connected           socket example</h2> <p>The
following example shows how an application can use a sub-connection through
an <a href="GUID-0AFDA357-EE44-3788-9CAB-162B874134BF.html"><span class="apiname">RSubConnection</span></a> instance. It attaches a connected <samp class="codeph">RSocket</samp> to
the sub-connection. </p>
 <pre class="codeblock" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-27ACF33C-004D-5538-AF34-175F66D73C6B"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-27ACF33C-004D-5538-AF34-175F66D73C6B"><!-- --></a>RSocketServ ss;
RConnection conn;
RSubConnection subconn;
RSocket sock;
TRequestStatus status;

// Connect to ESOCK
ss.Connect();

// Open a Connection
conn.Open(ss, KAfInet);

// Start the connection
conn.Start(status);
User::WaitForRequest(status);

// Open a TCP socket on the connection
sock.Open(ss, KAfInet, KSockStream, KProtocolInetTcp, conn);

_LIT(KRasAddr,"10.159.24.13");
const TInt KEchoPort = 7;

TInetAddr destAddr;
destAddr.Input(KRasAddr);
destAddr.SetPort(KEchoPort);

// Connect the Socket to the destination over the connection (default sub-connection)
sock.Connect(destAddr, status);

// Create a new sub-connection
subconn.Open(ss, RSubConnection::ECreateNew, conn);

// Set Properties of the sub-connection
subconn.SetParameters(…);

// Move the connected socket onto the new sub-connection
TRequestStatus status;
subconn.Add(sock, status);

// Wait for socket to added
User::WaitForRequest(status);
</pre>
 </div>

<div class="section" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-BC00A713-123E-401D-9E99-BE52C920D71B"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-BC00A713-123E-401D-9E99-BE52C920D71B"><!-- --></a><h2 class="sectiontitle">Creating and
setting properties for a SubConnection           example</h2> <p>The following
example shows how an application creates and sets the QoS properties. It assigns
the properties to a sub-connection. </p>
 <pre class="codeblock" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-6A478B1D-3A6E-5FB1-BD5E-2485A86539C1"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-6A478B1D-3A6E-5FB1-BD5E-2485A86539C1"><!-- --></a>// Create the container for all sub connection parameters
RSubConParameterBundle subconParams;
CleanupClosePushL(subconParams);

// Create a container for QoS sub connection parameters (Param bundle takes ownership)
CSubConParameterFamily* qosFamily = CSubConParameterFamily::NewL(subconParams,
    KSubConQoSFamily);

// Create the requested generic parameter set for QoS (Qos family takes ownership)
CSubConQosGenericParamSet* reqGenericParams = CSubConQosGenericParamSet::NewL(*qosFamily,                               
    CSubConParameterFamily::ERequested);

// Set the requested Generic Parameters
reqGenericParams-&gt;SetDownlinkBandwidth(128);
reqGenericParams-&gt;SetUplinkBandwidth(64);

// Create the acceptable generic parameter set for QoS (Qos family takes ownership)
CSubConQosGenericParamSet* accGenericParams = CSubConQosGenericParamSet::NewL(*qosFamily,                               
    CSubConParameterFamily::EAcceptable);

// Set the acceptable Generic Parameters
accGenericParams-&gt;SetDownlinkBandwidth(48);
accGenericParams-&gt;SetUplinkBandwidth(32);

// Create a requested technology specific parameter set for QoS (Qos family takes ownership)
CSubConQosR99ParamSet* reqRel99Params = CSubConQosR99ParamSet::NewL(*qosFamily,
    CSubConParameterFamily::ERequested);

// Set the requested Technology Specific Params
reqRel99Params-&gt;SetMaxSDUSize(1024);

// Create a acceptable technology specific parameter set for QoS (Qos family takes ownership)
CSubConQosR99ParamSet* accRel99Params = CSubConQosR99ParamSet::NewL(*qosFamily,
    CSubConParameterFamily::EAcceptable);

// Set the acceptable Technology Specific Params
accRel99Params-&gt;SetMaxSDUSize(512);

// Now open the sub-connection as normal…
………
………
// Create a new sub-connection
subconn.Open(ss, RSubConnection::ECreateNew, conn);

// Set Properties of the sub-connection
subconn.SetParameters(subconParams);

// Destroy parameters
CleanupStack::PopAndDestroy();         // subconParams

// Open a TCP socket on the sub-connection
sock.Open(ss, KAfInet, KSockStream, KProtocolInetTcp, subconn);

_LIT(KRasAddr,"10.159.24.13");
const TInt KEchoPort = 7;

TInetAddr destAddr;
destAddr.Input(KRasAddr);
destAddr.SetPort(KEchoPort);

// Connect the Socket to the destination over the sub-connection
sock.Connect(destAddr, status);
User::WaitForRequest(status);

// Fetch the granted qos
RSubConParameterBundle grantedParams;
subconn.GetParameters(grantedParams);
</pre>
 </div>

<div class="section" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-781F3343-94E7-4BF5-8840-0CDFFB0B99B2"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-781F3343-94E7-4BF5-8840-0CDFFB0B99B2"><!-- --></a><h2 class="sectiontitle">Registering
for events example</h2> <p>The following example shows how an application
can register events that occur on a sub-connection. In this example the application
registers for notification of all events. </p>
 <pre class="codeblock" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-B6B202DB-323A-528F-B6F6-60160A140EA5"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-B6B202DB-323A-528F-B6F6-60160A140EA5"><!-- --></a>// Create the container for all sub connection parameters
RSubConParameterBundle subconParams;
CleanupClosePushL(subconParams);

………
………
// Create and initialise parameters sets as above
………
………

// Create a new sub-connection
subconn.Open(ss, RSubConnection::ECreateNew, conn);

TNotificationEventBuf eventBuffer;
TRequestStatus eventStatus;
subconn.EventNotification(eventBuffer, EFalse, eventStatus);

// Set Properties of the sub-connection
subconn.SetParameters(subconParams);

// Destroy parameters
CleanupStack::PopAndDestroy();         // subconParams

// Open and connect a TCP socket on the sub-connection
sock.Open(ss, KAfInet, KSockStream, KProtocolInetTcp, subconn);
sock.Connect(destAddr, status);
User::WaitForRequest(status);

// Negotiation may not occur until a socket is assigned to the sub-connection
// First event should be cSubConGenEventDataClientJoining
User::WaitForRequest(eventStatus);

// Next we’d expect a CSubconGenEventParamsGranted/ CSubconGenEventParamsRejected
subconn.EventNotification(eventBuffer, EFalse, eventStatus);
User::WaitForRequest(eventStatus);
</pre>
 <p><strong>Registering for events – Using filters</strong> </p>
 <p>The
following example code shows how to register for specific events using filters.
In this example the application registers for notification when sub-connection
parameters are granted or rejected. Each <a href="GUID-FDE12D94-17D3-3646-B645-26A08926F86C.html"><span class="apiname">TEventFilter</span></a> contains
events of the factory UID and mask of event IDs. </p>
 <pre class="codeblock" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-9368C7DA-B870-55C6-A84B-756EE1DF4E33"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-9368C7DA-B870-55C6-A84B-756EE1DF4E33"><!-- --></a>// Create the container for all sub connection parameters
RSubConParameterBundle subconParams;
CleanupClosePushL(subconParams);

………
………
// Create and initialise parameters sets as above
………
………

// Create a new sub-connection
subconn.Open(ss, RSubConnection::ECreateNew, conn);

// Create event filter
TEventFilter filter;
filter.iEventGroupUid = KSubConnGenericEventsImplUid;
filter.iEventMask = KSubConGenericEventParamsRejected | KSubConGenericEventParamsGranted;

// Register for event
TNotificationEventBuf eventBuffer;
TRequestStatus eventStatus;
subconn.EventNotification(eventBuffer, &amp;filter, 1, eventStatus);

// Set Properties of the sub-connection
subconn.SetParameters(subconParams);

// Destroy parameters
CleanupStack::PopAndDestroy();         // subconParams

// Open and connect a TCP socket on the sub-connection
sock.Open(ss, KAfInet, KSockStream, KProtocolInetTcp, subconn);
sock.Connect(destAddr, status);
User::WaitForRequest(status);

// Event should be CSubconGenEventParamsGranted/CSubconGenEventParamsRejected
User::WaitForRequest(eventStatus);
</pre>
 </div>

<div class="section" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-6FDFB388-B265-4A7B-9752-AC75DF6C3995"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-6FDFB388-B265-4A7B-9752-AC75DF6C3995"><!-- --></a><h2 class="sectiontitle">Extracting
information from received events example</h2> <p>The following example
code shows how to extract the information contained within an event notification
when it is received. </p>
 <pre class="codeblock" id="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-BCCE128C-0042-5E36-B22C-35A22A6DFE85"><a name="GUID-D043376C-29D2-5196-96F4-15E99CFB5639__GUID-BCCE128C-0042-5E36-B22C-35A22A6DFE85"><!-- --></a>// Create the container for all sub connection parameters
RSubConParameterBundle subconParams;
CleanupClosePushL(subconParams);

………
………
// Create and initialise parameters sets as above
………
………

// Create a new sub-connection
subconn.Open(ss, RSubConnection::ECreateNew, conn);

// Create filter, register for events, and set parameters as above
……
subconn.EventNotification(eventBuffer, &amp;filter, 1, eventStatus);
……

// Open and connect a TCP socket on the sub-connection
……

// Receive the event notification
User::WaitForRequest(eventStatus);

CSubConNotificationEvent* event;
event = CSubConNotificationEvent::NewL(eventBuffer);
CleanupStack::PushL (event);

if (event-&gt;GroupId() == KSubConnGenericEventsImplUid
    &amp;&amp; event-&gt;Id() == CSubConGenEventParamsRejected)
    {
    CSubConGenEventParamsRejected* rejectedEvent =
        static_cast&lt; CSubConGenEventParamsRejected*&gt;(event);

    TInt error = rejectedEvent-&gt;Error();
    ……
    // Do something with the error
    ……
    }

CleanupStack::PopAndDestroy (event);
</pre>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-550ED2C7-C2F1-5D48-AC5A-C652EB51FCA8.html" title="This topic lists the tutorials of the QoS.">Tutorials</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>