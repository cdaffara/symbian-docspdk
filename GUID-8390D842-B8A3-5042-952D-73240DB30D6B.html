<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Message Server and Store Overview"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B394A824-8745-505E-8429-8B9B6D418387.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B394A824-8745-505E-8429-8B9B6D418387.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-54AB166A-8B24-5065-92AD-5FC1BF3ED89C.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-44CF5471-564E-5790-935B-51193A4978D6.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-8390D842-B8A3-5042-952D-73240DB30D6B"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Message Server and Store Overview</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2404348 id2404397 id2404434 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-5DD1010C-1648-5086-BA80-BC25F3C7A2C4.html">Messaging Middleware Guide</a> &gt; <a href="GUID-C290FA5E-8E41-5D19-B8C1-F88491EE6388.html">Messaging Framework</a> &gt; <a href="GUID-B394A824-8745-505E-8429-8B9B6D418387.html">Message Server and Store</a> &gt; </div>
<h1 class="topictitle1">Message
Server and Store Overview</h1>
<div>
<p>This section provides an overview of the functionality and the architecture
of Message Server and Store. </p>

<div class="section"><h2 class="sectiontitle">Purpose</h2> <p>The following services that are provided
by this component can be used by the client application: </p>
 <ul>
<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-67C56ED5-6996-585F-A6EB-DB64E3956DF8"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-67C56ED5-6996-585F-A6EB-DB64E3956DF8"><!-- --></a><p><a href="GUID-5CFA3F21-3E42-5B53-8EC1-BC0F7F0E8136.html">Storing
Messages</a>  </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-452071CE-E72F-5BE7-AF45-E4EA1C085E18"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-452071CE-E72F-5BE7-AF45-E4EA1C085E18"><!-- --></a><p><a href="GUID-4CD6C5CC-A91B-56BE-825F-5B10B63627DA.html"> Handling
Client Requests</a>  </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-F4732AD3-EB59-52E5-B3EF-E8C1D8B527E2"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-F4732AD3-EB59-52E5-B3EF-E8C1D8B527E2"><!-- --></a><p><a href="GUID-2FAB8281-569A-52BE-8BC8-A2D378068706.html">Caching</a> </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-89ED7AA5-5DBB-5D7D-AE80-739813964183"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-89ED7AA5-5DBB-5D7D-AE80-739813964183"><!-- --></a><p><a href="GUID-32C1FC8B-F7D2-5275-BDF2-0D662551294C.html"> Searching
and Sorting Messages</a>  </p>
 </li>

</ul>
 </div>

<div class="section"><h2 class="sectiontitle">Architecture</h2> <p>Message type-dependent operations,
such as address handling, are called by client applications using client MTMs
and UI MTMs. These MTMs then access the appropriate Message Store and alter
it as required. </p>
 <p>The following figure shows the logical structure of
the Message Server. Dashed boxes indicate components that can be developed
by third-parties. </p>
 <div class="fignone" id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-F469ED0A-E43F-5260-B86E-3EFE3CBA0DBB"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-F469ED0A-E43F-5260-B86E-3EFE3CBA0DBB"><!-- --></a><span class="figcap">Figure 1.               Logical structure of Messaging Middleware architecture
           </span>

<img src="GUID-0259868F-8F88-5D9D-A9DE-9309C3BFBA85_d0e482466_href.png"/>
</div>
<div class="note"><span class="notetitle">Note:</span>  No lower-level communication components are shown, as the architecture
is designed to be independent of any particular communication protocol. Instead,
communication libraries are accessed as needed by Server MTMs. For example,
an SMTP MTM would use TCP/IP, while the SMS MTM would use the Telephony Server
(ETel).</div>
 <dl>

<dt class="dlterm">Application/App UI</dt>

<dd><p>This represents a message client application. </p>
 </dd>



<dt class="dlterm">User Interface MTM, Client-side MTM, UI Data MTM, Server-side MTM Bases</dt>

<dd><p>These are base classes required for implementing protocol-specific
MTM components. User Interface and UI Data MTMs handle user interface functionality
and resources. Client-side MTMs provide message data handling functions. Server-side
MTMs provide message transport functions. </p>
 </dd>



<dt class="dlterm">Concrete User Interface MTM, Concrete Client-side MTM, Concrete UI Data
MTM, Concrete Server-side MTM</dt>

<dd><p>These represent instances of MTM components written to implement a
particular messaging protocol. </p>
 </dd>



<dt class="dlterm">Message Server</dt>

<dd><p>The Message Server handles all requests to access or manipulate message
data. Where necessary, it passes requests to the protocol-specific message
transport components, the Server-side MTMs. </p>
 </dd>



<dt class="dlterm">Session</dt>

<dd><p>Sessions allow client-side components to issue requests to the Message
Server. There are a number of classes provided to clients that allow message
entries to be manipulated. </p>
 </dd>


</dl>
 <p>The <span class="filepath">msgs.dll</span> library provides a client-side
session class called <a href="GUID-2DA04D96-F0AD-3FDC-9E36-1C27D889AF4B.html"><span class="apiname">CMsvSession</span></a> . Client applications
typically create an instance of this class on start-up. Instances of Client
MTMs, User Interface (UI) MTMs and high-level client library classes maintain
a reference to the client application’s session object, to make requests if
needed. </p>
 <p>Message client applications, Client MTMs and UI MTMs manipulate
entries through <a href="GUID-5A23B804-2C06-3407-9D48-1BFB212D699F.html"><span class="apiname">TMsvEntry</span></a> and <a href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><span class="apiname">CMsvEntry</span></a> classes.
The entry currently being operated on is called the context. A client application
can begin by setting the context to the root entry. By finding the children
of this initial entry, and then their children in turn, any entry can be found. </p>
 <p>Operations
such as creating, deleting, sorting and accessing body text, or changing an
index entry, which are independent of the message-type, are requested by client
applications and MTMs through <a href="GUID-BC3D2A73-3E8C-3D0C-8E18-5E35AA431D99.html"><span class="apiname">CMvsEntry</span></a> or <a href="GUID-681B56F3-B3A2-3147-B25A-FD69451F4A1D.html"><span class="apiname">CMsvServerEntry</span></a>.
The Message Server may either perform such operations itself or delegate them
to a server MTM. </p>
 </div>

<div class="section"><h2 class="sectiontitle">Description</h2> <p>The Message Server is the core component
in the Messaging Middleware module. It accepts asynchronous requests from
clients through a kernel-maintained session. It performs the following functions: </p>
 <ul>
<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-55C60AD4-DCFD-5C31-AA33-1D081FFE2A47"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-55C60AD4-DCFD-5C31-AA33-1D081FFE2A47"><!-- --></a><p> <strong>Controls access
to message data</strong>  </p>
 <p>In response to client requests, the Message Server
delegates temporary, exclusive access to message data, so that more than one
client cannot edit the same message at the same time. It is the responsibility
of Message Server to keep the message data in workable order, and cope with
events such as failure recovery. </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-BA07A6D4-194D-5908-9139-1A86F0D0C9E3"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-BA07A6D4-194D-5908-9139-1A86F0D0C9E3"><!-- --></a><p> <strong>Delegates requests
to Server MTMs</strong>  </p>
 <p>Message Server must identify requests, such as
sending a message that requires protocol-specific functionality, and load
the appropriate Server MTM. </p>
 </li>

</ul>
 <p id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-8E01ADD0-A706-54B2-8159-E65C33274C30"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-8E01ADD0-A706-54B2-8159-E65C33274C30"><!-- --></a><strong>Message Store</strong> </p>
 <p>Message
Server provides persistent storage of messages and messaging account settings
by providing a Message Store. The Message Store contains message data in a
variable number of entries in a tree view, each of which is referenced by
a unique identifier. This concept is known as a <a href="GUID-D099551B-6E99-5210-B44A-693012A29DD1.html">dictionary
file store</a>. Each entry in the tree can represent an email account,
folder of messages, message part and so on. </p>
 <p>Message Store is secured
in a protected data-caged area of Message Server. Message Server allows multiple
read-only and a single read-write access to a message in the Message Store
at given time. It also accepts copy and delete requests from clients trusted
with <samp class="codeph">WriteUserData</samp> capability. When a copy or delete is requested,
the message server first flags itself as unavailable and then locks the files
before attempting to process them. </p>
 <p>Message settings are stored in
the Central Repository and attachment information is stored in the Message
Store. MTMs can create additional streams in the message store to hold MTM-specific
message data. Usually, at least one stream is devoted to non-generic header
information such as recipient information. </p>
 <p>When Message Server starts,
the Message Store is created unless there is already a Message Store present.
Message Server initially creates the Message Store with just a root entry
and then creates standard folders defined in the <span class="filepath">msgs.rsc</span> resource
file. Finally the Message Server runs <span class="filepath">mailinit.exe</span> to
customise of the Message Store. The behaviour of <span class="filepath">mailinit.exe</span> is
defined by the UI family of the device, such as Series 60 or UIQ. However,
the typical behaviour is to load each of the UI MTMs and allow each to perform
any message type specific initialisation. For example, the SMS plug-in typically
creates a default service entry. </p>
 </div>

<div class="section"><h2 class="sectiontitle">API summary</h2> <p>The storage abstractions through which
client applications access the various types of storage are key to the Messaging
Middleware module. </p>
 <ul>
<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-5F7B2622-1FCB-57AB-B98B-32BED95E4CA5"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-5F7B2622-1FCB-57AB-B98B-32BED95E4CA5"><!-- --></a><p>The <a href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><span class="apiname">CMsvEntry</span></a> API
access and acts on a particular Message Server entry. The main functions of
this API are to provide means to: </p>
 <ul>
<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-A14A770E-2425-59C5-BCEC-A8C209B246CE"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-A14A770E-2425-59C5-BCEC-A8C209B246CE"><!-- --></a><p>access the various types
of storage associated with an entry </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-991A0D61-A67C-5BA0-B943-BFF5D60839B2"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-991A0D61-A67C-5BA0-B943-BFF5D60839B2"><!-- --></a><p>discover and access
other entries that the entry owns (its children) </p>
 </li>

</ul>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-40BDE827-355F-54E5-BFB3-DEF160FC8B4B"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-40BDE827-355F-54E5-BFB3-DEF160FC8B4B"><!-- --></a><p> <a href="GUID-681B56F3-B3A2-3147-B25A-FD69451F4A1D.html"><span class="apiname">CMsvServerEntry</span></a> is
similar to <a href="GUID-85BBE389-81F7-3E2F-A789-446D9BE2CC49.html"><span class="apiname">CMsvEntry</span></a>, but used only by Server MTMs. </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-54D77E17-1B5E-529F-916B-A628DA022901"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-54D77E17-1B5E-529F-916B-A628DA022901"><!-- --></a><p> <a href="GUID-5A23B804-2C06-3407-9D48-1BFB212D699F.html"><span class="apiname">TMsvEntry</span></a> encapsulates
an index entry the Message Server index. </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-DDF9FB6B-02EB-5976-8072-95FCD25FED49"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-DDF9FB6B-02EB-5976-8072-95FCD25FED49"><!-- --></a><p> <a href="GUID-8CB90FA2-A6CF-3FA2-81FF-7D22EFD9C2CE.html"><span class="apiname">CMsvStore</span></a> encapsulates
an entry’s <a href="GUID-8390D842-B8A3-5042-952D-73240DB30D6B.html#GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-8E01ADD0-A706-54B2-8159-E65C33274C30">Message
Store</a>. </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-A17D856C-EE8C-5339-9EE8-108D8AE1229F"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-A17D856C-EE8C-5339-9EE8-108D8AE1229F"><!-- --></a><p> <a href="GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD.html"><span class="apiname">MMsvAttachmentManager</span></a> class
is a pure virtual interface class that defines the APIs to be used for attachment
management in the Messaging Framework. </p>
 </li>

</ul>
 </div>

<div class="section"><h2 class="sectiontitle">Typical uses</h2> <ul>
<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-7669F08C-0D4A-5DB1-A965-EC6178B82568"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-7669F08C-0D4A-5DB1-A965-EC6178B82568"><!-- --></a><p>Configuring the Message
Server ans Store </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-B915A682-265E-58B9-A66A-DE9194685952"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-B915A682-265E-58B9-A66A-DE9194685952"><!-- --></a><p>Writing MTMs </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-3DB37ED4-44D6-56EE-B8C0-D5BFD31567E4"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-3DB37ED4-44D6-56EE-B8C0-D5BFD31567E4"><!-- --></a><p>Searching and sorting
messages </p>
 </li>

<li id="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-7E268EA1-922D-5657-885A-298E29135603"><a name="GUID-8390D842-B8A3-5042-952D-73240DB30D6B__GUID-7E268EA1-922D-5657-885A-298E29135603"><!-- --></a><p>Processing emails in
chunks </p>
 </li>

</ul>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-B394A824-8745-505E-8429-8B9B6D418387.html">Message Server and Store</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-54AB166A-8B24-5065-92AD-5FC1BF3ED89C.html">Messaging
Framework</a></div>
<div><a href="GUID-44CF5471-564E-5790-935B-51193A4978D6.html" title="This section lists the concepts that are related to Message Server and Store.">Message Server
and Store Concepts</a></div>
<div><a href="GUID-DD27A452-8B0F-5C6D-A2E6-FC21145468B6.html">Message Server
and Store Tutorials</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>