<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Importing Certificates"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-2663ED06-8C97-5867-B7F6-6167EBFEA223.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A5DCCEB1-77DA-53C9-A1A3-07615DFCD403.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-93C32496-036F-5000-B6FD-CAECAD21DEB8.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-88EC0D74-5595-5FA8-B7BA-B914CC8022FB.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F6C20181-0F03-5B8A-B548-C81FF8824503.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DCC2060B-BFEC-5ECF-8154-5AE9C8513F75.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B946BDF0-C5D8-57E2-9D05-7BE134AD032E.html#GUID-B946BDF0-C5D8-57E2-9D05-7BE134AD032E/GUID-DD7D5D55-A2F1-54FB-AA38-B4A7C920B6A6"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Importing Certificates</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638"><a name="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2858558 id2859383 id2859628 id2859642 id2859657 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-315452C2-A1E2-5888-A694-6D2DE73A3F5E.html">OS Security Guide</a> &gt; <a href="GUID-2663ED06-8C97-5867-B7F6-6167EBFEA223.html">Crypto Services</a> &gt; <a href="GUID-A5DCCEB1-77DA-53C9-A1A3-07615DFCD403.html">File-Based Certificate and Key Stores</a> &gt; <a href="GUID-93C32496-036F-5000-B6FD-CAECAD21DEB8.html">certtool</a> &gt; <a href="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html">certtool Tutorials</a> &gt; </div>
<h1 class="topictitle1">Importing
Certificates</h1>
<div>
<p>The Symbian certstore allows two types of certificates to
be imported: root certificates and user certificates. </p>

<p>Please note that certificates must be in DER format to be imported. Also,
the absolute path to the certificate file must be given regardless of the
current directory in the shell. For example, if you are in the directory c:\temp
which contains mycert.der, to import the certificate you must issue the command: </p>

<p><kbd class="userinput">certtool –import c:\temp\mycert.der</kbd> </p>

<p>A certificate always has a label associated with it. A label can be specified
during the import operation with the –label option, if this option is not
present, the full path to the certificate file is taken as label. Labels must
be unique within a specific certstore implementation. If a label is not unique,
an error occurs. For instance, if the certstore contains a certificate with
label abc: </p>

<p><kbd class="userinput">certtool –list abc</kbd> </p>

<pre class="codeblock" id="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-685BAF1F-36A2-5725-B3A4-73EB1E916233"><a name="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-685BAF1F-36A2-5725-B3A4-73EB1E916233"><!-- --></a>Symbian CertStore Manipulation Tool
Copyright (c) 2004-2009 Nokia Corporation and/or its subsidiary(-ies).  All rights reserved.
Label: abc            Format: WTLS     Owner Type: Root (CA)
Issuer Name: Limited Liability        Subject Name: Limited Liability
Valid From: 15:13:18 Tue 29th Feb 2000 Valid Until: 15:43:18 Sat 29th Feb 2020
Trusted for Applications: </pre>

<p>If you try to import a certificate with the same label, an error occurs. </p>

<pre class="codeblock" id="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-066EACF2-C947-51B7-A6DB-CCEAD7679720"><a name="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-066EACF2-C947-51B7-A6DB-CCEAD7679720"><!-- --></a>c:\&gt;certtool –label abc –import c:\certstore\ent-wtls2.cer
Symbian CertStore Manipulation Tool
Copyright (c) 2004-2009 Nokia Corporation and/or its subsidiary(-ies).  All rights reserved.
The given label is invalid, or already present in the certstore.
Label: abc            Format: WTLS     Owner Type: Root (CA)
Issuer Name: Limited Liability        Subject Name: Limited Liability
Valid From: 15:13:18 Tue 29th Feb 2000 Valid Until: 15:43:18 Sat 29th Feb 2020
Trusted for Applications: </pre>

<p>However, this happens because of the attempt made to insert the certificate
in a certstore implementation where the same label already exists. Certstore
implementation is not specified for use in a command. It is possible to insert
the certificate with label abc in the certstore implementation with index
1 (Index 0 is used by default). </p>

<p><kbd class="userinput">certtool –label abc –store 1 –import c:\certstore\ent-wtls2.cer</kbd> </p>

<pre class="codeblock" id="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-F16C6BA0-9408-50E1-B525-275F2C020B99"><a name="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-F16C6BA0-9408-50E1-B525-275F2C020B99"><!-- --></a>Symbian CertStore Manipulation Tool
Copyright (c) 2004-2009 Nokia Corporation and/or its subsidiary(-ies).  All rights reserved.
Certificate imported successfully.
Label: abc            Format: WTLS     Owner Type: Root (CA)
Issuer Name: Limited Liability        Subject Name: Limited Liability
Valid From: 15:13:18 Tue 29th Feb 2000 Valid Until: 15:43:18 Sat 29th Feb 2020
Trusted for Applications: </pre>

<p><strong>Importing root certificates </strong> </p>

<p>Root certificates typically belong to a certificate authority (CA) and
a number of them are present on a final product. Root certificates are used
to verify the authenticity of signed content. Root certificates are self-signed,
and often termed top-level certificates. </p>

<p>All the examples in the previous sections referred to root certificates. </p>

<p>A certificate is imported as a CA root certificate if and only if the corresponding
private key cannot be found in the keystore. </p>

<p><strong>Importing user certificates </strong> </p>

<p>User certificates belong to the phone owner. Using user certificate, the
phone owners can authenticate themselves. For example, during SSL/TLS, the
owner can perform client authentication. To import a user certificate both
the certificate and its corresponding private key must be stored in the Symbian
keystore. </p>

<p>If the private key corresponding to a given certificate is already present
in the Symbian keystore, the certificate will be automatically imported as
a user certificate. </p>

<p>Assume that the private DSA key corresponding to the certificate stored
in dsa_cert1.der is present in the Symbian keystore. The following command
imports the certificate as a user certificate: </p>

<p><kbd class="userinput">certtool –label abc –import c:\certstore\data\dsa_cert1.der</kbd> </p>

<pre class="codeblock" id="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-8343DE09-42AE-597C-B0B5-66A29E85C1FE"><a name="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-8343DE09-42AE-597C-B0B5-66A29E85C1FE"><!-- --></a>Symbian CertStore Manipulation Tool
Copyright (c) 2004-2009 Nokia Corporation and/or its subsidiary(-ies).  All rights reserved.
Certificate imported successfully.
Label: abc            Format: X509     Owner Type: User
Issuer Name: 10.32.193.163        Subject Name: Internet Widgits Pty Ltd
Valid From: 16:06:43 Tue 02nd Jun 2009 Valid Until: 16:03:43 Sat 01st Aug 2009
Trusted for Applications: </pre>

<p>If the private key is not already present in the keystore, the same command
imports the certificate as a CA certificate. </p>

<p>Keytool can be used to include private keys in the Symbian keystore. Alternatively,
if you only want to include a user certificate, point to a DER-encoded PKCS8
file containing the key using the <samp class="codeph">-private</samp> option. After
importing the key, <samp class="codeph">certtool</samp> will make the owner of the key
as "WriteDeviceData", so that keytool will able to manipulate the key, performing
actions such as <samp class="codeph">remove</samp> or <samp class="codeph">setuser</samp>. </p>

<p>Assume the DSA private key corresponding to the certificate stored in <span class="filepath">dsa_cert1.der</span> is
not present in the keystore and that the required DSA private key is stored
in pkcs8 DER-encoded format in the file <span class="filepath">pkcs8dsa1.001</span>. </p>

<p><kbd class="userinput">certtool –label abc –private c:\certstore\data\pkcs8dsa1.001
–import c:\certstore\data\dsa_cert1.der </kbd> </p>

<pre class="codeblock" id="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-801FA528-BC21-5807-9CB4-AC2E46B7D645"><a name="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-801FA528-BC21-5807-9CB4-AC2E46B7D645"><!-- --></a>Symbian CertStore Manipulation Tool
Copyright (c) 2004-2009 Nokia Corporation and/or its subsidiary(-ies).  All rights reserved.
Certificate imported successfully.
Label: abc            Format: X509     Owner Type: User
Issuer Name: 10.32.193.163        Subject Name: Internet Widgits Pty Ltd
Valid From: 16:06:43 Tue 02nd Jun 2009 Valid Until: 16:03:43 Wed 01st Jul 2009
Trusted for Applications: </pre>

<p>Note: Either <span class="filepath">secdlg</span> or <span class="filepath">tsecdlg</span> need
to be in <span class="filepath">\epoc32\release\winscw\udeb</span>. However, if both
of them are present in the specified location, it will cause a panic. </p>

<p>In addition, the corresponding DSA key is inserted in the keystore with
the same label as the certificate. </p>

<p><kbd class="userinput">keytool –d –list abc</kbd> </p>

<pre class="codeblock" id="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-BBF41E07-B425-5D8E-9C66-D235B6030714"><a name="GUID-6CDB86E4-89BB-5266-8CEC-7353B664D638__GUID-BBF41E07-B425-5D8E-9C66-D235B6030714"><!-- --></a>Symbian KeyStore Manipulation Tool
Copyright (c) 2004-2009 Nokia Corporation and/or its subsidiary(-ies).  All rights reserved.
    Algorithm: DSA    Size: 512 bits
    Usage: PKCS15 Sign     Code: 0x4
    User: No Users registered.
    Access flags: Extractable
    ID: c0 fa d9 …
    Label: abc
    Native: Yes
    Start date: not set    End data: not set</pre>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-8A80DD04-075D-5CF2-9A70-F6DDDD7D54BC.html">certtool Tutorials</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-88EC0D74-5595-5FA8-B7BA-B914CC8022FB.html">Listing Contents
of Certificate Stores</a></div>
<div><a href="GUID-F6C20181-0F03-5B8A-B548-C81FF8824503.html">Working with
Multiple Certificate Store Implementations</a></div>
<div><a href="GUID-DCC2060B-BFEC-5ECF-8154-5AE9C8513F75.html">Removing
Certificates</a></div>
</div>
<div class="relinfo"><strong>Related information</strong><br/>
<div><a href="GUID-B946BDF0-C5D8-57E2-9D05-7BE134AD032E.html#GUID-B946BDF0-C5D8-57E2-9D05-7BE134AD032E__GUID-DD7D5D55-A2F1-54FB-AA38-B4A7C920B6A6">Manipulating Applicability and Trust Settings for a Certificate</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>