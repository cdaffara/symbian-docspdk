<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Environment Slots"/>
<meta name="abstract" content="Up to 16 separate pieces of information can be passed to a process on creation using Environment Slots. These include handles and binary data."/>
<meta name="description" content="Up to 16 separate pieces of information can be passed to a process on creation using Environment Slots. These include handles and binary data."/>
<meta name="DC.Relation" scheme="URI" content="GUID-DC8D3736-EDCF-54CB-A614-2AAC4664F1CA.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F78B7BF9-5FDD-4EF8-A921-71CCBB830A99.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DC8D3736-EDCF-54CB-A614-2AAC4664F1CA.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Environment Slots</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2387835 id2387995 id2388473 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-C14B2552-43A7-4499-ABFE-1725128DA6EF.html" title="Kernel and Hardware Services performs the fundamental operating system tasks of managing access to device resources.">Kernel and Hardware Services Guide</a> &gt; <a href="GUID-F78B7BF9-5FDD-4EF8-A921-71CCBB830A99.html" title="The device driver framework and how to implement a device driver.">Device Driver Guide</a> &gt; <a href="GUID-DC8D3736-EDCF-54CB-A614-2AAC4664F1CA.html" title="This section describes how device drivers can use the services that the Kernel provides.">Kernel-Side Services</a> &gt; </div>
<h1 class="topictitle1">Environment
Slots</h1>
<div><p>Up to 16 separate pieces of information can be passed to a process
on creation using Environment Slots. These include handles and binary data.</p>

<p>Handles and binary data can be passed to a process at process creation
time using environment slots. This topic describes this concept, and explains
how to use the process APIs for environment slots. </p>

<ul>
<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1D2A9BFD-FAE6-55F0-9A54-58BA4165B1F0"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1D2A9BFD-FAE6-55F0-9A54-58BA4165B1F0"><!-- --></a><p> <a href="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51.html#GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-FCF8DC31-9D90-53C8-BE30-76D6CD0243BC">Overview</a>  </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-E2F77CE5-E856-582C-BF4F-0EF13E6A40D1"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-E2F77CE5-E856-582C-BF4F-0EF13E6A40D1"><!-- --></a><p> <a href="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51.html#GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D84521B5-4C3B-538C-946A-88EAA3713A8D">The APIs</a>  </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-8C3631E9-D240-5C72-A6E0-EF255A3C8D17"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-8C3631E9-D240-5C72-A6E0-EF255A3C8D17"><!-- --></a><p> <a href="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51.html#GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-7F6B118C-0911-5979-8420-475985DB884B">Passing a file handle and a subsession</a>  </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-3DDB166F-E949-5B0A-B4B9-FC6EE580ECCE"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-3DDB166F-E949-5B0A-B4B9-FC6EE580ECCE"><!-- --></a><p> <a href="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51.html#GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-19964DED-E6AD-59B4-BEDB-2A40864FBD29">Passing a general handle, derived from RHandleBase</a>  </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D6A9288F-5B22-56B8-8F8E-738F7B38BD1E"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D6A9288F-5B22-56B8-8F8E-738F7B38BD1E"><!-- --></a><p> <a href="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51.html#GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-AAB81C64-A515-50E5-BF80-1D625AF1251C">Passing descriptor data</a>  </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-502C284C-3B56-5B6E-AEB5-F1E9DB513CA6"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-502C284C-3B56-5B6E-AEB5-F1E9DB513CA6"><!-- --></a><p> <a href="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51.html#GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D2F661C6-21EB-50A6-A475-2A4A775A9F4D">Passing an integer</a>  </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-E5B29175-9647-5F88-961C-47CD20DF2238"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-E5B29175-9647-5F88-961C-47CD20DF2238"><!-- --></a><p> <a href="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51.html#GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-02AD23DF-7D54-5178-AA5B-050333CD2609">Error handling issues</a>  </p>
 </li>

</ul>

<div class="section" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-FCF8DC31-9D90-53C8-BE30-76D6CD0243BC"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-FCF8DC31-9D90-53C8-BE30-76D6CD0243BC"><!-- --></a><h2 class="sectiontitle">Overview</h2> <p>Handles
and binary data, in the form of descriptors or integer values, can be passed
to a process at process creation time, using what are called environment slots. </p>
 <p>Up
to 16 separate pieces of information can be passed to a process on creation.
For this purpose, a process has 16 environment slots that can contain the
information passed to it by the launching process. </p>
 <p>Slot 0 is reserved
and is never available for general purpose information passing. </p>
 <p>The
parent (launching) process can only pass information to the child (created)
process after the child process has been created. However, it should be done
before the child process is resumed; it is an error to try and set environment
data in a child process that has been resumed. </p>
 <p>A child process can
only extract the information from its environment slots once. Extracting information
from a slot causes that information to be deleted from the slot. </p>
 <p>It
is a matter of convention between the parent and child process as to the meaning
to be applied to a slot, and the type of data that it is to contain. </p>
 </div>

<div class="section" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D84521B5-4C3B-538C-946A-88EAA3713A8D"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D84521B5-4C3B-538C-946A-88EAA3713A8D"><!-- --></a><h2 class="sectiontitle">The APIs</h2> <p>To
pass, a handle, a client server subsession, or binary data to a child process,
the parent process calls <samp class="codeph">RProcess::SetParameter()</samp>, where
the <a href="GUID-9DD1EA2B-DC59-315C-8E9C-CE6D9461B695.html"><span class="apiname">RProcess</span></a> object represents the newly created child
process. There are five overloaded variants of <samp class="codeph">SetParameter()</samp> used
for passing: </p>
 
<div class="tablenoborder"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-5BEA9FCB-68E8-56DD-BA60-71372984AA38"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-5BEA9FCB-68E8-56DD-BA60-71372984AA38" frame="border" border="1" rules="all">
<tbody>
<tr>
<td class="cellrowborder" valign="top"><p>handle: </p>
 </td>

<td class="cellrowborder" valign="top"><pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-EA9128DD-3694-5A2B-AB86-78BA81B43F5A"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-EA9128DD-3694-5A2B-AB86-78BA81B43F5A"><!-- --></a>TInt RProcess::SetParameter(TInt aSlot, RHandleBase aHandle);</pre>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p>client server subsession: </p>
 </td>

<td class="cellrowborder" valign="top"><pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D7FFAA04-44E4-5C4C-8B3B-4628AB965B58"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D7FFAA04-44E4-5C4C-8B3B-4628AB965B58"><!-- --></a>TInt RProcess::SetParameter(TInt aSlot, const RSubSessionBase&amp; aSession);</pre>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p>8-bit descriptor: </p>
 </td>

<td class="cellrowborder" valign="top"><pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-32499AC5-3C9F-5927-A797-24A0367E22A7"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-32499AC5-3C9F-5927-A797-24A0367E22A7"><!-- --></a>TInt RProcess::SetParameter(TInt aSlot, const TDesC8&amp; aDes);</pre>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p>16-bit descriptor: </p>
 </td>

<td class="cellrowborder" valign="top"><pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1997FC14-79C7-5DEC-9647-9FA14CB8EE84"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1997FC14-79C7-5DEC-9647-9FA14CB8EE84"><!-- --></a>TInt RProcess::SetParameter(TInt aSlot, const TDesC16&amp; aDes);</pre>
 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top"><p>integer: </p>
 </td>

<td class="cellrowborder" valign="top"><pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-0F865FC0-C2D7-55A5-B90A-17F88958F6D9"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-0F865FC0-C2D7-55A5-B90A-17F88958F6D9"><!-- --></a>TInt RProcess::SetParameter(TInt aSlot, TInt aData);</pre>
 </td>

</tr>

</tbody>

</table>
</div>
 <p>To extract, a handle, or a client server subsession, a child process
can use the <samp class="codeph">Open()</samp> function called on the relevant <a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html"><span class="apiname">RHandleBase</span></a> derived
type: </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-244AB92B-34FD-5B45-B0AA-1679D3DD9761"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-244AB92B-34FD-5B45-B0AA-1679D3DD9761"><!-- --></a>TInt RSemaphore ::Open(TInt aArgumentIndex, TOwnerType aType=EOwnerProcess);
TInt RBusLogicalChannel::Open(TInt aArgumentIndex, TOwnerType aType=EOwnerProcess);
TInt RMsgQueueBase::Open(TInt aArgumentIndex, TOwnerType aType=EOwnerProcess);
TInt RMutex::Open(TInt aArgumentIndex, TOwnerType aType=EOwnerProcess);
TInt RChunk::Open(TInt aArgumentIndex, TOwnerType aType=EOwnerProcess);
TInt RSessionBase::Open(TInt aArgumentIndex, TOwnerType aType=EOwnerProcess);
    </pre>
 <p>To extract descriptor data, or integer data, a child process
can use the <a href="GUID-C197C9A7-EA05-3F24-9854-542E984C612D.html"><span class="apiname">User</span></a> class functions: </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-CC129A19-0FF6-58C6-B11C-564D816BF845"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-CC129A19-0FF6-58C6-B11C-564D816BF845"><!-- --></a>static TInt User::ParameterLength(TInt aSlot);
static TInt User::GetTIntParameter(TInt aSlot, TInt&amp; aData);
static TInt User::GetDesParameter(TInt aSlot, TDes8&amp; aDes);
static TInt User::GetDesParameter(TInt aSlot, TDes16&amp; aDes);
    </pre>
 <div class="fignone" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D9CD78E1-6813-5F68-9883-F1F6DC04C92A"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D9CD78E1-6813-5F68-9883-F1F6DC04C92A"><!-- --></a><span class="figcap">Figure 1. Environment slots</span>

<img src="GUID-ABE7BC1A-C51B-5ADD-8568-87A81423B648_d0e308713_href.png"/>
</div>
 </div>

<div class="section" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-7F6B118C-0911-5979-8420-475985DB884B"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-7F6B118C-0911-5979-8420-475985DB884B"><!-- --></a><h2 class="sectiontitle"> Passing a
file handle and a subsession</h2> <p>File server session handles and file
handles can both be passed to a child process. </p>
 <p>The child process adopts
the file handle, and must not be closed by the parent. To use a file handle,
the session handle must also be passed. </p>
 <p>For <em>security reasons</em>,
when sharing a file handle, the parent process should create a separate file
server session for the specific purpose of sharing the file handle. If the
parent process has other files open with this file server session, the child
process can gain access to those files by iterating through all the possible
values for the file handle and attempting to <samp class="codeph">Adopt()</samp> each
one. For the same reason, the child process should only use this session for
sharing the file; it should not access other files through this session. </p>
 <p>The
following two code fragments show code in the parent process and corresponding
code in the child process. </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-202421E4-5ADA-50A8-AE75-32F1071C64B0"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-202421E4-5ADA-50A8-AE75-32F1071C64B0"><!-- --></a>//Code in the parent (launching) process

    RProcess p;
    p.Create(KProcName, KNullDesC);    //create “child” process
    
    RFile file;
    RFs session;
    session.Connect();                //connect to file server
    session.ShareProtected();
    file.Create(iSession, KFileName, EFileStreamText|EFileWrite|EFileShareAny);
    file.Write(0, KTestData);
    
    p.SetParameter(5, session);        //session handle passed in slot 5
    p.SetParameter(6, file);        //file handle passed in slot 6
    Session.Close();
    p.Resume();
  </pre>
 <p> <samp class="codeph">KProcName</samp> is the full path name of the
executable associated with the child process, and <samp class="codeph">KFilename</samp> is
the file name. </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-AE2354AA-D95A-5291-BFC4-1EDF470D65AE"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-AE2354AA-D95A-5291-BFC4-1EDF470D65AE"><!-- --></a>//Code in the child (launched) process

    RFs session;
    session.Open(5);            //obtain session handle from slot 5
    
    RFile file;
    TInt handle;
    ret = User::GetTIntParameter(8, handle);//get file handle from slot 8
    file.Adopt(session, handle);            //adopt the handle
    TBuf8&lt;100&gt; rbuf;                         //use the file
    ret = file.Read(0, rbuf);
    file.Close();
    session.Close();
  </pre>
 </div>

<div class="section" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-19964DED-E6AD-59B4-BEDB-2A40864FBD29"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-19964DED-E6AD-59B4-BEDB-2A40864FBD29"><!-- --></a><h2 class="sectiontitle"> Passing a
general handle, derived from RHandleBase</h2> <p>General handles derived
from <a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html"><span class="apiname">RHandleBase</span></a> can be passed to a child process. </p>
 <p>The
handle is duplicated when it is stored in the child process’s environment.
The parent can close the handle immediately after calling <samp class="codeph">SetParameter()</samp>,
or continue to use the handle and close it later. </p>
 <p>The following two
code fragments show code in the parent process and corresponding code in the
child process. </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-591C111A-05B8-5247-84C1-411650AA1FB0"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-591C111A-05B8-5247-84C1-411650AA1FB0"><!-- --></a>//Code in the parent (launching) process,
//passing handles to a mutex and a semaphore.

    RMutex mutex;
    RSemaphore sem; 
    
    RProcess p;
    p.Create(KProcName, KNullDesC);
    mutex.CreateGlobal(KMutexName);    //create the mutex
    sem.CreateGlobal(KSemName,0);    //create the semaphore
    p.SetParameter(3, mutex);    //put mutex handle into child process env' slot 3
    p.SetParameter(4, sem);        //put semaphore handle into child process env' slot 4
    mutex.Close();
    Sem.Close();
    p.Resume();            //resume the child process
    </pre>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-78E31AB6-4900-5AE8-9755-8ACDD8265235"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-78E31AB6-4900-5AE8-9755-8ACDD8265235"><!-- --></a>//Code in the child (launched) process retrieving the handles.
    
    RMutex mutex;
    mutex.Open(3, EOwnerThread);    //get mutex handle
    RSemaphore sem;
    sem.Open(4, EOwnerThread);        //get semaphore handle
    
    //use the semaphore and mutex
    mutex.Close();
    sem.Close();
    </pre>
 </div>

<div class="section" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-AAB81C64-A515-50E5-BF80-1D625AF1251C"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-AAB81C64-A515-50E5-BF80-1D625AF1251C"><!-- --></a><h2 class="sectiontitle"> Passing descriptor
data</h2> <p>Both 8-bit and 16-bit descriptor data can be passed from a
parent to a child process. </p>
 <p>Internally, an <a href="GUID-5BEA9976-B969-3949-B855-E657FFF38EE2.html"><span class="apiname">HBuf</span></a> descriptor
is created containing the passed descriptor data, and a pointer to this descriptor
is passed in the relevant slot. </p>
 <p>The child process retrieves the descriptor
data by calling <a href="GUID-C197C9A7-EA05-3F24-9854-542E984C612D.html#GUID-C197C9A7-EA05-3F24-9854-542E984C612D__GUID-54C7406E-C498-3BE7-BB2C-1C5BA902A4D7"><span class="apiname">User::GetDesParameter()</span></a>. It can get the
length of the data by calling <a href="GUID-C197C9A7-EA05-3F24-9854-542E984C612D.html#GUID-C197C9A7-EA05-3F24-9854-542E984C612D__GUID-ABD3F4AE-C226-3AF1-AD25-7A45B186385C"><span class="apiname">User::ParameterLength()</span></a>. </p>
 <p>The
following two code fragments show code in the parent process and corresponding
code in the child process. </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-57FFCAC9-CA4E-50B7-843A-0523243F5B1E"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-57FFCAC9-CA4E-50B7-843A-0523243F5B1E"><!-- --></a>//Code in the parent (launching) process, passing 8 and sixteen bit data

    RProcess p;
    p.Create(KProcName, KNullDesC);
    p.SetParameter(2, KSixteenBitDes);
    p.SetParameter(3, KEightBitDes);
    p.Resume();
    </pre>
 <p>where <samp class="codeph">KSixteenBitDes</samp> is a 16-descriptor,
and <samp class="codeph">KEightBitDes</samp> is an 8-bit descriptor. </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-8B442CA2-0A6A-546C-805B-99C306891B40"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-8B442CA2-0A6A-546C-805B-99C306891B40"><!-- --></a>//Code in the child (launched) process retrieving 8 and sixteen bit data
    
    TInt len;
    TInt ret;

    TBuf16&lt;40&gt; buf;
    len = User::ParameterLength(2);        //parameter length is the size in bytes
    ret = User::GetDesParameter(2, buf);
    
    //buf.Length() should have the value of len/2;


    TBuf8&lt;40&gt; buf8;
    len = User::ParameterLength(3);
    ret = User::GetDesParameter(3, buf8);
    //buf.Length() should be the same as len
    </pre>
 <p>Note that the descriptors, <samp class="codeph">buf</samp>, and <samp class="codeph">buf8</samp> used
in the child process must have sufficiently large maximum lengths to accomodate
the data. </p>
 </div>

<div class="section" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D2F661C6-21EB-50A6-A475-2A4A775A9F4D"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D2F661C6-21EB-50A6-A475-2A4A775A9F4D"><!-- --></a><h2 class="sectiontitle">Passing an
integer</h2> <p>An integer can be passed from a parent to a child process. </p>
 <p>The
following two code fragments show code in the parent process and corresponding
code in the child process. </p>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-AA845210-E551-50B3-9E1F-CD6F8C37D13B"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-AA845210-E551-50B3-9E1F-CD6F8C37D13B"><!-- --></a>//Code in the parent (launching) process

    RProcess p;
    TInt ret;
 
    ret = p.Create(KProcName, KNullDesC);
    p.SetParameter(12, 1234);  // Using slot 12
    p.Resume();
    </pre>
 <pre class="codeblock" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D5E4CFA8-15DA-543F-9616-7F075FBBCDC1"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-D5E4CFA8-15DA-543F-9616-7F075FBBCDC1"><!-- --></a>//Code in the child (launched) process, retrieving the integer.

    TInt val;
    TInt ret;

    ret = User::GetTIntParameter(12, val);

    </pre>
 </div>

<div class="section" id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-02AD23DF-7D54-5178-AA5B-050333CD2609"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-02AD23DF-7D54-5178-AA5B-050333CD2609"><!-- --></a><h2 class="sectiontitle">Error handling
issues</h2> <p>The parent process is panicked when calling <samp class="codeph">SetParameter()</samp> with
a handle if: </p>
 <ul>
<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1BDFA3C0-0E69-5B0C-A27F-D2DEFC0B2C0F"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1BDFA3C0-0E69-5B0C-A27F-D2DEFC0B2C0F"><!-- --></a><p>the parent process is
not the creator of the child process </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1DF3C097-73AC-54B8-9654-435C6F163E95"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-1DF3C097-73AC-54B8-9654-435C6F163E95"><!-- --></a><p>the slot number is out
of range, i.e. is not in the range 0 to 15 </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-B02324A1-D241-5103-A2EC-297474EF65E1"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-B02324A1-D241-5103-A2EC-297474EF65E1"><!-- --></a><p>the slot is in use </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-6014D837-107F-536C-8947-74C5967D2264"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-6014D837-107F-536C-8947-74C5967D2264"><!-- --></a><p>the handle is local. </p>
 </li>

</ul>
 <p>The parent process is panicked when calling <samp class="codeph">SetParameter()</samp> with
a descriptor or integer if: </p>
 <ul>
<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-2FAF76CC-2569-5E2E-ADBA-AFA124F11C84"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-2FAF76CC-2569-5E2E-ADBA-AFA124F11C84"><!-- --></a><p>the parent process is
not the creator of the child process </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-C23722B2-4EEB-5050-B82E-F58F450F088F"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-C23722B2-4EEB-5050-B82E-F58F450F088F"><!-- --></a><p>the slot number is out
of range, i.e. is not in the range 0 to 15 </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-9ADA7D18-B084-509C-8F4A-66E885F61D0A"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-9ADA7D18-B084-509C-8F4A-66E885F61D0A"><!-- --></a><p>the slot is in use </p>
 </li>

<li id="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-32B64BAC-F13E-5029-93ED-642994E35886"><a name="GUID-AD2BD987-E097-5E1F-A914-B91CFB706D51__GUID-32B64BAC-F13E-5029-93ED-642994E35886"><!-- --></a><p>the length of the data
is negative. </p>
 </li>

</ul>
 <p>The child process is panicked if the slot number is out of range. </p>
 <p>The
API functions that extract data from the process environment return <a href="GUID-0BEA3647-7888-3612-A2D3-7E27AC405E29.html"><span class="apiname">KErrArgument</span></a> if
a slot contains the incorrect data type, or the length is incorrect. They
return <a href="GUID-5E653C17-372C-32E1-A1B2-9E69A9991C40.html"><span class="apiname">KErrNotFound</span></a> if a slot is empty. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-DC8D3736-EDCF-54CB-A614-2AAC4664F1CA.html" title="This section describes how device drivers can use the services that the Kernel provides.">Kernel-Side Services</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>