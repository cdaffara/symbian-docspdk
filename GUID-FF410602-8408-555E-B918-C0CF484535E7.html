<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Writing Interface Definitions"/>
<meta name="DC.Relation" scheme="URI" content="GUID-41D80358-473F-5B50-A09A-4F5601EAC4A9.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-9E92EE30-F2E2-5F28-BB2A-391C09EC69D2.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-110A0151-5719-51BC-8506-C18BE57FB400.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-41D80358-473F-5B50-A09A-4F5601EAC4A9.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-FF410602-8408-555E-B918-C0CF484535E7"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Writing Interface Definitions</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-FF410602-8408-555E-B918-C0CF484535E7"><a name="GUID-FF410602-8408-555E-B918-C0CF484535E7"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2381103 id2383459 id2383473 id2383529 id2383537 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-5072BE46-B1B4-5C3A-BF55-BEA7443E7657.html">Generic OS Services Guide</a> &gt; <a href="GUID-324107D1-6E0B-56DD-BDC0-7296F688A9CF.html">Low Level Libraries and Frameworks</a> &gt; <a href="GUID-9E92EE30-F2E2-5F28-BB2A-391C09EC69D2.html">Plug-in Framework</a> &gt; <a href="GUID-110A0151-5719-51BC-8506-C18BE57FB400.html">Plug-in Framework Tutorials</a> &gt; <a href="GUID-41D80358-473F-5B50-A09A-4F5601EAC4A9.html">Framework Developer Tutorials</a> &gt; </div>
<h1 class="topictitle1">Writing
Interface Definitions</h1>
<div><div><p>To use a plug-in, the client of the plug-in framework needs to
instantiate an object through the interface definition, use the object and
delete the object when the scope of the object usage is complete. Client calls
to the interface definition for construction and destruction translate directly
through REComSession into loading and unloading of the correct implementation. </p>
<p>The <a href="GUID-9E0CBB66-A573-5BBE-9788-95B313325C7E.html">interface definition</a> defines
functions that offer services to the clients and enable object instantiation.
The object instantiation functions uses the plug-in framework to create an
instance of an appropriate implementation, and returns the instance to the
client. </p>
</div>

<div class="section"><p>A function in the interface definition delegates the object instantiation
to a static function <a href="GUID-1344F049-81C4-3D17-AF46-8B5584680ADB.html#GUID-1344F049-81C4-3D17-AF46-8B5584680ADB__GUID-C7F147AC-6D77-3169-AAB4-B27262B4333B"><span class="apiname">REComSession::CreateImplementationL()</span></a> .
The <a href="GUID-1344F049-81C4-3D17-AF46-8B5584680ADB.html#GUID-1344F049-81C4-3D17-AF46-8B5584680ADB__GUID-C7F147AC-6D77-3169-AAB4-B27262B4333B"><span class="apiname">REComSession::CreateImplementationL()</span></a> is an overloaded
function and offers many input parameter options. The appropriate <a href="GUID-1344F049-81C4-3D17-AF46-8B5584680ADB.html#GUID-1344F049-81C4-3D17-AF46-8B5584680ADB__GUID-C7F147AC-6D77-3169-AAB4-B27262B4333B"><span class="apiname">REComSession::CreateImplementationL()</span></a> function
is called for object instantiation. If the client passes input data then this
data must be wrapped in a <samp class="codeph">TEComResolverParams</samp> object. </p>
 <p> </p>
 </div>

<a name="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-B502261A-48DA-5EC1-82F9-6136CF5A2C50"><!-- --></a><ol id="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-B502261A-48DA-5EC1-82F9-6136CF5A2C50"><li class="stepexpand" id="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-D9F104A5-4D58-5488-AB0A-C90C26A40C28"><a name="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-D9F104A5-4D58-5488-AB0A-C90C26A40C28"><!-- --></a><span>Derive an interface
definition class from <a href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html"><span class="apiname">CBase</span></a> or <a href="GUID-727D2B62-09A9-3CBC-AB6F-591E52EC68EB.html"><span class="apiname">RHandleBase</span></a> based
class. The class must always declare a private UID member. </span>
 The following shows an example segment of an interface definition class
that derives from CActive. 
 <pre class="codeblock" id="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-2D4E24B1-0463-5970-B0FD-321FC599E1CB"><a name="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-2D4E24B1-0463-5970-B0FD-321FC599E1CB"><!-- --></a>class CExampleInterfaceDefinition : public CActive
    {
public:
    // Wraps ECom object instantiation
    static CExampleInterfaceDefinition* NewL();
     static CExampleInterfaceDefinition* NewL(const TDesC&amp; aMatchString);
    // Wraps ECom object destruction 
    virtual ~CExampleInterfaceDefinition();
    // Interface service 
    virtual void DoMethodL() = 0;
...
private:
    // Instance identifier key or UID.
    TUid iDtor_ID_Key;
    };</pre>
 
</li>
<li class="stepexpand" id="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-82F4FEE2-22B9-51E7-96CD-2CAA7FBF78C2"><a name="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-82F4FEE2-22B9-51E7-96CD-2CAA7FBF78C2"><!-- --></a><span>Implement the object
creation function NewL() for the derived class. </span>
 Call the appropriate <a href="GUID-1344F049-81C4-3D17-AF46-8B5584680ADB.html#GUID-1344F049-81C4-3D17-AF46-8B5584680ADB__GUID-C7F147AC-6D77-3169-AAB4-B27262B4333B"><span class="apiname">REComSession::CreateImplementationL()</span></a> function
if the implementation is to receive data from the client. 
 <pre class="codeblock" id="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-4447C35F-1001-57FB-941F-441E0A2C4799"><a name="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-4447C35F-1001-57FB-941F-441E0A2C4799"><!-- --></a>    // The NewL() function accepts client resolution string as input
inline CExampleInterfaceDefinition* CExampleInterfaceDefinition::NewL(const TDesC&amp; aMatchString)
    {
    const TUid KExampleInterfaceDefinitionUid = {0x10009DC0};
    // The client resolution string is wrapped in TEComResolverParams object for resolution. 
             TEComResolverParams resolverParams; 
       resolverParams.SetDataType(aMatchString);
       TAny* ptr = REComSession::CreateImplementationL(
          KExampleInterfaceDefinitionUid,
         _FOFF(CExampleInterfaceDefinition,iDtor_ID_Key),
         resolverParams);

      return REINTERPRET_CAST &lt;CExampleInterfaceDefinition*&gt;(ptr);
      }</pre>
 
 <pre class="codeblock" id="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-7F634037-2D79-53E0-B132-B9E963603B69"><a name="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-7F634037-2D79-53E0-B132-B9E963603B69"><!-- --></a></pre>

</li>
</ol>

<div class="section"><p>The interface definition needs to define a destructor function
to destroy the object after use. The interface destructor notifies the plug-in
framework about the object destruction. </p>
 <p>The destructor of the interface
definition must call the static function <a href="GUID-1344F049-81C4-3D17-AF46-8B5584680ADB.html#GUID-1344F049-81C4-3D17-AF46-8B5584680ADB__GUID-8BA69111-0451-34CA-A1E8-C83513C4D29D"><span class="apiname">REComSession::DestroyedImplementation()</span></a> to
signal the object destruction to plug-in framework. The instance identifier
key is passed as a input parameter to <a href="GUID-1344F049-81C4-3D17-AF46-8B5584680ADB.html#GUID-1344F049-81C4-3D17-AF46-8B5584680ADB__GUID-8BA69111-0451-34CA-A1E8-C83513C4D29D"><span class="apiname">REComSession::DestroyedImplementation()</span></a> to
identify the instance. </p>
 <pre class="codeblock" id="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-1E935BFD-D485-5F4D-9569-D34FEC1D90DC"><a name="GUID-FF410602-8408-555E-B918-C0CF484535E7__GUID-1E935BFD-D485-5F4D-9569-D34FEC1D90DC"><!-- --></a>inline CExampleInterfaceDefinition::~CExampleInterfaceDefinition()
    {
    REComSession::DestroyedImplementation(iDtor_ID_Key);
}</pre>
 <p> <strong>Note</strong>: The memory clean-up function<a href="GUID-1344F049-81C4-3D17-AF46-8B5584680ADB.html#GUID-1344F049-81C4-3D17-AF46-8B5584680ADB__GUID-1AACEF53-2CAD-34EC-A485-CE49BC8B9BD8"><span class="apiname">REComSession::FinalClose()</span></a> should
not be invoked inside the destructor, or elsewhere in the interface. For more
details refer the topic <a href="GUID-E3A80D62-09A5-502D-AB55-6AB2A5623465.html" title="To ensure the plug-in framework unloads the plug-in DLLs when they are no longer required and releases associated memory, the clients should follow an explicit memory cleanup procedure. The main purpose is to release memory and close handles held on unused plug-in implementations and their associated DLLs. The memory clean-up should be performed after all instantiated interface objects have been deleted.">Cleaning-up
Memory</a>. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-41D80358-473F-5B50-A09A-4F5601EAC4A9.html">Framework Developer Tutorials</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>