<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="cxxClass"/>
<meta name="DC.Title" content="MTLSSession"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169"/>

<title>MTLSSession</title>

<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->
<meta name="keywords" content="api"/><link rel="stylesheet" type="text/css" href="cxxref.css"/></head>
<body class="cxxref" id="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169"><a name="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2437088 id2437096 id2578593 id2472810 id2409379 id2409771 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">
<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt;</div>
<h1 class="topictitle1">MTLSSession Class Reference</h1>
	<table class="signature"><tr><td>class MTLSSession : public MCTTokenInterface</td></tr></table><div class="section"><div>
			<p>This is an interface to a cryptographic token for the cryptographic services required by the TLS/SSL protocols.   </p>

		</div></div>
<div class="section derivation"><h2 class="sectiontitle">Inherits from</h2><ul class="derivation derivation-root"><li class="derivation-depth-0 ">MTLSSession<ul class="derivation"><li class="derivation-depth-1 "><a href="GUID-686A1AB3-EF35-3D85-8062-6E99CEDD27A1.html">MCTTokenInterface</a></li></ul></li></ul></div>
<div class="section member-index"><table border="0" class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code">void</td><td><a href="#GUID-E2088727-1382-3E13-9089-A91332C2BA2D">CancelClientCertificate</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-AF58C7CB-D04D-3507-84CC-03A2217E9966">CancelClientKeyExchange</a>()</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-FF4C25FF-EB16-3A3A-8A52-2F74847F4EBE">CancelComputeDigitalSignature</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-0B4C5E29-E7E5-322B-B3B8-09FCBA50FE85">CancelConnectionEstablished</a>()</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-C6862531-4C02-30AE-ACB8-3474A1C193C9">CancelPHash</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-6E9F1700-D318-3077-A3D1-CD97CECD7A3D">CancelServerCertificate</a>()</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-19355878-0EC7-36D9-8FEF-CF7604F28B8E">ClientCertificate</a>(<a href="GUID-305D21D7-928F-337F-A55A-0448D7DBF6DC.html">CCTCertInfo</a> *&amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-5D4F0CC8-BF3E-3F4B-98BA-72732476D801">ClientKeyExchange</a>(const <a href="GUID-C9E060E8-C4EC-324C-926C-BBFC6CD5B532.html">TTLSMasterSecretInput</a> &amp;, const <a href="GUID-B90E8D19-22E3-32DF-90F1-7345B516D1D9.html">TTLSProtocolVersion</a> &amp;, const <a href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;, const <a href="GUID-68B6C01C-751E-3F73-AF53-E7BE7AE1E5C6.html">CTLSPublicKeyParams</a> *, <a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-50879C1E-622A-3342-A6A9-FA4BBD630255">ComputeDigitalSignature</a>(const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;, <a href="GUID-305D21D7-928F-337F-A55A-0448D7DBF6DC.html">CCTCertInfo</a> &amp;, <a href="GUID-7AE17C42-BAD8-3BE9-88A9-D0B066D171F2.html">CCTKeyInfo</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-087BB52D-BDD5-3A51-9791-4B8E7A627082">ConnectionEstablished</a>(<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a>, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a>, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a>, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-3881CE90-7224-347E-AA00-3253080856BA">InitL</a>(const <a href="GUID-25E8D6E8-7E78-3BCC-BD3C-75601684E9E1.html">TTLSSessionNameAndID</a> &amp;, const <a href="GUID-347F2465-7349-3F76-8CF6-D41F075CCD23.html">TTLSCipherSuite</a> &amp;, const <a href="GUID-07638E2C-E177-37FC-A212-A2929B1F950A.html">TTLSCompressionMethod</a> &amp;, const <a href="GUID-B90E8D19-22E3-32DF-90F1-7345B516D1D9.html">TTLSProtocolVersion</a> &amp;, <a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a>)</td></tr><tr class="bg"><td align="right" class="code">
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
				</td><td><a href="#GUID-C0376F10-026F-33F1-9C45-3B20549C2381">KeyDerivation</a>(const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, const <a href="GUID-C9E060E8-C4EC-324C-926C-BBFC6CD5B532.html">TTLSMasterSecretInput</a> &amp;, <a href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;)</td></tr><tr><td align="right" class="code">const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><a href="#GUID-D1DD7B8C-0E8A-3B57-B122-05B46B01C8FE">Label</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-466A8340-923F-3B2B-9951-704E5741B79E">PHash</a>(const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;, const <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html">TPHashOp</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-E1087C17-7399-372C-86CD-25EFA60D0797">PHash</a>(<a href="GUID-943C3D23-6BB5-3B7A-9AB5-99541596A32E.html">CMessageDigest</a> *, <a href="GUID-943C3D23-6BB5-3B7A-9AB5-99541596A32E.html">CMessageDigest</a> *, <a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;, const <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html">TPHashOp</a> &amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-BB120E02-07CE-38E7-8C76-2974776855EB">ServerCertificate</a>(<a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;, <a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Inherited Functions</th></tr></thead><tbody><tr><td> </td><td><a href="GUID-686A1AB3-EF35-3D85-8062-6E99CEDD27A1.html">MCTTokenInterface::DoRelease()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-686A1AB3-EF35-3D85-8062-6E99CEDD27A1.html">MCTTokenInterface::Release()</a></td></tr><tr><td> </td><td><a href="GUID-686A1AB3-EF35-3D85-8062-6E99CEDD27A1.html">MCTTokenInterface::Token()</a></td></tr><tr class="bg"><td> </td><td><a href="GUID-686A1AB3-EF35-3D85-8062-6E99CEDD27A1.html">MCTTokenInterface::~MCTTokenInterface()</a></td></tr></tbody></table><table border="0" class="member-index"><thead><tr><th colspan="2">Public Member Enumerations</th></tr></thead><tbody><tr><td align="right" valign="top">enum</td><td><a href="#GUID-9207DB75-C774-3462-A2D5-C24B5FC26DAF">TPHashOp</a> { <a href="#GUID-475617A3-183D-3BA1-9827-43867DD04858">EKeyBlockOp</a>, <a href="#GUID-3E702A0E-F735-3D0B-945E-5A3BBEB44533">EServerFinishedOp</a>, <a href="#GUID-801DD974-8E8B-33BB-864C-B9C4224FA899">EClientFinishedOp</a>, <a href="#GUID-EBEC75DC-A1F2-37BE-ADE6-89DE7D23C05C">ECertificateVerifyOp</a> }</td></tr></tbody></table></div><h1 class="pageHeading topictitle1">Member Functions Documentation</h1><div class="nested1" id="GUID-E2088727-1382-3E13-9089-A91332C2BA2D"><a name="GUID-E2088727-1382-3E13-9089-A91332C2BA2D"><!-- --></a>
		<h2 class="topictitle2">CancelClientCertificate()</h2>
		<table class="signature"><tr><td>void</td><td>CancelClientCertificate</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Cancels corresponding asynchronous request.  </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-AF58C7CB-D04D-3507-84CC-03A2217E9966"><a name="GUID-AF58C7CB-D04D-3507-84CC-03A2217E9966"><!-- --></a>
		<h2 class="topictitle2">CancelClientKeyExchange()</h2>
		<table class="signature"><tr><td>void</td><td>CancelClientKeyExchange</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Cancels corresponding asynchronous request.  </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-FF4C25FF-EB16-3A3A-8A52-2F74847F4EBE"><a name="GUID-FF4C25FF-EB16-3A3A-8A52-2F74847F4EBE"><!-- --></a>
		<h2 class="topictitle2">CancelComputeDigitalSignature()</h2>
		<table class="signature"><tr><td>void</td><td>CancelComputeDigitalSignature</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Cancels corresponding asynchronous request.  </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-0B4C5E29-E7E5-322B-B3B8-09FCBA50FE85"><a name="GUID-0B4C5E29-E7E5-322B-B3B8-09FCBA50FE85"><!-- --></a>
		<h2 class="topictitle2">CancelConnectionEstablished()</h2>
		<table class="signature"><tr><td>void</td><td>CancelConnectionEstablished</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Cancels corresponding asynchronous request.  </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-C6862531-4C02-30AE-ACB8-3474A1C193C9"><a name="GUID-C6862531-4C02-30AE-ACB8-3474A1C193C9"><!-- --></a>
		<h2 class="topictitle2">CancelPHash()</h2>
		<table class="signature"><tr><td>void</td><td>CancelPHash</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Cancels corresponding asynchronous request.  </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-6E9F1700-D318-3077-A3D1-CD97CECD7A3D"><a name="GUID-6E9F1700-D318-3077-A3D1-CD97CECD7A3D"><!-- --></a>
		<h2 class="topictitle2">CancelServerCertificate()</h2>
		<table class="signature"><tr><td>void</td><td>CancelServerCertificate</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"><div>
				<p>Cancels corresponding asynchronous request.  </p>

			</div></div>

	</div>
<div class="nested1" id="GUID-19355878-0EC7-36D9-8FEF-CF7604F28B8E"><a name="GUID-19355878-0EC7-36D9-8FEF-CF7604F28B8E"><!-- --></a>
		<h2 class="topictitle2">ClientCertificate(CCTCertInfo *&amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>ClientCertificate</td><td>(</td><td><a href="GUID-305D21D7-928F-337F-A55A-0448D7DBF6DC.html">CCTCertInfo</a> *&amp;</td><td>aCertInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Used to retrieve client certificate information from cache.  </p>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-305D21D7-928F-337F-A55A-0448D7DBF6DC.html">CCTCertInfo</a> *&amp; aCertInfo</td><td>returned client certificate information, set to NULL if no certificate information is cached  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>asynchronous request status set on the completion  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-5D4F0CC8-BF3E-3F4B-98BA-72732476D801"><a name="GUID-5D4F0CC8-BF3E-3F4B-98BA-72732476D801"><!-- --></a>
		<h2 class="topictitle2">ClientKeyExchange(const TTLSMasterSecretInput &amp;, const TTLSProtocolVersion &amp;, const TDes8 &amp;, const CTLSPublicKeyParams *, HBufC8 *&amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>ClientKeyExchange</td><td>(</td><td>const <a href="GUID-C9E060E8-C4EC-324C-926C-BBFC6CD5B532.html">TTLSMasterSecretInput</a> &amp;</td><td>aMasterSecretInput,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-B90E8D19-22E3-32DF-90F1-7345B516D1D9.html">TTLSProtocolVersion</a> &amp;</td><td>aClientHelloVersion,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;</td><td>aEncodedServerCert,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-68B6C01C-751E-3F73-AF53-E7BE7AE1E5C6.html">CTLSPublicKeyParams</a> *</td><td>aKeyParams,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;</td><td>aClientKeyExch,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Provides the contents of ClientKeyExchange message to TLS/SSL protocol. That is, pre-master secret encrypted with server RSA public key in case of RSA key exchange method or DH public value in case of Diffie-Hellman ephemeral key exchange method. When the method completes, a pre-master secret is generated (so the implementation of this method for WIM should use either WIM-KeyTransport or WIM-KeyAgreement primitive) and a master secret is generated as well (which implies that also WIM-DeriveMasterSecret primitive in WIM implementation should have been called). When the method completes the session can be already stored in the token's cache. However mustn't be set to resumable until <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html#GUID-087BB52D-BDD5-3A51-9791-4B8E7A627082">MTLSSession::ConnectionEstablished</a> method is called. It is recommended to apply the following policy of managing the cache: if there is no memory for new entry in the cache the memory should be released by removing the oldest unused session. It is probably reasonable to lock the WIM for the duration of this method but it is left as an internal decision of WIM supplier to do so.</p>

				<div class="p">
					<dl class="precondition">
						
							<dt class="dlterm">Pre-condition</dt>

							<dd>object should have been initialised by call to InitL </dd>

						
					</dl>

					<dl class="postcondition">
						
							<dt class="dlterm">Post-condition</dt>

							<dd>master secret is generated </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-C9E060E8-C4EC-324C-926C-BBFC6CD5B532.html">TTLSMasterSecretInput</a> &amp; aMasterSecretInput</td><td>input needed for master secret generation (client and server random values)  </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-B90E8D19-22E3-32DF-90F1-7345B516D1D9.html">TTLSProtocolVersion</a> &amp; aClientHelloVersion</td><td>protocol version number sent in client hello message  </td></tr><tr><td class="parameter">const <a href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp; aEncodedServerCert</td><td>server certificate in encoded format (as received from the server)  </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-68B6C01C-751E-3F73-AF53-E7BE7AE1E5C6.html">CTLSPublicKeyParams</a> * aKeyParams</td><td>structure with server public key parameters retrieved from ServerKeyExchange message, the type flag of the TTLSPublicKeyParams structure should indicate appropriate key exchange algorithm to use; the parameter should be set to NULL if is irrelevant for selected cipher suite  </td></tr><tr><td class="parameter"><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp; aClientKeyExch</td><td>buffer with key exchange message contents (output parameter)  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>asynchronous request status set on the completion  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-50879C1E-622A-3342-A6A9-FA4BBD630255"><a name="GUID-50879C1E-622A-3342-A6A9-FA4BBD630255"><!-- --></a>
		<h2 class="topictitle2">ComputeDigitalSignature(const TDesC8 &amp;, HBufC8 *&amp;, CCTCertInfo &amp;, CCTKeyInfo &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>ComputeDigitalSignature</td><td>(</td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aInput,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;</td><td>aSignature,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-305D21D7-928F-337F-A55A-0448D7DBF6DC.html">CCTCertInfo</a> &amp;</td><td>aCertInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-7AE17C42-BAD8-3BE9-88A9-D0B066D171F2.html">CCTKeyInfo</a> &amp;</td><td>aKeyInfo,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<div class="p">Used to sign given input with client private key. The private key comes matches the public key from client certificate selected for authentication.  <dl class="precondition"><dt class="dlterm">Pre-condition</dt>
<dd>master secret should have been generated before (by call to ClientKeyExchange) </dd>
</dl>
</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aInput</td><td>message to be signed  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp; aSignature</td><td>signature of aInput (output paramter)  </td></tr><tr><td class="parameter"><a href="GUID-305D21D7-928F-337F-A55A-0448D7DBF6DC.html">CCTCertInfo</a> &amp; aCertInfo</td><td>structure containing information about certificate selected for client authentication  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-7AE17C42-BAD8-3BE9-88A9-D0B066D171F2.html">CCTKeyInfo</a> &amp; aKeyInfo</td><td>structure containing information about private key matching public key from client certificate, this key is used for signing  </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>asynchronous request status set on the completion  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-087BB52D-BDD5-3A51-9791-4B8E7A627082"><a name="GUID-087BB52D-BDD5-3A51-9791-4B8E7A627082"><!-- --></a>
		<h2 class="topictitle2">ConnectionEstablished(TBool, TBool, TBool, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>ConnectionEstablished</td><td>(</td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>aSuccessful,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>aServerAuthenticated,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>aClientAuthenticated,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<div class="p">Called when handshake is finished. Used to inform the token whether handshake was successful or not. If yes, the session data will be stored in the cache and marked as resumable. Otherwise the session should be removed from the cache. Additional parameters tell whether Server and Client authentication was successful. This information is added to the cache.  <dl class="precondition"><dt class="dlterm">Pre-condition</dt>
<dd>object should have been initialised (by call to InitL) and master secret generated (by call to ClientKeyExchange) before call to this method </dd>
</dl>
<dl class="postcondition"><dt class="dlterm">Post-condition</dt>
<dd>session is cached in case of successful handshake </dd>
</dl>
</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aSuccessful</td><td>ETrue if handshake successfully completed, EFalse otherwise  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aServerAuthenticated</td><td>ETrue if Server authenticated, EFalse otherwise  </td></tr><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aClientAuthenticated</td><td>ETrue if Client authenticated, EFalse otherwise  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>asynchronous request status set on the completion  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-3881CE90-7224-347E-AA00-3253080856BA"><a name="GUID-3881CE90-7224-347E-AA00-3253080856BA"><!-- --></a>
		<h2 class="topictitle2">InitL(const TTLSSessionNameAndID &amp;, const TTLSCipherSuite &amp;, const TTLSCompressionMethod &amp;, const TTLSProtocolVersion &amp;, TBool)</h2>
		<table class="signature"><tr><td>void</td><td>InitL</td><td>(</td><td>const <a href="GUID-25E8D6E8-7E78-3BCC-BD3C-75601684E9E1.html">TTLSSessionNameAndID</a> &amp;</td><td>aSessionNameAndID,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-347F2465-7349-3F76-8CF6-D41F075CCD23.html">TTLSCipherSuite</a> &amp;</td><td>aCipherSuite,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-07638E2C-E177-37FC-A212-A2929B1F950A.html">TTLSCompressionMethod</a> &amp;</td><td>aCompressionMethod,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-B90E8D19-22E3-32DF-90F1-7345B516D1D9.html">TTLSProtocolVersion</a> &amp;</td><td>aVersion,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td>aResume</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<div class="p">Initialisation method. Should allocate memory for internally stored information about the session. The concrete implementation of <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html#GUID-6CC575F7-A779-319D-81B0-F4020DC1E169">MTLSSession</a> abstract class should hold information about session identifier, cipher suite and a protocol version. This information is provided in the arguments of this method. It is supposed that the information will be stored in class' member variables (which implies that the method doesn't need to talk to asynchronous device and that's why the method is synchronous).  <dl class="user"><dt class="dlterm"><strong>leave</strong></dt>
<dd>KTLSBadProtocolVersion if the protocol version passed in the parameter is not supported by the token </dd>
</dl>
<dl class="user"><dt class="dlterm"><strong>leave</strong></dt>
<dd>KTLSBadCipherSuite if the cipher suite passed in the parameter is not supported by the token </dd>
</dl>
<dl class="user"><dt class="dlterm"><strong>leave</strong></dt>
<dd>KTLSErrNotCached if resumption of session is attempted but appropriate entry missing in the cache </dd>
</dl>
<dl class="user"><dt class="dlterm"><strong>leave</strong></dt>
<dd>KTLSErrCacheEntryInUse if resumption of session is attempted but appropriate entry is set to non resumable </dd>
</dl>
<dl class="user"><dt class="dlterm"><strong>leave</strong></dt>
<dd>KErrNoMemory if it not able to allocate memory for the object's members </dd>
</dl>
</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-25E8D6E8-7E78-3BCC-BD3C-75601684E9E1.html">TTLSSessionNameAndID</a> &amp; aSessionNameAndID</td><td>a server name and session identifier  </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-347F2465-7349-3F76-8CF6-D41F075CCD23.html">TTLSCipherSuite</a> &amp; aCipherSuite</td><td>a cipher suite selected for the session  </td></tr><tr><td class="parameter">const <a href="GUID-07638E2C-E177-37FC-A212-A2929B1F950A.html">TTLSCompressionMethod</a> &amp; aCompressionMethod</td><td>a compression method identifier  </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-B90E8D19-22E3-32DF-90F1-7345B516D1D9.html">TTLSProtocolVersion</a> &amp; aVersion</td><td>a TLS/SSL protocol version number  </td></tr><tr><td class="parameter"><a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> aResume</td><td>ETrue if caller wants to resume cached session, EFalse otherwise  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-C0376F10-026F-33F1-9C45-3B20549C2381"><a name="GUID-C0376F10-026F-33F1-9C45-3B20549C2381"><!-- --></a>
		<h2 class="topictitle2">KeyDerivation(const TDesC8 &amp;, const TTLSMasterSecretInput &amp;, TDes8 &amp;)</h2>
		<table class="signature"><tr><td>
					<a href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
				</td><td>KeyDerivation</td><td>(</td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aLabel,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-C9E060E8-C4EC-324C-926C-BBFC6CD5B532.html">TTLSMasterSecretInput</a> &amp;</td><td>aMasterSecretInput,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;</td><td>aKeyingMaterial</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[inline, virtual]</td></tr></table><div class="section"><div>
				<div class="p">This synchronous method provides the EAP string that is derived or computed from master secret key, "client key encryption" string (or any string from client), client and server hello random values. The EAP string returned would be of 128 + 64 bytes length. <dl class="precondition"><dt class="dlterm">Pre-condition</dt>
<dd>object should have been initialised (by call to InitL) and master secret generated (by call to ClientKeyExchange) before call to this method </dd>
</dl>
<dl class="postcondition"><dt class="dlterm">Post-condition</dt>
<dd>session is cached in case of successful handshake </dd>
</dl>
</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aLabel</td><td>Contains the string "client key encryption".  </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-C9E060E8-C4EC-324C-926C-BBFC6CD5B532.html">TTLSMasterSecretInput</a> &amp; aMasterSecretInput</td><td>The structure containing "Client and Server Random" binary data.  </td></tr><tr><td class="parameter"><a href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp; aKeyingMaterial</td><td>Contains the EAP 128 + 64 bytes string.  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-D1DD7B8C-0E8A-3B57-B122-05B46B01C8FE"><a name="GUID-D1DD7B8C-0E8A-3B57-B122-05B46B01C8FE"><!-- --></a>
		<h2 class="topictitle2">Label()</h2>
		<table class="signature"><tr><td>const <a href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td>Label</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table><div class="section"></div>

	</div>
<div class="nested1" id="GUID-466A8340-923F-3B2B-9951-704E5741B79E"><a name="GUID-466A8340-923F-3B2B-9951-704E5741B79E"><!-- --></a>
		<h2 class="topictitle2">PHash(const TDesC8 &amp;, HBufC8 *&amp;, const TPHashOp &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>PHash</td><td>(</td><td>const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>aInputData,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;</td><td>aOutput,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html">TPHashOp</a> &amp;</td><td>aOperation,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Used to generate the key material for security parameters used during bulk data encryption/decryption (server and client: keys, MAC secrets, IVs). The method is also to be used to calculate Finish Check. In case of TLS the calculations are done by TLS PRF which uses master secret, label and input string to generate hash. In case of SSL the calculations should be performed using algorithms specified in SSL3.0 specification. The type of operation to be performed is indicated by an aOperation argument of type: enum {EKeyBlockOp, EServerFinishedOp, EClientFinishedOp, ECertificateVerifyOp} TPHashOp. This enumerated type is defined within scope of <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html#GUID-6CC575F7-A779-319D-81B0-F4020DC1E169">MTLSSession</a> class. In case of keys generation, an aInputData parameter should be: TLS case: "key expansion" + server_random + client_random, SSL case: server_random + client_random. In case of Finish Check calculation aInputData should be: TLS case: "client finished" + MD5(handshake_messages) + SHA-1(handshake_messages), "server finished" + MD5(handshake_messages) + SHA-1(handshake_messages), SSL case: handshake_msgs + Sender.server, handshake_msgs + Sender.client (where Sender is defined as: enum { client(0x434C4E54), server(0x53525652) } Sender; - compare with specification for SSL3.0). Apart from the above cases the method should be used in SSL case for generation of hash for client's CertificateVerify message (the calculations require use of master secret). In the latter case aInputData parameter should be: handshake_msgs.</p>

				<div class="p">
					<dl class="precondition">
						
							<dt class="dlterm">Pre-condition</dt>

							<dd>master secret should have been generated before (by call to ClientKeyExchange) </dd>

						
					</dl>

				</div>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter">const <a href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp; aInputData</td><td>the data which is to be used as a seed for computations (master secret is concatenated with aInputData),  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp; aOutput</td><td>the result of the operation - key block (to be partitioned to required security parameters) or finish check (depending on the input) or certificte verify check  </td></tr><tr><td class="parameter">const <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html">TPHashOp</a> &amp; aOperation</td><td>this argument indicates a type of operation that the method should perform  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>asynchronous request status set on the completion  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-E1087C17-7399-372C-86CD-25EFA60D0797"><a name="GUID-E1087C17-7399-372C-86CD-25EFA60D0797"><!-- --></a>
		<h2 class="topictitle2">PHash(CMessageDigest *, CMessageDigest *, HBufC8 *&amp;, const TPHashOp &amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>PHash</td><td>(</td><td><a href="GUID-943C3D23-6BB5-3B7A-9AB5-99541596A32E.html">CMessageDigest</a> *</td><td>aMd5Digest,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-943C3D23-6BB5-3B7A-9AB5-99541596A32E.html">CMessageDigest</a> *</td><td>aShaDigest,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;</td><td>aOutput,</td></tr><tr><td colspan="3"> </td><td>const <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html">TPHashOp</a> &amp;</td><td>aOperation,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Used to generate Finished check or Certificate Verify check in SSL case. Thus the type of operation to be performed is indicated by an aOperation argument (of type TPHashOp) can be either: EServerFinishedOp or EClientFinishedOp or ECertificateVerifyOp. The method takes pointers to MD5 and SHA hashing objects updated before the call (but not finalized) with: handshake_msgs + Sender.server or handshake_msgs + Sender.client (in case of Finished check), or: handshake_msgs (in case of Certificate Verify check).</p>

				<p/>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-943C3D23-6BB5-3B7A-9AB5-99541596A32E.html">CMessageDigest</a> * aMd5Digest</td><td>the pointer to MD5 hashing object updated with appropriate input  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-943C3D23-6BB5-3B7A-9AB5-99541596A32E.html">CMessageDigest</a> * aShaDigest</td><td>the pointer to SHA hashing object updated with appropriate input  </td></tr><tr><td class="parameter"><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp; aOutput</td><td>the result of the operation - cleint or server finish check (depending on the input)  </td></tr><tr class="bg"><td class="parameter">const <a href="GUID-6CC575F7-A779-319D-81B0-F4020DC1E169.html">TPHashOp</a> &amp; aOperation</td><td>this argument indicates a type of operation that the method should perform  </td></tr><tr><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>asynchronous request status set on the completion  </td></tr></table></div>

	</div>
<div class="nested1" id="GUID-BB120E02-07CE-38E7-8C76-2974776855EB"><a name="GUID-BB120E02-07CE-38E7-8C76-2974776855EB"><!-- --></a>
		<h2 class="topictitle2">ServerCertificate(HBufC8 *&amp;, TRequestStatus &amp;)</h2>
		<table class="signature"><tr><td>void</td><td>ServerCertificate</td><td>(</td><td><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp;</td><td>aEncodedServerCert,</td></tr><tr><td colspan="3"> </td><td><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td>aStatus</td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table><div class="section"><div>
				<p>Used to retrieve server certificate from a session cache. The certificates may not be available if the token has no capability of storing server certificates.  </p>

			</div></div>
<div class="section parameters"><h3 class="sectiontitle">Parameters</h3><table border="0" class="parameters"><tr><td class="parameter"><a href="GUID-2A528453-0279-3E47-838C-F8A8D29B88F1.html">HBufC8</a> *&amp; aEncodedServerCert</td><td>encoded server certificate retrieved from cache, NULL if server certificate isn't stored in cache  </td></tr><tr class="bg"><td class="parameter"><a href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp; aStatus</td><td>asynchronous request status set on the completion  </td></tr></table></div>

	</div>
<h1 class="pageHeading topictitle1">Member Enumerations Documentation</h1><div class="nested1" id="GUID-9207DB75-C774-3462-A2D5-C24B5FC26DAF"><a name="GUID-9207DB75-C774-3462-A2D5-C24B5FC26DAF"><!-- --></a>
		<h2 class="topictitle2">Enum TPHashOp</h2>
		<div class="section"><div>
				<p>The enumeration used by PHash method in order to identify the type of operation to be performed.  </p>

			</div></div>
<div class="section enumerators"><h3 class="sectiontitle">Enumerators</h3><table border="0" class="enumerators"><tr><td valign="top">EKeyBlockOp</td><td>
							<p>Key block generation. </p>

						 </td></tr><tr class="bg"><td valign="top">EServerFinishedOp</td><td>
							<p>Calculations for Server Finished message. </p>

						 </td></tr><tr><td valign="top">EClientFinishedOp</td><td>
							<p>Calculations for Client Finished message. </p>

						 </td></tr><tr class="bg"><td valign="top">ECertificateVerifyOp</td><td>
							<p>Calculations for CertificateVerify message </p>

						 </td></tr></table></div>

	</div>

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>