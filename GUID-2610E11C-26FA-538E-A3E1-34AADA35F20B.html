<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Querying Databases: Basic"/>
<meta name="abstract" content="This tutorial shows you how to create a simple SQL database query."/>
<meta name="description" content="This tutorial shows you how to create a simple SQL database query."/>
<meta name="DC.Relation" scheme="URI" content="GUID-582CAA4A-1240-5138-983D-D9C6EEAF5566.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-868D5B32-1CC4-506E-9C49-C86428B9A50F.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-582CAA4A-1240-5138-983D-D9C6EEAF5566.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-22844C28-AB5B-5A6F-8863-7269464684B4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C2FCE726-FD87-52BF-8AF8-7F54FB6D6CB1.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Querying Databases: Basic</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2859821 id2860178 id2534422 id2534581 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html" title="Provides services to enable and support persistence.">Persistent Data Services Guide</a> &gt; <a href="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html" title="The persistent storage collection.">Persistent Storage</a> &gt; <a href="GUID-868D5B32-1CC4-506E-9C49-C86428B9A50F.html" title="The Symbian SQL component.">Symbian SQL</a> &gt; <a href="GUID-582CAA4A-1240-5138-983D-D9C6EEAF5566.html" title="These are the SQL tutorials.">SQL Tutorials</a> &gt; </div>
<h1 class="topictitle1">Querying Databases: Basic</h1>
<div><p>This tutorial shows you how to create a simple SQL database query. </p>
<div class="section" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-BEB231F7-8A23-5650-9933-EC3D030ABA32"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-BEB231F7-8A23-5650-9933-EC3D030ABA32"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>This tutorial shows you how to wrap a SQL query statement into an <a href="GUID-0176BF07-DF94-3259-8F90-DE030E35CE9A.html"><span class="apiname">RSqlStatement</span></a> object to query a database. </p>
 <p>This tutorial uses code from the <a href="GUID-C2FCE726-FD87-52BF-8AF8-7F54FB6D6CB1.html">Basic SQL example application</a>. </p>
 <p><strong>Assumptions </strong> </p>
 <p>You have a database. The database has no tables and therefore no data. </p>
 <p><strong>SQL statements </strong> </p>
 <p>The following SQL statements are used for this example: </p>
 <p><kbd class="userinput"><span class="cmdname">SELECT</span> <span class="parmname">person</span>  <span class="cmdname">FROM</span> <span class="parmname">Pets</span>  <span class="cmdname">WHERE</span>  <span class="parmname">cat
          &gt;= 1</span>  </kbd> </p>
 <p>The (<samp class="codeph">SELECT</samp>) results of the query will be the value in the '<samp class="codeph">name</samp>' column <samp class="codeph">FROM</samp> the '<samp class="codeph">countries</samp>' table <samp class="codeph">WHERE</samp> the value of the '<samp class="codeph">population</samp>' column of the same record is <samp class="codeph">&gt;</samp> the value specified. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Procedure</h2> <a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-457AA35E-0A23-5FAE-B69E-10D31F40F153"><!-- --></a><ol id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-457AA35E-0A23-5FAE-B69E-10D31F40F153"><li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-6C096309-F5A5-53AB-81E1-2E319D784FEF"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-6C096309-F5A5-53AB-81E1-2E319D784FEF"><!-- --></a><p>Prepare the statement: </p>
 <p>The steps to prepare a SQL statement are shown here. </p>
 <a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-6E19F9B5-92DC-50C4-9A93-1DC9E10EFECB"><!-- --></a><ol type="a" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-6E19F9B5-92DC-50C4-9A93-1DC9E10EFECB"><li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-F28F700F-1D43-5A44-8C01-A117048A6372"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-F28F700F-1D43-5A44-8C01-A117048A6372"><!-- --></a><p>Set up some constants used by the SQL statement object to define the SQL query: </p>
 <div class="p"><pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-55464913-80C8-57C1-9973-34F11ED2CFF3"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-55464913-80C8-57C1-9973-34F11ED2CFF3"><!-- --></a>_LIT(KSelect1,"SELECT person FROM Pets WHERE cat &gt;= 1;");</pre>
 </div>
 <p>This defines the query parameters. </p>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-5B15A001-4355-5422-88D5-DF457B3F069C"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-5B15A001-4355-5422-88D5-DF457B3F069C"><!-- --></a><p>Instantiate the <a href="GUID-0176BF07-DF94-3259-8F90-DE030E35CE9A.html"><span class="apiname">RSqlStatement</span></a> SQL statement: </p>
 <div class="p"><pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-B1C94AEC-EF3B-5447-9D75-5C382EB19302"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-B1C94AEC-EF3B-5447-9D75-5C382EB19302"><!-- --></a>RSqlStatement stmt;</pre>
 </div>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-A8E185AC-0402-5B62-ABDE-7667E7396621"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-A8E185AC-0402-5B62-ABDE-7667E7396621"><!-- --></a><p>Prepare the statement: </p>
 <div class="p"><pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-20A9CAD8-5015-5404-864B-4BF471284D44"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-20A9CAD8-5015-5404-864B-4BF471284D44"><!-- --></a>User::LeaveIfError(stmt.Prepare(iPetDb, aStatement));</pre>
 </div>
 <p>Creates a parameterised SQL statement executable. </p>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-28D8E6CC-5A85-5422-9F6E-F4EAA5D80491"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-28D8E6CC-5A85-5422-9F6E-F4EAA5D80491"><!-- --></a><p>Define the indices to be used in the search: </p>
 <div class="p"><pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-ECF6DD48-2E8B-5A70-B712-2465E2132A20"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-ECF6DD48-2E8B-5A70-B712-2465E2132A20"><!-- --></a>    TInt personIndex = stmt.ColumnIndex(KPerson);</pre>
 </div>
 </li>
 </ol>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-7D9C68FB-A9A3-5FBF-A1F4-B2C900680E62"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-7D9C68FB-A9A3-5FBF-A1F4-B2C900680E62"><!-- --></a><p>Execute the SQL query: </p>
 <p>The Symbian SQL statement is executed by <a href="GUID-0176BF07-DF94-3259-8F90-DE030E35CE9A.html"><span class="apiname">RSqlStatement::Next()</span></a>. </p>
 <a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-FD6241DB-56D3-5F28-8CA7-ECC8A527F3F8"><!-- --></a><ol type="a" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-FD6241DB-56D3-5F28-8CA7-ECC8A527F3F8"><li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-71EC4F86-F462-5C20-82FA-331FF215A25C"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-71EC4F86-F462-5C20-82FA-331FF215A25C"><!-- --></a><p>Search the records until a match is found: </p>
 <div class="p"><pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-4617F6D8-D138-5123-8E61-ADC0B9CF1DDA"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-4617F6D8-D138-5123-8E61-ADC0B9CF1DDA"><!-- --></a>TInt rc = KErrNone;
while ((rc = stmt.Next()) == KSqlAtRow)</pre>
 </div>
 <p> <samp class="codeph">Next()</samp> fires the executable SQL statement and stops at and returns the matched record. </p>
 </li>
 </ol>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-D142E6BD-1FF7-514E-A33E-DA87112AABC6"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-D142E6BD-1FF7-514E-A33E-DA87112AABC6"><!-- --></a><p>Do something with the results: </p>
 <p>The query is done and you have the results. In this section we look at a simple way to do something with the results and we close the SQL statement object. </p>
 <a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-19CF868B-5957-5D68-8E7F-352F924C0426"><!-- --></a><ol type="a" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-19CF868B-5957-5D68-8E7F-352F924C0426"><li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-21B13AF8-6052-55B1-9CD0-E0BD8783473A"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-21B13AF8-6052-55B1-9CD0-E0BD8783473A"><!-- --></a><p>Get and use the results of the search: </p>
 <div class="p"><pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-8A2DFE0B-78AB-5D90-B175-05DCAD3965D2"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-8A2DFE0B-78AB-5D90-B175-05DCAD3965D2"><!-- --></a>...
{
TPtrC myData = stmt.ColumnTextL(personIndex);
iConsole-&gt;Printf(_L("Person=%S\n"), &amp;myData);
}</pre>
 </div>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-9EECD8B4-F9D2-5D27-A1C3-32C7337AF8E0"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-9EECD8B4-F9D2-5D27-A1C3-32C7337AF8E0"><!-- --></a><p>Close the SQL search statement: </p>
 <div class="p"><pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-121F21FE-0D85-5F13-8D57-0D9B84ECA22E"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-121F21FE-0D85-5F13-8D57-0D9B84ECA22E"><!-- --></a>err = myStatement.Close(); </pre>
 </div>
 <p>When the database search is finished the object should be closed to free up resources. </p>
 </li>
 </ol>
 </li>
 </ol>
 </div>
 <div class="section" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-CDF77F9C-9ACB-529B-B902-0548E91A026E"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-CDF77F9C-9ACB-529B-B902-0548E91A026E"><!-- --></a><h2 class="sectiontitle">Results</h2> <p>The tutorial has demonstrated how to query a Symbian SQL database. Looking through the example application you can work out how easily the query can be changed to meet specific requirements and how the results can be used in different ways. </p>
 </div>
 <div class="example" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-8DB8048D-082A-51C2-882E-6250D5B3B2D0"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-8DB8048D-082A-51C2-882E-6250D5B3B2D0"><!-- --></a><h2 class="sectiontitle">Querying example</h2> <p>The following code snippet is from the basic example application. </p>
 <pre class="codeblock" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-D2EE1100-6199-5313-B8C5-49CA1AC9C2FD"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-D2EE1100-6199-5313-B8C5-49CA1AC9C2FD"><!-- --></a>...
...
RSqlStatement stmt;
iConsole-&gt;Printf(_L("Running Query:\n%S\n"), &amp;aStatement);
user::LeaveIfError(stmt.Prepare(iPetDb, aStatement));
CleanupClosePushL(stmt);
TInt personIndex = stmt.ColumnIndex(KPerson);
TInt rc = KErrNone;
while ((rc = stmt.Next()) == KSqlAtRow)
  {
  // Do something with the results 
  TPtrC myData = stmt.ColumnTextL(personIndex); // read return data
  iConsole-&gt;Printf(_L("Person=%S\n"), &amp;myData);
  }
if (rc != KSqlAtEnd)
  {
  _LIT(KErrSQLError, "Error %d returned from RSqlStatement::Next().");
  iConsole-&gt;Printf(KErrSQLError, rc);
  }
  ...
  CleanupStack::PopAndDestroy(1);
}</pre>
 </div>
 <div class="section" id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-8F3A39B6-6514-5A48-BE2E-7893D7625A9C-GENID-1-12-1-27-1-1-6-1-1-9-1-8-1-7-1-3-5"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-8F3A39B6-6514-5A48-BE2E-7893D7625A9C-GENID-1-12-1-27-1-1-6-1-1-9-1-8-1-7-1-3-5"><!-- --></a><p>Now that you have performed a basic database query you can start thinking about more advanced querying options. The following will show you how: </p>
 <ul><li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-D2CD5BB5-C085-56F0-B834-7515447CD661"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-D2CD5BB5-C085-56F0-B834-7515447CD661"><!-- --></a><p> <a href="GUID-72511204-FC90-54AA-9E2E-833318020318.html">Reading to a buffer</a>  </p>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-B147074E-B791-592E-99C3-474AA5D217F6"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-B147074E-B791-592E-99C3-474AA5D217F6"><!-- --></a><p> <a href="GUID-3CCA6503-54DA-5558-85DC-93A22A81F565.html" title="This tutorial describes how to copy data from the table to a memory location.">Reading to memory</a>  </p>
 </li>
 <li id="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-029878E1-AAD9-5E1A-B696-67BD3C0D905F"><a name="GUID-2610E11C-26FA-538E-A3E1-34AADA35F20B__GUID-029878E1-AAD9-5E1A-B696-67BD3C0D905F"><!-- --></a><p> <a href="GUID-183280EE-0C57-54FE-8ABB-E1CC3BDE525B.html">Reading to a data stream</a>  </p>
 </li>
 </ul>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-582CAA4A-1240-5138-983D-D9C6EEAF5566.html" title="These are the SQL tutorials.">SQL Tutorials</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-22844C28-AB5B-5A6F-8863-7269464684B4.html" title="This document introduces you to the Symbian platform implementation of the Structured Query Language(SQL).">SQL Overview</a></div>
<div><a href="GUID-C2FCE726-FD87-52BF-8AF8-7F54FB6D6CB1.html">Basic SQL Example
                Application</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>