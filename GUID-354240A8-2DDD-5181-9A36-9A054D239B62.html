<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Video Subtitle CRP Support From MMF Tutorial"/>
<meta name="DC.Relation" scheme="URI" content="GUID-412CB101-A92C-54E1-9518-79E94DD40A08.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-97F83011-BE3C-512C-9599-028CBB92BD51.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-412CB101-A92C-54E1-9518-79E94DD40A08.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A9803A57-BB43-53F3-97BA-3B5E91D925F0.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A4354C8C-2A00-50C1-8DC6-6CE748BC01EB.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-354240A8-2DDD-5181-9A36-9A054D239B62"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Video Subtitle CRP Support From MMF Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2405098 id2396821 id2396986 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html">Multimedia Guide</a> &gt; <a href="GUID-97F83011-BE3C-512C-9599-028CBB92BD51.html" title="The Multimedia Plug-ins collection facilitates a plug-in framework to handle the Multimedia audio, video and image data.">Multimedia Plug-ins Collection</a> &gt; <a href="GUID-412CB101-A92C-54E1-9518-79E94DD40A08.html">Video Subtitle CRP Component</a> &gt; </div>
<h1 class="topictitle1">Video Subtitle CRP Support From MMF Tutorial</h1>
<div><p>This tutorial describes about enhancing MMF Controller to Support Video Subtitle CRP. </p>
 <p> </p>
 <div class="section"><h2 class="sectiontitle">Purpose</h2> <p>The purpose of this tutorial is to show you how to enhance MMF Controller to support Video Subtitle CRP. </p>
 <p><strong>Required Background</strong> </p>
 <p> <a href="GUID-42D1182F-46D8-3C78-8D3C-C1BB465FCA1F.html"><span class="apiname">CVideoPlayerUtility2</span></a> and multimedia framework are extended to support the Video Subtitle CRP functionality. <a href="GUID-0F1F8AC6-B99F-3274-A785-9977197AF762.html"><span class="apiname">CVideoPlayerUtility</span></a> is not extended because subtitle support requires <a href="GUID-ADA8CECB-0E70-5B9C-8F36-0714AAF0CD13.html" title="This topic provides an introduction to graphics composition surfaces, which are usually simply called surfaces. Surfaces are pixel buffers that have associated metadata describing the width, height, stride and pixel format and are used as input to the composition components. Surfaces can be multi-buffered and are identified by a 128-bit identifier (called the surface ID).">graphics surfaces</a> support which may not be present when <a href="GUID-164490D2-7622-3B09-9EF6-9F463C0796AC.html"><span class="apiname">CVideoPlayerUtiltiy</span></a> is used. </p>
 <p><strong>Introduction</strong> </p>
 <p>In Video Player Controller <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor</span></a> and <a href="GUID-4905EA66-9185-3A48-8D00-3ADBFE3F7A9C.html"><span class="apiname">CMMFVideoPlaySubtitleSupportCustomCommandParser</span></a> classes are registered to allow Video Client API to use Video Subtitle CRP. </p>
 <p>For information about the architectural relationship between Video Player Controller, Subtitle Decoder and Render; and Video Subtitle CRP see the <a href="GUID-80E8BA3A-FDF3-50A5-BF44-181C40C31F09.html#GUID-80E8BA3A-FDF3-50A5-BF44-181C40C31F09__GUID-845818F1-02CA-59FE-85F8-22623880759D">Video Subtitle CRP Overview-Architectural Relationship</a> session. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Using to support Video Subtitle CRP for MMF </h2> <p>The following task is covered in this tutorial: </p>
 <ul><li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-9B4AD645-7BC2-5B80-A1C9-CE65FC88DBAA"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-9B4AD645-7BC2-5B80-A1C9-CE65FC88DBAA"><!-- --></a><p><a href="GUID-354240A8-2DDD-5181-9A36-9A054D239B62.html#GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-8E71E2E4-6FB4-5AB2-997C-F6018427C425">How to enhance MMF Controller to support Video Subtitle CRP</a>  </p>
 </li>
 </ul>
 <p id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-8E71E2E4-6FB4-5AB2-997C-F6018427C425"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-8E71E2E4-6FB4-5AB2-997C-F6018427C425"><!-- --></a><strong>Basic Procedure</strong> </p>
 <p>The high-level steps to implement Video Subtitle CRP in MMF Controller are shown here: </p>
 <ul><li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-B9761E39-BC47-558E-82FB-43E89309C2F4"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-B9761E39-BC47-558E-82FB-43E89309C2F4"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-633D92A6-786D-32ED-B311-4C1975A832D1"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusGetSubtitlesAvailableL(TBool&amp;
                  )</span></a> to check if a subtitle source is available for an opened video source. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-3AC95E6E-5B51-52CB-A4A9-650E2ABF30C1"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-3AC95E6E-5B51-52CB-A4A9-650E2ABF30C1"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-10C9057C-7E06-335D-9860-7199A9A935DD"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusEnableSubtitlesL()</span></a> to enable subtitle support. </p>
 <p>The enable subtitle function involves checking if a subtitle source is available and loading the corresponding subtitle decoder. If this function is called during video playback, the subtitle must be displayed when all the required components (such as Subtitle Decoder and Video Subtitle CRP) are ready. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-C75C1ECF-1402-5C6B-8D6C-8D7EDFCB5BA2"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-C75C1ECF-1402-5C6B-8D6C-8D7EDFCB5BA2"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-1B56C375-2236-3488-9B77-4A5821798168"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusDisableSubtitlesL()</span></a> to disable subtitle support. </p>
 <p>The disable subtitle function involves stopping the subtitle display, unloading the subtitle decoder, and closing the subtitle source if the source is separate from the video source. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-D617586D-E528-5DE8-8920-243161B49DAB"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-D617586D-E528-5DE8-8920-243161B49DAB"><!-- --></a><p>If languages selection is supported in the subtitle source: </p>
 <a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-BD0BAF46-DDF7-5498-B05A-156C115B4EAB"><!-- --></a><ol id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-BD0BAF46-DDF7-5498-B05A-156C115B4EAB"><li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-ED27DF2B-09BF-5324-8A95-EB74A7FC5AC6"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-ED27DF2B-09BF-5324-8A95-EB74A7FC5AC6"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-B8B73319-D5CB-3370-A828-6A4903A6C86E"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusGetSupportedSubtitleLanguagesL(RArray&lt;TLanguage&gt;&amp;
                        )</span></a> to get a list of supported languages that are available in the selected subtitle source. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-18D50682-DF82-50F6-AE9E-299E111FE6D8"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-18D50682-DF82-50F6-AE9E-299E111FE6D8"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-D2CD472D-DCBB-3A7B-9D1E-BCED722BFADE"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusSetSubtitleLanguageL(TLanguage
                        )</span></a> to set the current subtitle language. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-2DAFA0C8-9464-5A4F-8548-23F0DCA77499"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-2DAFA0C8-9464-5A4F-8548-23F0DCA77499"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-B3CC4815-2030-3FB4-8C41-FF9C2D981C12"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusGetSubtitleLanguageL(TLanguage&amp;
                        )</span></a> to return the current subtitle language selected. </p>
 </li>
 </ol>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-2E45DBA4-2AB1-5872-B435-69081BE21DB4"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-2E45DBA4-2AB1-5872-B435-69081BE21DB4"><!-- --></a><p>The subtitle configuration data for a window is passed to MMF controller by the <a href="GUID-014F48C6-EA09-36BA-A2ED-B45BA128A6EC.html"><span class="apiname">TMMFSubtitleWindowConfig</span></a> class. <samp class="codeph">TMMFSubtitleWindowConfig</samp> is used to send the subtitle window client configuration to Video Player Controller. </p>
 <p>The subtitle client window configuration is given to Video Player Controller so that the properties of the subtitle artwork CRP can be calculated for each window using the window identity as an identifier. The window clip rectangle can be used to calculate the subtitle region (for example, the subtitle region can be restricted to the bottom one-third of the display area ). The rotation value indicates the angle at which the subtitle text should be rotated such that the text is displayed in the same angle as the video. The <samp class="codeph">TMMFSubtitleWindowConfig</samp> class is shown in the code below: </p>
 <pre class="codeblock" id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-A936EF7E-781D-5FF1-A24A-6C28AEEF7B7E"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-A936EF7E-781D-5FF1-A24A-6C28AEEF7B7E"><!-- --></a>

 class TMMFSubtitleWindowConfig
    {
  public:
     /** Window unique identifier */
     TInt iWindowId; 
     /** Video window clip rectangle */
     TRect iWindowClipRect;
     /** Video window display mode */
     TDisplayMode iDisplayMode;
     /** Video rotation angle */
     TVideoRotation iRotation;
 }

</pre>
 <ul><li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-72726FC6-AF9B-5F20-B353-FEA69429196B"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-72726FC6-AF9B-5F20-B353-FEA69429196B"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-B3A167EE-FA21-308F-9AF7-463657EA7035"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusAddSubtitleConfigL(const
                        TMMFSubtitleWindowConfig)</span></a> to add subtitle configuration data for a window when subtitles are enabled. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-E6444516-E776-52E4-BBFC-5836A95DF74B"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-E6444516-E776-52E4-BBFC-5836A95DF74B"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-572D4F35-09B0-39B3-B06A-EAA5A8426778"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusUpdateSubtitleConfigL(const
                        TMMFSubtitleWindowConfig) </span></a> to update when any of the window configuration values are changed for a window. For example, the update function can be called during video playback if the rotation setting is changed. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-81DBAA0F-0338-590B-AA0B-3BC4CA28F289"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-81DBAA0F-0338-590B-AA0B-3BC4CA28F289"><!-- --></a><p>Implement <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-11966D68-114C-3034-8A71-4C5ECC7E49C0"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusRemoveSubtitleConfigL()</span></a> to remove window configuration when subtitles are disabled. </p>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-BE488713-AE93-5EE4-BADB-7935B2FDEA9C"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-BE488713-AE93-5EE4-BADB-7935B2FDEA9C"><!-- --></a><p>When the CRP for an added window or an updated window is ready for display, Video Player Controller sends <a href="GUID-D60E4CF8-EAD8-3E32-8CFE-967C0131CC82.html"><span class="apiname">KMMFEventCategoryVideoSubtitleCrpReady</span></a> with the corresponding window identity to Video Client. The window identity is passed by the error code to Video Client: </p>
 <pre class="codeblock" id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-EFB08910-6B9F-526B-9428-EC085D387E75"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-EFB08910-6B9F-526B-9428-EC085D387E75"><!-- --></a>
const TUid KMMFEventCategoryVideoSubtitleCrpReady = {0x10285C9E};
</pre>
 </li>
 <li id="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-E6B62291-1840-54E7-9E53-D4030AE13552"><a name="GUID-354240A8-2DDD-5181-9A36-9A054D239B62__GUID-E6B62291-1840-54E7-9E53-D4030AE13552"><!-- --></a><p>After the <samp class="codeph">KMMFEventCategoryVideoSubtitleCrpReady</samp> identifier is sent to the Video Client, the <a href="GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A.html#GUID-54D2B15E-E40D-3C65-91BB-2BFEF708FD2A__GUID-6B92F4F8-9D7A-377C-97B9-BF8EBDE1B211"><span class="apiname">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusGetCrpParametersL()</span></a> function is called by MMF Framework to retrieve the Video Subtitle CRP parameters from MMF Controller. </p>
 <p>The Video Subtitle CRP graphic identity is returned by the <samp class="codeph">MMMFVideoPlaySubtitleSupportCustomCommandImplementor::MvpsusGetCrpParametersL()</samp> function. The Video Subtitle CRP graphic identity is used by the Video Client to send draw request to Window Server. For more information about the graphic identity see the <a href="GUID-A4354C8C-2A00-50C1-8DC6-6CE748BC01EB.html">Using Subtitle Graphic</a> tutorial. </p>
 </li>
 </ul>
 </li>
 </ul>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-412CB101-A92C-54E1-9518-79E94DD40A08.html">Video Subtitle CRP Component</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-A9803A57-BB43-53F3-97BA-3B5E91D925F0.html">Subtitle Graphic Library
                Overview</a></div>
<div><a href="GUID-A4354C8C-2A00-50C1-8DC6-6CE748BC01EB.html"> Using Subtitle
                Graphic</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>