<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Central Repository Data Access Tutorial"/>
<meta name="abstract" content="This tutorial describes how to access and modify the data in Central Repository at run time on the Symbian platform."/>
<meta name="description" content="This tutorial describes how to access and modify the data in Central Repository at run time on the Symbian platform."/>
<meta name="DC.Relation" scheme="URI" content="GUID-50BA6AEB-E968-5CCA-8F5D-A65969263D90.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-50BA6AEB-E968-5CCA-8F5D-A65969263D90.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-AA5DEEB2-0B13-5FA8-8494-EC2F5C654FEF.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Central Repository Data Access Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2859821 id2860178 id2860209 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-FBCBF8A0-7922-5881-A1C5-5DB41630E75A.html" title="Provides services to enable and support persistence.">Persistent Data Services Guide</a> &gt; <a href="GUID-F8824165-4B33-50D1-9706-BD2438B5A2EE.html" title="The persistent storage collection.">Persistent Storage</a> &gt; <a href="GUID-50BA6AEB-E968-5CCA-8F5D-A65969263D90.html" title="Provides persistance for application data, such as default filenames, locale settings and user preferences, between sessions.">Central Repository</a> &gt; </div>
<h1 class="topictitle1">Central Repository Data Access Tutorial</h1>
<div><p>This tutorial describes how to access and modify the data in Central Repository at run time on the Symbian platform. </p>
 <div class="p" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-04C96E61-FBDE-5A4E-AAD9-75FF4BB80531"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-04C96E61-FBDE-5A4E-AAD9-75FF4BB80531"><!-- --></a><p>Before you start, you must: </p>
 <ul><li id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-5B3953CA-CFC3-52D9-8177-9D08EC7CEF87"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-5B3953CA-CFC3-52D9-8177-9D08EC7CEF87"><!-- --></a><p>understand the <a href="GUID-CBC57511-7F28-596A-9763-5674EB41BCAC.html" title="The Central Repository stores data such as application settings, component settings, configuration parameters and data used for localisation and customisation.">Central Repository</a>  </p>
 </li>
 <li id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-B2FFA28E-192F-5982-A331-557D8228BF4A"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-B2FFA28E-192F-5982-A331-557D8228BF4A"><!-- --></a><p>know how to <a href="GUID-E3BE62B2-9625-5F79-84A4-0248A3F36225.html" title="This section describes how to make an application read and modify a repository at runtime from function calls in its application code.">register and use the repositories</a> in the Central Repository </p>
 </li>
 </ul>
 </div>
 <div class="section" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-58A8A8B0-EAFA-5AEB-B978-10048CE3B821"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-58A8A8B0-EAFA-5AEB-B978-10048CE3B821"><!-- --></a><p>Repositories cannot be created at runtime. Applications must register with Central Repository using the initialisation file. The Central Repository API is provided by the <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">CRepository</span></a> class. Applications access the repository with the UID of the repository. Applications must have appropriate access to the repositories. </p>
 </div>
 <a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-6E0FE2B1-5AAD-5B2C-B304-6DDCFE312B6A"><!-- --></a><ol id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-6E0FE2B1-5AAD-5B2C-B304-6DDCFE312B6A"><li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-5F2291E4-C723-5F10-BBCC-0FF996DE8201"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-5F2291E4-C723-5F10-BBCC-0FF996DE8201"><!-- --></a><span> Open a repository</span>  <p>The repositories are identified by a <samp class="codeph">UID</samp>. To access the data in the Central Repository create a new <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">CRepository</span></a> object with the <samp class="codeph">UID</samp> of the repository. </p>
   <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A3E4A9D4-FFD0-56A3-944F-FE40B0978CD2"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A3E4A9D4-FFD0-56A3-944F-FE40B0978CD2"><!-- --></a>CRepository* repository = CRepository::NewL(KMyRepositoryUid);</pre>
   One <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">CRepository</span></a> object must be created for each repository.  </li>
<li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-B986A80F-A665-563D-9B73-AA60DD6BE395"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-B986A80F-A665-563D-9B73-AA60DD6BE395"><!-- --></a><span> Retrieve data from the repository</span>  <p>The data can be retrieved by using <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Get()</span></a> or <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Find()</span></a> functions of the <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">CRepository</span></a> class. </p>
  <a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-610E555C-C29C-59D4-8931-4E1085943D09"><!-- --></a><ol type="a" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-610E555C-C29C-59D4-8931-4E1085943D09"><li class="substepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A7BE9113-5ECE-575B-A6F5-2AB183DE7774"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A7BE9113-5ECE-575B-A6F5-2AB183DE7774"><!-- --></a><span/><br/> Use <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Get()</span></a> to retrieve an individual value   <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-11D2654B-688C-5A1C-916F-413469360511"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-11D2654B-688C-5A1C-916F-413469360511"><!-- --></a>TInt Get(TUint32 aKey, TInt&amp; aVal);    </pre>
  </li>
 <li class="substepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-D965F3C6-AAC0-5738-AB6B-9632AD7BA0E4"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-D965F3C6-AAC0-5738-AB6B-9632AD7BA0E4"><!-- --></a><span/><br/> Use <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Find()</span></a> function to retrieve the values by passing a range of keys   The input parameters are a partial key and a key mask and the function returns all the settings that match the input range.   <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-33F36B37-9305-5244-B704-CE09067BAE24"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-33F36B37-9305-5244-B704-CE09067BAE24"><!-- --></a>TInt FindL(TUint32 aPartialKey, TUint32 aKeyMask, RArray&lt;TUint32&gt;&amp; aFoundKeys);</pre>
    <samp class="codeph">aKey</samp> parameter represents a setting in a 32 bit unsigned integer and <samp class="codeph">aVal</samp> represents the corresponding value of the setting.  </li>
 </ol>
 </li>
<li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A916E538-CF26-512C-B47E-8A0AFF2AFD93"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A916E538-CF26-512C-B47E-8A0AFF2AFD93"><!-- --></a><span>Modify the data of the repository
                  opened</span>  <p>The <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Set()</span></a> functions of the <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">CRepository</span></a> class allows the applications to modify the data in the Central Repository. </p>
   Set new values using <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Set()</span></a>    <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-75CEFCF2-8EDA-5601-831B-FD183434223F"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-75CEFCF2-8EDA-5601-831B-FD183434223F"><!-- --></a>
TInt Set(TUint32 aKey, TInt aVal);
</pre>
  </li>
<li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-54F13AB8-9276-5B96-9355-2D8A5ADF5315"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-54F13AB8-9276-5B96-9355-2D8A5ADF5315"><!-- --></a><span/><br/>   Read the metadata of the repository   <a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-C7CCC06D-A51A-504E-9B48-9568BF9183DB"><!-- --></a><ol type="a" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-C7CCC06D-A51A-504E-9B48-9568BF9183DB"><li class="substepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-AD5DE28B-4C8E-5F24-BDED-9C2528D0BAE5"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-AD5DE28B-4C8E-5F24-BDED-9C2528D0BAE5"><!-- --></a><span/><br/> Use <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">GetMeta()</span></a> to get the metadata of the repository.   The eight most significant bits are reserved for internal purpose and clients must not use these values. The value of the reserved bits may change for each <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">GetMeta()</span></a> call.  </li>
 <li class="substepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-21F48A2A-F372-5ABF-B067-80D34527D667"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-21F48A2A-F372-5ABF-B067-80D34527D667"><!-- --></a><span/><br/> Applications must use logical AND function with the retun value of <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">GetMeta()</span></a> and the constant <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">KMetaUnreserved</span></a> to retrieve the user bits of the metadata.   The constant <samp class="codeph">KMetaUnreserved</samp> is defined in <samp class="codeph">centralrepository.h</samp>.  </li>
 </ol>
  <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-AD43EA8A-0808-5F4B-9A92-E2FC84818A59"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-AD43EA8A-0808-5F4B-9A92-E2FC84818A59"><!-- --></a>TInt GetMeta(TUint32 aKey, TUint32&amp; aMeta);</pre>
  </li>
<li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-92638DAF-1888-5D21-8607-E159637193D5"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-92638DAF-1888-5D21-8607-E159637193D5"><!-- --></a><span> Add a new setting</span>  <p>To add a new setting in the repository use <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Create()</span></a>. </p>
   <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-BC3684ED-9898-5AEF-BE12-E9A0FE8DFFF2"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-BC3684ED-9898-5AEF-BE12-E9A0FE8DFFF2"><!-- --></a>TInt Create(TUint32 aKey, TInt aVal);</pre>
   To delete an existing setting use <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Delete()</span></a>    <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-CE998E02-C44A-525B-8CE1-97EFF2585848"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-CE998E02-C44A-525B-8CE1-97EFF2585848"><!-- --></a>TInt Delete(TUint32 aKey);</pre>
  </li>
<li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-47F70785-7460-5052-85F4-C63CC042F77D"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-47F70785-7460-5052-85F4-C63CC042F77D"><!-- --></a><span>Move settings</span>  <p>To move one or more settings from one key to another key use <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Move()</span></a>  </p>
   <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-37DBA666-26C1-544D-9DC9-0B591A2DA9F0"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-37DBA666-26C1-544D-9DC9-0B591A2DA9F0"><!-- --></a>TInt Move (TUint32 aSourcePartialKey, TUint32 aTargetPartialKey, TUint32 aMask, TUint32 &amp;aErrorKey) ;</pre>
   The source key, target key and the partial mask must be provided by the clients.  </li>
<li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-90C11E03-6017-502C-A569-FDE22C18B753"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-90C11E03-6017-502C-A569-FDE22C18B753"><!-- --></a><span/><br/>  Reset the settings   <a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-749BC68F-C733-5571-8086-E0B9F6E370A8"><!-- --></a><ol type="a" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-749BC68F-C733-5571-8086-E0B9F6E370A8"><li class="substepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-AE2FCCFC-5E47-5511-917A-4B6F2A5CDDEC"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-AE2FCCFC-5E47-5511-917A-4B6F2A5CDDEC"><!-- --></a><span/><br/> To reset the settings of a repository to the default values use <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Reset()</span></a>    <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-0F53ECD1-8985-500B-B726-CD85B1ACAF55"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-0F53ECD1-8985-500B-B726-CD85B1ACAF55"><!-- --></a>TInt Reset();</pre>
  </li>
 <li class="substepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-5B520C2F-5742-5053-B880-A1333A7A02A2"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-5B520C2F-5742-5053-B880-A1333A7A02A2"><!-- --></a><span/><br/> To reset a particular setting, pass the key of the setting as a parameter to the <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">Reset()</span></a> function.   <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-7D9928C4-5769-555A-A896-2A1F4DD61B99"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-7D9928C4-5769-555A-A896-2A1F4DD61B99"><!-- --></a>TInt Reset(TUint32 aKey);</pre>
   Go back to step 2 if you want to modify the settings after a reset or continue to step 8  </li>
 </ol>
 </li>
<li class="stepexpand" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A7CEAD38-A92E-5A06-AC16-8FC91BD6CDF7"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-A7CEAD38-A92E-5A06-AC16-8FC91BD6CDF7"><!-- --></a><span> Close the repository</span>  <p>To close repository, use delete. </p>
   <pre class="codeblock" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-ED364F0C-0267-55FC-8600-885FFABADBB6"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-ED364F0C-0267-55FC-8600-885FFABADBB6"><!-- --></a>delete repository;
</pre>
   Each instance of the <a href="GUID-DEA618DF-D462-3B3E-A1E1-F21295AAFE78.html"><span class="apiname">CRepository</span></a> object must be deleted to clean up the resources.  </li>
</ol>
 <div class="section" id="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-6A19D562-87BE-5BAA-A523-4C7B0CC4C01F"><a name="GUID-277BD68B-70CF-5798-A77D-E2B901FA613B__GUID-6A19D562-87BE-5BAA-A523-4C7B0CC4C01F"><!-- --></a><p>The data in a repository will be modified with the new values by the application. </p>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-50BA6AEB-E968-5CCA-8F5D-A65969263D90.html" title="Provides persistance for application data, such as default filenames, locale settings and user preferences, between sessions.">Central Repository</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-AA5DEEB2-0B13-5FA8-8494-EC2F5C654FEF.html" title="This example application demonstrates the usage of Central Repository API for persistent storage.">CentRepExample: Using central repository for
                persistent storage</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>