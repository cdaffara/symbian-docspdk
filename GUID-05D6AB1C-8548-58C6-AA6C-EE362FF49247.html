<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Bitmap Animation Overview"/>
<meta name="DC.Relation" scheme="URI" content="GUID-26FC16BB-47D8-5DF6-9ABE-07526286597A.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-94005A46-B4C6-4A30-A8E8-1B9C2D583D50.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E079315A-E5B6-4D33-B7E3-88697A3F11A4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-26FC16BB-47D8-5DF6-9ABE-07526286597A.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Bitmap Animation Overview</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2561792 id2839629 id2839588 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-94005A46-B4C6-4A30-A8E8-1B9C2D583D50.html">Classic UI Guide</a> &gt; <a href="GUID-E079315A-E5B6-4D33-B7E3-88697A3F11A4.html">Control and animation framework</a> &gt; <a href="GUID-26FC16BB-47D8-5DF6-9ABE-07526286597A.html" title="The section explain how to create animations using Bitmap Animation framework.">Bitmap Animation</a> &gt; </div>
<h1 class="topictitle1">Bitmap
Animation Overview</h1>
<div>
<div class="section" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-44C21503-6654-4590-996F-969D5B8B6869"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-44C21503-6654-4590-996F-969D5B8B6869"><!-- --></a><h2 class="sectiontitle">Purpose</h2> <p>This document shows you how to create an
animation using the Bitmap Animation framework. </p>
 </div>

<div class="section" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-3968A450-B383-4F55-A89D-817908FD67BE"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-3968A450-B383-4F55-A89D-817908FD67BE"><!-- --></a><h2 class="sectiontitle">Architectural relationships</h2> <p>The Bitmap Animation
framework (<span class="filepath">bmpanim.dll</span>) uses the font and bitmap server
(<span class="filepath">fbscli.dll</span>) to provide the bitmap images (<a href="GUID-683A1D42-2764-3EB7-BD19-9E12559199AB.html"><span class="apiname">CFbsBitmap</span></a> s). </p>
 <p>An
animation DLL (<span class="filepath">bmpansrv.dll</span>), loaded by the Window Server,
is used to perform the animation. </p>
 <p>The animation DLL uses the bitgdi
component (<span class="filepath">bitgdi.dll</span>) to draw the bitmaps. </p>
 </div>

<div class="section" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-0CE251DB-D48D-43D2-AF0D-420D7AAF6414"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-0CE251DB-D48D-43D2-AF0D-420D7AAF6414"><!-- --></a><h2 class="sectiontitle">Description</h2> <p>To use a bitmap animation in your application
you need to: </p>
 <ul>
<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-F6367722-F765-550C-8B85-65FFEA38369A"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-F6367722-F765-550C-8B85-65FFEA38369A"><!-- --></a><p>define one or more animation
frames, each of which owns a bitmap, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7B1EB74D-0057-52D6-8560-A96A301F0ED3"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7B1EB74D-0057-52D6-8560-A96A301F0ED3"><!-- --></a><p>assign the frames to
an animation container, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-4C005026-80CE-59B4-A9EE-DAFD2EB71DFA"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-4C005026-80CE-59B4-A9EE-DAFD2EB71DFA"><!-- --></a><p>create an animation
player object and pass the animation container to it. This communicates with
the window server to start and stop playing the animation inside a window. </p>
 </li>

</ul>
 <p>Collectively, these steps make up the Bitmap Animation framework.
The key client side classes that are involved in these steps are: </p>
 <ul>
<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-64D5B1E5-7FDD-5AD1-BD0F-906D27B118B1"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-64D5B1E5-7FDD-5AD1-BD0F-906D27B118B1"><!-- --></a><p> <a href="GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594.html"><span class="apiname">CBitmapFrameData</span></a>, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-0F881880-38C8-5E94-869E-835D90960C45"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-0F881880-38C8-5E94-869E-835D90960C45"><!-- --></a><p> <a href="GUID-780B280B-A3D9-31C8-9F82-55353DC7E056.html"><span class="apiname">CBitmapAnimClientData</span></a>, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7330A56E-0371-5AE7-942F-E461F7D697F1"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7330A56E-0371-5AE7-942F-E461F7D697F1"><!-- --></a><p> <a href="GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48.html"><span class="apiname">RBitmapAnim</span></a>. </p>
 </li>

</ul>
 <p>The rest of this document describes each of these steps, starting
with the animation frame. </p>
 </div>

<div class="section" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-112ED5AB-2CFA-415A-8CA2-9B327BADC99A"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-112ED5AB-2CFA-415A-8CA2-9B327BADC99A"><!-- --></a><h2 class="sectiontitle">Defining an animation frame</h2> <p>The <samp class="codeph">CBitmapFrameData</samp> class
represents a single frame in an animation. The following properties of a frame
can be set: </p>
 <ul>
<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-DEC005F2-FBAC-59AA-BA41-E4B3B025B19C"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-DEC005F2-FBAC-59AA-BA41-E4B3B025B19C"><!-- --></a><p>the bitmap image, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-D1829CD2-786B-55DF-AF9A-49EBC2765906"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-D1829CD2-786B-55DF-AF9A-49EBC2765906"><!-- --></a><p>the mask, which is used
for making parts of the image transparent, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-1371D69B-D45F-5A1E-8BA5-37210ED0FABA"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-1371D69B-D45F-5A1E-8BA5-37210ED0FABA"><!-- --></a><p>the time the frame is
displayed, in milliseconds, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-8290AB20-F4E2-5FBC-84FA-BD55D4AE8EB4"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-8290AB20-F4E2-5FBC-84FA-BD55D4AE8EB4"><!-- --></a><p>the position in the
window where the frame is displayed. </p>
 </li>

</ul>
 <p>These properties can either be set in <a href="GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594.html#GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594__GUID-83DBA551-0023-399B-8791-EC4CEB4BEF53"><span class="apiname">CBitmapFrameData::NewL()</span></a> or
by calling various setter functions, described below. </p>
 <p><strong>Setting the
image and mask bitmaps </strong> </p>
 <p>The following code loads the bitmap and
mask from a multi bitmap file, and constructs the frame, setting its bitmap
and mask, which it takes ownership of: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-2B408AB3-8816-51B6-95DD-6848EB83EC84"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-2B408AB3-8816-51B6-95DD-6848EB83EC84"><!-- --></a>CFbsBitmap* bitmap=new (ELeave) CFbsBitmap; // load the image bitmap from an mbm file 
CleanupStack::PushL(bitmap);
User::LeaveIfError(bitmap-&gt;Load(KMBMFileName, EMbmAnimFrame1));
CFbsBitmap* mask=new (ELeave) CFbsBitmap; // load the mask from the same mbm file
CleanupStack::PushL(mask);
User::LeaveIfError(mask-&gt;Load(KMBMFileName, EMbmAnimFrameMask1));
CBitmapFrameData* frame1 = CBitmapFrameData::NewL(bitmap, mask);
CleanupStack::Pop(2); // bitmap, mask</pre>
 <p> <a href="GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594.html#GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594__GUID-E1FFD12D-5139-3532-8207-1D94C75ACBE8"><span class="apiname">CBitmapFrameData::SetBitmap()</span></a> and <a href="GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594.html#GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594__GUID-D7EB7A35-006B-3A89-9EBA-3BFD28D02518"><span class="apiname">CBitmapFrameData::SetMask()</span></a> could alternatively be used. </p>
 <p>An animation can have multiple frames,
each of which has an image and mask bitmap. Each frame stores a flag to indicate
whether or not it owns the bitmaps. If the frame owns the bitmaps, they are
deleted in the frame’s destructor. This flag can be set or unset by calling <a href="GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594.html#GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594__GUID-15F4E778-0D5C-3653-8722-9352F4386C76"><span class="apiname">CBitmapFrameData::SetBitmapsOwnedExternally()</span></a>.
By default, bitmaps are owned by the frame. </p>
 <p>The mask is used in the
standard way for a bitmap mask, so pixels in the bitmap image that map to
black pixels in the mask are drawn, while pixels that map to white pixels
in the mask are not, so appear transparent. </p>
 <p><strong>Setting the time interval </strong> </p>
 <p>The
time period for the frame to be displayed on the screen is set in milliseconds: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7D886BE6-2660-5937-83F6-740D98E9A002"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7D886BE6-2660-5937-83F6-740D98E9A002"><!-- --></a>frame1-&gt;SetInterval(125);</pre>
 <p>Note
that a default time interval can be set in the frame container (described
in the next section) by calling <a href="GUID-780B280B-A3D9-31C8-9F82-55353DC7E056.html#GUID-780B280B-A3D9-31C8-9F82-55353DC7E056__GUID-A7CEB917-12B5-38E8-9BBA-5F42B695EA92"><span class="apiname">CBitmapAnimClientData::SetFrameInterval()</span></a>.
Any value set in the container will apply to frames that have not set an interval
themselves. </p>
 <p><strong>Setting the frame’s position </strong> </p>
 <p>The position
of the frame relative to the animation window is set using <a href="GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594.html#GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594__GUID-EA74CED1-0AE0-30D2-9FFF-AAB321FC119C"><span class="apiname">CBitmapFrameData::SetPosition()</span></a>: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-2344FB5E-F8DC-54C1-8995-A2B21DDA5D24"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-2344FB5E-F8DC-54C1-8995-A2B21DDA5D24"><!-- --></a>TPoint framePos(3,6);
frame1-&gt;SetPosition(framePos);</pre>
 <p>Note that the position can also
be specified in <a href="GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48.html"><span class="apiname">RBitmapAnim</span></a>; if so, this value applies
to all frames. </p>
 <p>When you have finished defining the animation frame(s),
use the frame container class, <a href="GUID-780B280B-A3D9-31C8-9F82-55353DC7E056.html"><span class="apiname">CBitmapAnimClientData</span></a>, to
create the animation. </p>
 </div>

<div class="section" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-598D3A59-6DC6-40C9-9CFA-30D5AB656040"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-598D3A59-6DC6-40C9-9CFA-30D5AB656040"><!-- --></a><h2 class="sectiontitle">Defining an animation</h2> <p>Frames are grouped into an
animation frame container (<a href="GUID-780B280B-A3D9-31C8-9F82-55353DC7E056.html"><span class="apiname">CBitmapAnimClientData</span></a>), which
allows the following behaviour to be set: </p>
 <ul>
<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-3DB97BEC-DE20-5514-AE79-D21D6B3C257D"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-3DB97BEC-DE20-5514-AE79-D21D6B3C257D"><!-- --></a><p>append frames to the
container, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-13AA19C6-45E7-5AEC-A202-2D8FCA16BC4D"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-13AA19C6-45E7-5AEC-A202-2D8FCA16BC4D"><!-- --></a><p>set a default display
interval for all frames, (note that the time interval set by an individual
frame takes precedence, for that frame, over the default interval), </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-CC7DA6F4-DDA9-5296-8348-9FA4D2D9B203"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-CC7DA6F4-DDA9-5296-8348-9FA4D2D9B203"><!-- --></a><p>set one of the following
play modes for the animation: play once, loop or bounce (plays forwards and
backwards), </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-B32243AD-62F2-547D-B31B-C8B520F71D78"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-B32243AD-62F2-547D-B31B-C8B520F71D78"><!-- --></a><p>set the animation to
flash, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-F8251606-6004-5752-B74A-23CF280248B9"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-F8251606-6004-5752-B74A-23CF280248B9"><!-- --></a><p>provide an additional
bitmap frame to use for the background to the animation (explained below). </p>
 </li>

</ul>
 <p><strong>Appending frames </strong> </p>
 <p>First, create the frame container,
and append the frame(s) to it in the correct sequence: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-67B754F6-1802-5361-9CB9-40E6D025AB04"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-67B754F6-1802-5361-9CB9-40E6D025AB04"><!-- --></a>CBitmapAnimClientData* animFrames=CBitmapAnimClientData::NewL();
CleanupStack::PushL(animFrames);
animFrames-&gt;AppendFrameL(*frame1);
animFrames-&gt;AppendFrameL(*frame2); // etc.</pre>
 <p><strong>Setting the default
display interval </strong> </p>
 <p>A default display interval can be set for the
animation: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-126F763A-DB9C-50F4-BEB5-70093895CB03"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-126F763A-DB9C-50F4-BEB5-70093895CB03"><!-- --></a>animFrames-&gt;SetFrameInterval(100);</pre>
 <p>This
applies only to frames which have not specified their own interval (using <a href="GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594.html#GUID-D88261C5-BCD8-36C4-9A46-6DA0A7FB5594__GUID-4EE6A625-B3AD-3389-93F0-D92D6FC3FC68"><span class="apiname">CBitmapFrameData::SetInterval()</span></a>).
In this example, the default interval for frames without their own interval
is 100 milliseconds (0.1 second). It can be used to ensure that all frames
are displayed for the same length of time. </p>
 <p><strong>Setting the play mode </strong> </p>
 <p>There
are three play modes: play once, play repeatedly in the same direction ('loop')
and play forwards and backwards repeatedly ('bounce'). This code sets the
animation to play once: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-13F860DF-A4E7-505E-AAD3-92C7BDF68886"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-13F860DF-A4E7-505E-AAD3-92C7BDF68886"><!-- --></a>animFrames-&gt;SetPlayMode(CBitmapAnimClientData::EPlay);</pre>
 <p><strong>Other properties </strong> </p>
 <p> <a href="GUID-780B280B-A3D9-31C8-9F82-55353DC7E056.html#GUID-780B280B-A3D9-31C8-9F82-55353DC7E056__GUID-E1BDF09C-2154-3E60-BFBD-B4400C3EA295"><span class="apiname">CBitmapAnimClientData::SetFlash()</span></a> and <a href="GUID-780B280B-A3D9-31C8-9F82-55353DC7E056.html#GUID-780B280B-A3D9-31C8-9F82-55353DC7E056__GUID-C2B4666A-A755-313D-BAC5-CEF74C09BDB2"><span class="apiname">CBitmapAnimClientData::SetBackgroundFrame()</span></a> are used to set/unset the flash flag and the background frame, respectively.
The flash flag determines whether the animation should flash or not. </p>
 <p>The
background frame, which is optional, is used to clear the current frame before
drawing the next one. If no background frame is provided by the client, the
window server creates its own background frame using the original screen contents,
and updates it when the animation window is redrawn. </p>
 <p>If the client-provided
background frame contains an image bitmap and a mask, the background image
used is a combination of the screen contents and the supplied background bitmap.
If the client-provided background frame has a bitmap but no mask, the bitmap
is used as the background. </p>
 </div>

<div class="section" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7299DDF6-52E7-43FB-A940-DD8D3059AE6E"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-7299DDF6-52E7-43FB-A940-DD8D3059AE6E"><!-- --></a><h2 class="sectiontitle">Playing the animation</h2> <p>When the animation is ready
to play, it must be packaged and sent to the window server’s animation DLL.
This is done through an animation player (<a href="GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48.html"><span class="apiname">RBitmapAnim</span></a>)
object. </p>
 <p> <samp class="codeph">RBitmapAnim</samp> allows you to do the following: </p>
 <ul>
<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-FE236CAC-38D1-5A3C-BE6A-35897F564592"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-FE236CAC-38D1-5A3C-BE6A-35897F564592"><!-- --></a><p>specify the window in
which the animation is displayed, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-C0D41155-63B9-5038-924E-D7F3193FF65F"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-C0D41155-63B9-5038-924E-D7F3193FF65F"><!-- --></a><p>associate the animation
with an <a href="GUID-800B3667-F45F-391F-A8A9-F876FB4ABC34.html"><span class="apiname">RAnimDll</span></a> object, which provides a connection to
the window server, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-301E0D0B-2010-56CF-8780-FBE322CD9FDA"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-301E0D0B-2010-56CF-8780-FBE322CD9FDA"><!-- --></a><p>pass the animation object
to the window server’s animation DLL, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-610C8A64-4BC6-5E59-8DC4-809B47328F02"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-610C8A64-4BC6-5E59-8DC4-809B47328F02"><!-- --></a><p>specify the number of
times the animation should play, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-2384FF48-9281-5D4E-9298-D822B7566E52"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-2384FF48-9281-5D4E-9298-D822B7566E52"><!-- --></a><p>start and stop playing
the animation. Optionally the animation can start playing from a particular
frame. </p>
 </li>

</ul>
 <p>Note that after the animation object has been set up and passed to
the window server, the general attributes of the animation, namely the flash
property, the default display time for each frame and the play mode can still
be changed, using the following <samp class="codeph">RBitmapAnim</samp> functions: </p>
 <ul>
<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-8DA50426-3BD1-5B8E-B8D7-B0D8F19409DF"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-8DA50426-3BD1-5B8E-B8D7-B0D8F19409DF"><!-- --></a><p> <samp class="codeph">SetFlashL()</samp>, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-C237DFD6-427F-5953-AFB6-0AA64B0D97FE"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-C237DFD6-427F-5953-AFB6-0AA64B0D97FE"><!-- --></a><p> <samp class="codeph">SetFrameIntervalL()</samp>, </p>
 </li>

<li id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-8020158F-10BA-554E-9088-E51CE00DBBC6"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-8020158F-10BA-554E-9088-E51CE00DBBC6"><!-- --></a><p> <samp class="codeph">SetPlayModeL()</samp>. </p>
 </li>

</ul>
 <p>Any changes to these properties made using <samp class="codeph">RBitmapAnim</samp> will
override the values previously set in <samp class="codeph">CBitmapAnimClientData</samp>. </p>
 <p><strong>Constructing
the animation player </strong> </p>
 <p> <a href="GUID-800B3667-F45F-391F-A8A9-F876FB4ABC34.html"><span class="apiname">RAnimDll</span></a> is a handle
to the server-side animation DLL. It is used to load the window server animation
DLL, <span class="filepath">bmpansrv.dll</span>, which provides the functions that
perform the frames animation. The <samp class="codeph">RAnimDll</samp> instance is passed
to the <samp class="codeph">RBitmapAnim</samp> constructor. </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-04E123E6-306B-5C8B-9A0B-A415E6EBC74A"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-04E123E6-306B-5C8B-9A0B-A415E6EBC74A"><!-- --></a>RAnimDll animDLL(iEikonEnv-&gt;WsSession()); // session is used to interact with the window server
_LIT(KDllName, "BMPANSRV.DLL"); 
User::LeaveIfError(animDll.Load(KDllName)); 
RBitmapAnim animPlayer(animDLL);
animPlayer.ConstructL(Window());</pre>
 <p><strong>Passing the animation object
to the window server </strong> </p>
 <p>The animation frame container (<samp class="codeph">CBitmapAnimClientData</samp>)
should be passed via the <samp class="codeph">RBitmapAnim</samp> object to the window
server. This is done using the function <samp class="codeph">SetBitmapAnimDataL()</samp>.
Note that calling this function does not cause the animation to start playing: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-F8CCC483-9B1F-58A4-AF93-E8E967A535B1"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-F8CCC483-9B1F-58A4-AF93-E8E967A535B1"><!-- --></a>animPlayer.SetBitmapAnimDataL(*animFrames);</pre>
 <p><strong>Setting
the number of cycles </strong> </p>
 <p>If the animation should play more than once,
the number of cycles should be set: </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-549751F2-770E-54C4-8C78-7AFF633D9A4D"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-549751F2-770E-54C4-8C78-7AFF633D9A4D"><!-- --></a>animPlayer.SetNumberOfCyclesL(10);</pre>
 <p>Note that if the animation's play mode is 'bounce', the number of cycles
must be set to at least two to ensure a complete animation routine. </p>
 <p><strong>Setting
the position </strong> </p>
 <p>To set the animation’s position, use <samp class="codeph">SetPositionL()</samp>.
This value is an offset from the origin of the animation window. </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-3F4E29C5-A456-5BFC-AA10-0A7E29EAAB97"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-3F4E29C5-A456-5BFC-AA10-0A7E29EAAB97"><!-- --></a>TPoint animPos(20,40);
animPlayer.SetPositionL(animPos);</pre>
 <p><strong>Starting/stopping the
animation </strong> </p>
 <p>The <a href="GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48.html#GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48__GUID-E7C514C8-0335-3903-A997-C226170798C5"><span class="apiname">RBitmapAnim::StartL()</span></a> and <a href="GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48.html#GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48__GUID-DD8AFC9D-E742-36E7-8816-37E61392DEDF"><span class="apiname">RBitmapAnim::StopL()</span></a> functions
send commands to the animation DLL to start/stop the animation routine. </p>
 <p>Calling <a href="GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48.html#GUID-0282B941-2A58-3F3D-8875-DFBA72F46F48__GUID-1E2FCA51-21BF-3C21-8D96-753E27F277B1"><span class="apiname">RBitmapAnim::DisplayFrameL()</span></a> before
the animation has started sets the frame from which the animation should start
playing. </p>
 <p><strong>Freeing resources </strong> </p>
 <p>After they have been finished
with, <samp class="codeph">Close()</samp> should be called on the <samp class="codeph">RAnimDll</samp> and <samp class="codeph">RBitmapAnim</samp> objects. </p>
 <pre class="codeblock" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-E7E87F97-9040-50F1-99F2-35AF517993E1"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-E7E87F97-9040-50F1-99F2-35AF517993E1"><!-- --></a>animPlayer.Close();
animDLL.Close();</pre>
 </div>

<div class="section" id="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-CF40984F-2CA8-4EEE-98AD-C8F3E074407F"><a name="GUID-05D6AB1C-8548-58C6-AA6C-EE362FF49247__GUID-CF40984F-2CA8-4EEE-98AD-C8F3E074407F"><!-- --></a><h2 class="sectiontitle">See also</h2> <ul>
<li><p><a href="GUID-3D577CFE-A6C7-5C4C-A9AA-9382A062A3BE.html">Animation Overview</a></p>
</li>

<li><p><a href="GUID-71DADA82-3ABC-52D2-8360-33FAEB2E5DE9.html" title="The Font and Bitmap Server (FBServ) provides a memory efficient way of using bitmaps and fonts. It stores a single instance of each bitmap in either a shared heap or in eXecute In Place (XIP) ROM and provides clients with read and (when appropriate) write access.">Introduction
to the Font and Bitmap Server</a></p>
</li>

</ul>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-26FC16BB-47D8-5DF6-9ABE-07526286597A.html" title="The section explain how to create animations using Bitmap Animation framework.">Bitmap Animation</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>