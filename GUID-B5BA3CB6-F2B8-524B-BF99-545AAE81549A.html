<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Message Stores"/>
<meta name="abstract" content="The SMS stack uses the following stores to store a complete message."/>
<meta name="description" content="The SMS stack uses the following stores to store a complete message."/>
<meta name="DC.Relation" scheme="URI" content="GUID-30C21015-C433-5465-87A7-DA5A9C4AD7BD.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6BA58045-3864-599A-878E-0C7AE7E9741B.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E0DA7DE7-FD5A-5C1D-A53C-870966F00445.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-30C21015-C433-5465-87A7-DA5A9C4AD7BD.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Message Stores</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A"><a name="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2563496 id2563002 id2563083 id2562974 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-34E7AAF2-EC62-5BF6-B9E7-C7D346BCDF93.html" title="Cellular Baseband Services provide a common interface to telephony services for applications and higher level platform components. The framework is independent of the underlying network services.">Cellular Baseband Services Guide</a> &gt; <a href="GUID-6BA58045-3864-599A-878E-0C7AE7E9741B.html" title="This section describes the components related to the SMS protocols.">SMS Protocols</a> &gt; <a href="GUID-E0DA7DE7-FD5A-5C1D-A53C-870966F00445.html" title="This section provides the summary of concepts and tutorials related to the SMS stack for the GSM networks. The client applications can access the SMS stack using socket server APIs.">SMS Stack for GSM Networks</a> &gt; <a href="GUID-30C21015-C433-5465-87A7-DA5A9C4AD7BD.html" title="This section lists the concepts and architecture of the SMS Stack.">Concepts</a> &gt; </div>
<h1 class="topictitle1">Message
Stores</h1>
<div><p>The SMS stack uses the following stores to store a complete message. </p>

<div class="section" id="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-0754BD99-4FFF-5AC2-8E33-7E3B897C03D0"><a name="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-0754BD99-4FFF-5AC2-8E33-7E3B897C03D0"><!-- --></a><h2 class="sectiontitle">Segmentation
and reassembly (SAR) stores</h2> <p>The SMS messages are sent as PDUs and
all the PDUs are required to display the message to the user. The PDUs should
be stored until all the PDUs are received by the device. The SMS stack stores
the incomplete message PDUs in message stores for persistence storage. The
segmentation store and the reassembly store are both created by the GSMU DLL.
The message stores are also used to store the WAP datagrams. </p>
 <p> <a href="GUID-B9382772-FC6F-3A90-AF3B-218A299D64C3.html"><span class="apiname">TSAREntry</span></a> provides
information that is useful for the clients to segment and reassemble the SMS
messages and WAP datagrams. TSAREntry provides information about the reference,
total number of parts and the index of the parts of the complete message or
datagram. </p>
 <p> <a href="GUID-B9382772-FC6F-3A90-AF3B-218A299D64C3.html"><span class="apiname">TSAREntry</span></a> class also provides get and
set methods for four non generic data items in a message. </p>
 <p>The <a href="GUID-349FD476-1D50-3D6A-8023-7CBB7DE4821F.html"><span class="apiname">CSARStore</span></a> provides
the methods to create the SAR stores and store the information useful for
segmentation and reassembly. The <a href="GUID-349FD476-1D50-3D6A-8023-7CBB7DE4821F.html"><span class="apiname">CSARStore</span></a> contains a permanent
store and a list of <a href="GUID-B9382772-FC6F-3A90-AF3B-218A299D64C3.html"><span class="apiname">TSAREntry</span></a> elements. The member functions
of the <a href="GUID-349FD476-1D50-3D6A-8023-7CBB7DE4821F.html"><span class="apiname">CSARStore</span></a> allow the client applications to create
a new store, add an entry, update an entry and delete the store. </p>
 </div>

<div class="section" id="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-860AC34F-AD6A-5F01-86E9-B76DE3F9ADF3"><a name="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-860AC34F-AD6A-5F01-86E9-B76DE3F9ADF3"><!-- --></a><h2 class="sectiontitle">Segmentation
store</h2> <p>The <a href="GUID-349FD476-1D50-3D6A-8023-7CBB7DE4821F.html"><span class="apiname">CSARStore</span></a> creates the segmentation
store as <samp class="codeph">smssegst.dat</samp>. The SMS message is split into individual
PDUs before sending them to the network. The segmentation store is used to
store the PDUs. The segmentation store enables the client applications to
receive the status report of the PDUs. </p>
 <p><strong>Segmentation store data </strong> </p>
 <p>The clients can implement segmentation
store using <a href="GUID-7907447F-BFAC-3916-AEC0-90AD5DF426DD.html"><span class="apiname">CSmsSegmentationStore</span></a> class. <a href="GUID-07379C99-2BE4-316F-8CE1-5AFB9C0AA23C.html"><span class="apiname">CSegmentationStore</span></a> is
derived from <a href="GUID-349FD476-1D50-3D6A-8023-7CBB7DE4821F.html"><span class="apiname">CSARStore</span></a>. The segmentation store is generally
used to store <samp class="codeph">SUBMIT</samp> and <samp class="codeph">COMMAND</samp> PDUs. The
PDUs are stored as additional stream ID in the store. Each stream ID contains
the SMS address, SMS message and an array of status reference items. The segmentation
store creates a log of all sent and unsent PDUs with a log ID. The SMS stack
uses the log ID to resend the message PDUs which failed. </p>
 </div>

<div class="section" id="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-C48FFB78-1C80-5ECE-A19F-DE98A1814C25"><a name="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-C48FFB78-1C80-5ECE-A19F-DE98A1814C25"><!-- --></a><h2 class="sectiontitle">Reassembly
store</h2> <p>The <a href="GUID-349FD476-1D50-3D6A-8023-7CBB7DE4821F.html"><span class="apiname">CSARStore</span></a> class creates the reassembly
store as <samp class="codeph">smsreast.dat</samp> . The reassembly store is used to individual
PDUs when received from the network. Once all the PDUs of a message are received
they are reassembled by the SMS stack. A complete message is then created,
the message is ready for the client applications. </p>
 <p><strong>Reassembly store data </strong> </p>
 <p>The clients can implement the reassembly
store using <a href="GUID-1100B8E0-0006-35B4-B15C-989F3B0030B6.html"><span class="apiname">CSmsReassemblyStore</span></a> class. The <a href="GUID-E4E30D66-BCD0-3002-9A02-6B3EF7BF39A4.html"><span class="apiname">CSmsReassembly</span></a> class
is derived from CSARStore. The <a href="GUID-1100B8E0-0006-35B4-B15C-989F3B0030B6.html"><span class="apiname">CSmsReassemblyStore</span></a> class
provides methods that can be used by the client applications to search for
a PDU, update a existing PDU, clear the store and compact the store. </p>
 </div>

<div class="section" id="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-C641C3FE-43B8-52CA-936A-5B3741C99894"><a name="GUID-B5BA3CB6-F2B8-524B-BF99-545AAE81549A__GUID-C641C3FE-43B8-52CA-936A-5B3741C99894"><!-- --></a><h2 class="sectiontitle">Class 0 reassembly
store</h2> <p>The normal SMS store are not designed to handle Class 0 SMS.
A new class 0 reassembly store is available to handle the class 0 SMS messages
in out of disk conditions. The class 0 reassembly store contains two stores
1) A permanent file store and 2) Pre-allocated file store. The pre allocated
file store is reserved exclusively for the class 0 SMS. The pre-allocated
file store can be <a href="GUID-266B3FD6-A414-599D-BF31-FF67ADDD4E70.html" title="This section describes how Class 0 SMS messages are handled in Symbian platform.">configured</a> to
reserve for pre-defined number of PDUs. The pre-allocated store can only be
configured by the licensees of Symbian platform. In normal conditions the
message PDUs are stored in the permanent file store. In out of disk conditions
it is not possible to delete older PDUs in the permanent files store. The
SMS stack uses the pre-allocated store during the out of disk conditions.
When the number of PDUs exceed the specified level in the ESK file, the SMS
stack deleted the older PDUs to clear up space for the new incoming PDUs.
The pre-allocated file store cannot be used to store other class/ type of
SMS messages. <a href="GUID-F701D74D-6BC8-337C-AF36-971CDD8E5F7D.html"><span class="apiname">CClass0SmsReassemblyStore</span></a> store provides
the required methods for the clients to use the class 0 reassembly store.
The class 0 reassembly store provides the same functionality as the reassembly
store. The additional functionality is that the client applications are able
to process an incomplete message and display it to the users. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-30C21015-C433-5465-87A7-DA5A9C4AD7BD.html" title="This section lists the concepts and architecture of the SMS Stack.">Concepts</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>