<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Creating Transfer Types"/>
<meta name="abstract" content="To transfer data between the Backup Engine and the backup server, a particular type of conn::CSBGenericTransferType must be created."/>
<meta name="description" content="To transfer data between the Backup Engine and the backup server, a particular type of conn::CSBGenericTransferType must be created."/>
<meta name="DC.Relation" scheme="URI" content="GUID-F9E9A096-6F70-5146-AE1E-49670905756D.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-A0D4B6EC-8FA7-5FD9-AE5A-E811D876D585.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-78045215-99B0-5D66-8E5F-5396E2D23259.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0FE60A65-6CB6-50AB-B85F-2B60FE96ECFE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F9E9A096-6F70-5146-AE1E-49670905756D.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0BD22FDB-1A5C-56AA-A7FC-BD2271B2F928.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Creating Transfer Types</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1"><a name="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2534806 id2534820 id2534828 id2534890 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-A0D4B6EC-8FA7-5FD9-AE5A-E811D876D585.html">Remote Connectivity Guide</a> &gt; <a href="GUID-78045215-99B0-5D66-8E5F-5396E2D23259.html">Backup and Restore</a> &gt; <a href="GUID-0FE60A65-6CB6-50AB-B85F-2B60FE96ECFE.html">Backup Engine</a> &gt; <a href="GUID-F9E9A096-6F70-5146-AE1E-49670905756D.html">Writing a Backup Engine Client (CSBEClient) Tutorials</a> &gt; </div>
<h1 class="topictitle1">Creating
Transfer Types</h1>
<div><p>To transfer data between the Backup Engine and the backup server,
a particular type of <samp class="codeph">conn::CSBGenericTransferType</samp> must be
created. </p>

<div class="section" id="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-21601609-18C3-401C-84FC-08184A52E2C7"><a name="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-21601609-18C3-401C-84FC-08184A52E2C7"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>The <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-FB671D02-0F15-396F-9FB7-EE3E9372093C"><span class="apiname">conn::CSBEClient</span></a> uses <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-27BF6AEB-72A0-3E39-9598-AB97BE2569FC"><span class="apiname">conn::CSBGenericTransferType</span></a> to
request (for backup) or supply (for restore) data. One of the following three
derived classes must be created to transfer data. </p>
 <ul>
<li id="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-9002670C-20FB-5FCA-BB11-BAA96FC591A8"><a name="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-9002670C-20FB-5FCA-BB11-BAA96FC591A8"><!-- --></a><p> <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-6921D016-99BB-3CF0-B77C-CEF652A6D16B"><span class="apiname">conn::CSBSIDTransferType</span></a> transfers
data of the owner whose type is <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-A592A578-6E32-36C8-A2CE-590E99173AF8"><span class="apiname">conn::ESIDDerivedType</span></a>.
Data owners of this type are the common applications or servers built into
the ROM. </p>
 <p>You can specify the creation of passive data, active data
or snapshot data transfer type by passing a <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-55127967-CF91-3AEF-8304-DB60B287036F"><span class="apiname">conn::TTransferDataType</span></a> parameter
value to the <samp class="codeph">CSBSIDTransferType::NewL()</samp> function. For example,
passing <samp class="codeph">EActiveSnapshotData</samp> to <samp class="codeph">CSBSIDTransferType:NewL()</samp> creates
an active snapshot transfer type. </p>
 </li>

<li id="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-550A62AA-0E27-5DD0-B014-3498CFDEDDEA"><a name="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-550A62AA-0E27-5DD0-B014-3498CFDEDDEA"><!-- --></a><p> <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-EB313AA2-302E-352F-B1A4-E60DAFBEBCFB"><span class="apiname">conn::CSBPackageTransferType</span></a> transfers
data of the owner whose type is <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-A68EF3B1-2DF6-3787-83E0-F72CE16E785D"><span class="apiname">conn::EPackageDerivedType</span></a>.
Data owners of this type are usually installed through SIS files. Installing
a package may install may install several applications (data owners). Each
package is identified by a package ID while each data owner is identified
by a package ID, a package name and an SID. </p>
 <p>Packages are often installed
to a system drive, their data and snapshots are referred to as system data
and system data snapshots. </p>
 </li>

<li id="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-03178C8B-DFD8-5094-BFA6-65DB923E77BC"><a name="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-03178C8B-DFD8-5094-BFA6-65DB923E77BC"><!-- --></a><p> <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-A655F770-18F9-3F43-ADAB-9048EF14A5EC"><span class="apiname">conn::CSBJavaId</span></a> transfers
data of the owner whose type is <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-BCB77CBF-1B06-38E1-96C1-FF3CFCA5B734"><span class="apiname">conn::EJavaDerivedType</span></a>.
Data owners of this type are Java applications. </p>
 </li>

</ul>
 </div>

<div class="section" id="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1-3-2"><a name="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1-3-2"><!-- --></a><h2 class="sectiontitle">Procedure</h2> <p>Create
an array of a particular type, for example passive data for all data owners.
Then go through the array to create the transfer types. </p>
 <p>The following
example shows how to create the <a href="GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2.html#GUID-169BB4E2-5B0E-3719-A7B8-A3C0AAA602E2__GUID-EB313AA2-302E-352F-B1A4-E60DAFBEBCFB"><span class="apiname">conn::CSBPackageTransferType</span></a>.
You can further specify to create the data or snapshots. </p>
 <pre class="codeblock" id="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-1D28813F-25CA-5169-8FC9-88FDA081DDD5"><a name="GUID-8BFC185E-91FD-5E04-A26C-728B06F31FDD-GENID-1-12-1-28-1-1-4-1-3-1-6-1-6-1__GUID-1D28813F-25CA-5169-8FC9-88FDA081DDD5"><!-- --></a>/**
Each data owner in iDataOwners is a CDataOwnerInfo object, the following creates 
CSBGenericTransferTypes based on the TPackageDataType passed. 
@param aTransferTypes - Array of package transfer types.
@param aPkgDataType - system data or system data snapshot.
*/

void::GeneratePIDTransferTypesL(
           RPointerArray&lt;CSBGenericTransferType&gt;&amp; aTransferTypes,
           TPackageDataType aPkgDataType)
{

    aTransferTypes.ResetAndDestroy();
    TUid id;

    //need array to avoid duplications
    RArray&lt;TUid&gt; uidArray;
    CleanupClosePushL(uidArray);

    //One transfer type is created for each drive 
    //on which the data owner has data.
    TInt length = iDriveList.Length();
    for (TInt driveCount = 0; driveCount &lt; length; driveCount++)
       {
       if (iDriveList[driveCount])
              {
              TInt count = iDataOwners.Count();
              for (TInt i = 0; i &lt; count; i++)
                    {
                    switch (iDataOwners[i]-&gt;Identifier().DerivedTypeL())
                       {
                        case EPackageDerivedType:
                         if (iDataOwners[i]-&gt;CommonSettings() &amp; EHasSystemFiles)
                               {
                               //Create CSBPackageId for each data owner in the package
                               CSBPackageId* pkgId = 
                                  CSBPackageId::NewL(&amp;(iDataOwners[i]-&gt;Identifier()));
                               CleanupStack::PushL(pkgId);
                                          
                               id = pkgId-&gt;PackageIdL();
                               if (uidArray.Find(id) == KErrNotFound)
                                  {
                                  
                                  //Create the package transfer type based on the 
                                  //aPkgDataType parameter value passed in, 
                                  //system data or snapshot.
                                  CSBPackageTransferType* idType = 
                                      CSBPackageTransferType::NewL(
                                                                   id,
                                                                   TDriveNumber(driveCount), 
                                                                   aPkgDataType  
                                                                  );
                                  CleanupStack::PushL(idType);
                                  aTransferTypes.AppendL(idType);
                                  CleanupStack::Pop(idType);

                                  //add to uid array
                                  uidArray.AppendL(id);
                                  }
                               CleanupStack::PopAndDestroy(pkgId);      
                               } //if
                        break;
                       } // switch
                    } //for              
                } //if 
          } //for

CleanupStack::PopAndDestroy(&amp;uidArray);
}
</pre>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-F9E9A096-6F70-5146-AE1E-49670905756D.html">Writing a Backup Engine Client (CSBEClient) Tutorials</a></div>
</div>
<div class="relinfo reltasks"><strong>Related tasks</strong><br/>
<div><a href="GUID-0BD22FDB-1A5C-56AA-A7FC-BD2271B2F928.html" title="The Backup Engine exports conn::CSBEClient, which provides data to a host PC for backup and receives data from a host PC while restoring data. Device creators can call this API to write a backup server that handles PC requests for backup and restore.">Writing a
Backup Engine Client                 (CSBEClient)</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>