<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="task"/>
<meta name="DC.Title" content="Managing Master Key"/>
<meta name="DC.Relation" scheme="URI" content="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-690FD404-5F40-5A0B-BE71-A4A310DF1C0E.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-06370120-7738-5694-9A8C-3B5B1E3A4352.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-425A208C-5D2D-55FD-8623-9E00006E2781.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-372B7A9F-261E-5F3F-B114-4BE2FE2EF7C7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-79846EA2-33CD-5D01-8E96-6092C15BD839.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-922F292E-9420-593B-B226-2764C5F29DF9.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-6E1AC4C9-7CA3-503A-AFC0-BAF29CCA8290.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-B9BD2E0A-F214-5344-91A6-E4E99F0D74C8.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-7B6073BF-6D8C-5F00-98EC-966573777677"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Managing Master Key</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2397554 id2398072 id2398087 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-6425B722-4095-56E3-9198-70BA3E06C617.html">Multimedia Protocols Guide</a> &gt; <a href="GUID-690FD404-5F40-5A0B-BE71-A4A310DF1C0E.html" title="The Secure Real-Time Transport Protocol (SRTP) is defined as a profile of RTP. SRTP provides confidentiality, message authentication, and replay protection to the RTP traffic. It also protects the traffic of Real-time Transport Control Protocol (RTCP).">Secure Real-Time Transport Protocol</a> &gt; <a href="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html">Tutorials:Index</a> &gt; </div>
<h1 class="topictitle1">Managing
Master Key</h1>
<div><div><p>The Secure Real-Time Transport Protocol (SRTP) stream requires
the sender and receiver to maintain the cryptographic context of the packets.
SRTP uses two types of keys: master keys and session keys for packet encryption
and decryption. Master key is a random bit string. The session keys are derived
from the master key. The Session key is used directly in cryptographic transform
for encryption or message authentication.  </p>
<p> A single master key provides
keying material for confidentiality and integrity protection of both SRTP
and the corresponding SRTCP stream. For each master key, a count of processed
packets is maintained. There is a limit on the number of packets processed
by a single master key. SRTCP maintains a separate counter for master key
even if the master key is the same as that for SRTP. The counter counts the
number of SRTCP packets processed with the key.   </p>
<p>The SRTP stack checks
for the count of packet processed when the RTP/RTCP packets are encrypted
or decrypted. If the number of packets processed is maximum, the master key
status is identified as stale. The SRTP notifies the SRTP client of the master
key status. This is Notifying the Master Key Expiry.  </p>
<p> The SRTP stack
can request for a new master key(ReKey) even before the master key status
is identified as stale.This is ReKey request.</p>
</div>

<div class="p" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-E3BEB74D-79C7-59A9-9366-CCD8B52DB7F8-GENID-1-12-1-23-1-1-6-1-5-1-10-1-3-1"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-E3BEB74D-79C7-59A9-9366-CCD8B52DB7F8-GENID-1-12-1-23-1-1-6-1-5-1-10-1-3-1"><!-- --></a><p>An SRTP session
must be created and initialized before an application requests for a RTP/RTCP
packet decryption and encryption. </p>
 <p>The two variants of the API <a href="GUID-4301A1D8-5A9B-39F6-B4F0-84A7A1698617.html"><span class="apiname">SRTPMasterKeyStaleEvent()</span></a> must be
implemented by the application. </p>
 </div>

<a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-FB88B32D-6FD6-504B-A39F-D2882FF355FB"><!-- --></a><ol id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-FB88B32D-6FD6-504B-A39F-D2882FF355FB"><li id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-B7B460C7-C6C2-5AB0-957B-2ABA30877680"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-B7B460C7-C6C2-5AB0-957B-2ABA30877680"><!-- --></a><span>An RTP/RTCP packet
is encrypted or decrypted . </span>
</li>
<li id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-67F4846F-16C8-5DB1-ABB2-3886993AF5A4"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-67F4846F-16C8-5DB1-ABB2-3886993AF5A4"><!-- --></a><span>The SRTP uses the
current master key to check the count of packet processed. If the number of
packets processed is not the maximum permissible value, the count is increased.
If the number of packets processed has reached maximum permissible value,
the SRTP DLL notifies the expiry(stale) state of the current master key. </span>
</li>
<li id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-BB007F89-6FC5-58D0-9C89-5A04643C508F"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-BB007F89-6FC5-58D0-9C89-5A04643C508F"><!-- --></a><span>The SRTP DLL notifies
the master key status using the API's <a href="GUID-4301A1D8-5A9B-39F6-B4F0-84A7A1698617.html"><span class="apiname">SRTPMasterKeyStaleEvent()</span></a> of
the class <a href="GUID-4301A1D8-5A9B-39F6-B4F0-84A7A1698617.html"><span class="apiname">MSRTPReKeyingObserver</span></a> .The
notification can be initiated by MSRTPReKeyingObserver or CSRTPSession. </span>
<a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-7DD25E11-8593-53E4-AFFB-1DEFBA4EB9EC"><!-- --></a><ol type="a" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-7DD25E11-8593-53E4-AFFB-1DEFBA4EB9EC">
<li class="substepexpand" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-69A703E5-6CA8-5BC1-A910-533981F9374C"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-69A703E5-6CA8-5BC1-A910-533981F9374C"><!-- --></a><span/><br/>
 The prototypes for both the variants of <a href="GUID-4301A1D8-5A9B-39F6-B4F0-84A7A1698617.html"><span class="apiname">SRTPMasterKeyStaleEvent()</span></a> are
described below: 
 <ul>
<li id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-B9D9F267-48AD-55A6-AD8A-54B3C85C8764"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-B9D9F267-48AD-55A6-AD8A-54B3C85C8764"><!-- --></a><pre class="codeblock" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-4373AEA4-66E2-5968-B6C9-13E300C1617B"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-4373AEA4-66E2-5968-B6C9-13E300C1617B"><!-- --></a> virtual void SRTPMasterKeyStaleEvent(const CSRTPStream&amp; aStream)=0;
                     
                  </pre>
 <p>This API is called
by the SRTP Stream initiated with MSRTPReKeyingObserver, if a master key is
identified as stale and needs to be refreshed. </p>
 <p>aStream is the input
parameter. It contains the stream of the master key that needs to be refreshed. </p>
 </li>

</ul>
 
 <ul>
<li id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-A652F1E7-E2F9-59CB-B050-8FB3221FD7FA"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-A652F1E7-E2F9-59CB-B050-8FB3221FD7FA"><!-- --></a><pre class="codeblock" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-12C8EF78-DA37-5BA4-A62E-162B32EC301A"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-12C8EF78-DA37-5BA4-A62E-162B32EC301A"><!-- --></a> virtual void SRTPMasterKeyStaleEvent(const CSRTPSession&amp; aSession)=0;
                     
                  </pre>
 <p>This API is called
by SRTP Stream initiated with CSRTPSession if a master key is identified as
stale and needs to be refreshed. </p>
 <p>aSession is the input parameter.
It contains the session of the master key that needs to be refreshed. </p>
 </li>

</ul>
 
</li>

</ol>

</li>
<li id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-4A10324C-9356-5083-B109-C1CE1EEDEBED"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-4A10324C-9356-5083-B109-C1CE1EEDEBED"><!-- --></a><span>The SRTP DLL requests
for a new master key using the API <a href="GUID-4301A1D8-5A9B-39F6-B4F0-84A7A1698617.html"><span class="apiname"> 
               ReKeyNeeded()</span></a> of the class<a href="GUID-4301A1D8-5A9B-39F6-B4F0-84A7A1698617.html"><span class="apiname">CSRTPSession</span></a>. </span>
<a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-56DEF32A-0762-5D93-9F5D-D025DBB03533"><!-- --></a><ol type="a" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-56DEF32A-0762-5D93-9F5D-D025DBB03533">
<li class="substepexpand" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-876D52C4-F774-569F-9A09-BEAD80557D07"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-876D52C4-F774-569F-9A09-BEAD80557D07"><!-- --></a><span/><br/>
 The prototype of the API is as described below: 
 <ul>
<li id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-06E4B681-D1C0-52C3-AE2B-A5BA4F5A037D"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-06E4B681-D1C0-52C3-AE2B-A5BA4F5A037D"><!-- --></a><pre class="codeblock" id="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-B005930E-F049-5144-AF9F-2AD38DCF1F50"><a name="GUID-7B6073BF-6D8C-5F00-98EC-966573777677__GUID-B005930E-F049-5144-AF9F-2AD38DCF1F50"><!-- --></a>void ReKeyNeeded(const CSRTPStream&amp; aStream, TBool aIsStrmCrypto);
                     
                  </pre>
 <p>This API requests
for ReKey. </p>
 <p>aStream is the input parameter that needs the Rekey. </p>
 <p>aIsStrmCrypto
is the boolean input parameter. It contains true if stream has its own cryptographic
context. Else the value is false. </p>
 </li>

</ul>
 
</li>

</ol>

</li>
</ol>

<div class="section"><p>SRTP stack notifies the SRTP client of the master key expiry state. </p>
 <p>SRTP
stack requests for ReKey. </p>
 </div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-41E0D200-4A79-5D2B-BA4F-7AE55B5C3FBF.html">Tutorials:Index</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong><br/>
<div><a href="GUID-06370120-7738-5694-9A8C-3B5B1E3A4352.html">Creating
an SRTP                 Session</a></div>
<div><a href="GUID-425A208C-5D2D-55FD-8623-9E00006E2781.html">Creating
a                 Cryptographic Context</a></div>
</div>
<div class="relinfo reltasks"><strong>Related tasks</strong><br/>
<div><a href="GUID-372B7A9F-261E-5F3F-B114-4BE2FE2EF7C7.html">Creating
an SRTP                 Stream</a></div>
<div><a href="GUID-79846EA2-33CD-5D01-8E96-6092C15BD839.html">Encrypting
                RTCP Packet Data</a></div>
<div><a href="GUID-922F292E-9420-593B-B226-2764C5F29DF9.html">Encrypting
RTP                 Packet Data</a></div>
<div><a href="GUID-6E1AC4C9-7CA3-503A-AFC0-BAF29CCA8290.html">Decrypting
RTP                 Packet Data</a></div>
<div><a href="GUID-F9A24A47-7A0B-5F6E-8B0A-B7A7BCC4EAFC.html">Decrypting
                RTCP Packet Data</a></div>
<div><a href="GUID-B9BD2E0A-F214-5344-91A6-E4E99F0D74C8.html">Updating
Master                 Key</a></div>
</div>
</div>   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>