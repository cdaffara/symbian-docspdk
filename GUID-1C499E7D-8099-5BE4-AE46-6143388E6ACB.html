<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Audio Input Streaming Tutorial"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C2BF3044-CC37-554D-9496-C7B18AE94561.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-3E341F9F-2635-589B-A59A-B999FE7DF9BE.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DDE1A8A9-1D67-53BF-8A65-340F139AD4AB.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C6E3A784-EE17-5A3C-9D81-9662114FD923.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-C2BF3044-CC37-554D-9496-C7B18AE94561.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Audio Input Streaming Tutorial</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2405098 id2405245 id2405934 id2406022 id2406036 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html">Multimedia Guide</a> &gt; <a href="GUID-3E341F9F-2635-589B-A59A-B999FE7DF9BE.html">Multimedia APIs and Frameworks Collection</a> &gt; <a href="GUID-DDE1A8A9-1D67-53BF-8A65-340F139AD4AB.html">Multimedia Framework Component</a> &gt; <a href="GUID-C6E3A784-EE17-5A3C-9D81-9662114FD923.html">Audio Input Stream Library</a> &gt; <a href="GUID-C2BF3044-CC37-554D-9496-C7B18AE94561.html" title="This section describes how to use the Audio Input Stream library.">Audio Input Stream Tutorials</a> &gt; </div>
<h1 class="topictitle1">Audio Input Streaming Tutorial</h1>
<div><p>This tutorial describes how to use Audio Input Streaming. </p>
 <div class="section"><h2 class="sectiontitle">Purpose</h2> <p>The purpose of this tutorial is to show you how to open, read and then close an audio input stream. </p>
 <p><strong>Required Background</strong> </p>
 <p>The <a href="GUID-715E0EA4-8B3D-5DDF-B773-922E367B114F.html">Audio Input Streaming Overview</a> provides an introduction to Audio Input Streaming. </p>
 <p><strong>Introduction</strong> </p>
 <p>The audio input stream interface class, <a href="GUID-92BDB3AF-D9DB-35E2-AC6F-6435D3D1A4D8.html"><span class="apiname">CMdaAudioInputStream</span></a>, enables MMF client applications to: </p>
 <ul><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-577E976A-11CC-5054-ABDE-522A30B5FDCF"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-577E976A-11CC-5054-ABDE-522A30B5FDCF"><!-- --></a><p>stream audio data from the low level audio controller (which has collected it from a hardware device, such as a microphone) to specified buffers (record audio). </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-71E21858-E184-5B07-AE02-EFBE8F823B6E"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-71E21858-E184-5B07-AE02-EFBE8F823B6E"><!-- --></a><p>specify the priority of the audio stream relative to other clients trying to use the same audio hardware </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-BA394ADC-BC3F-5896-BAD0-EB24759DBD36"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-BA394ADC-BC3F-5896-BAD0-EB24759DBD36"><!-- --></a><p>set the sample rate and the number of channels to use for recording. </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-1CEAC638-A49F-5A21-91FC-90B6B56522EA"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-1CEAC638-A49F-5A21-91FC-90B6B56522EA"><!-- --></a><p>change the gain and channel balance of the input stream. </p>
 </li>
 </ul>
 <p>The low level audio controller stores the audio data in buffers. <a href="GUID-92BDB3AF-D9DB-35E2-AC6F-6435D3D1A4D8.html"><span class="apiname">CMdaAudioInputStream</span></a> reads these buffers incrementally and does not have to wait until capture is complete. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Using Audio Input Streaming </h2> <p>Typically, using an audio input stream involves the following steps as shown in the sequence diagram below: </p>
 <div class="fignone" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-FC960A5D-EDE5-5245-A736-6A6C00A0AC33"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-FC960A5D-EDE5-5245-A736-6A6C00A0AC33"><!-- --></a><img src="GUID-65885916-0242-5DDB-9D88-EB214096C4DF_d0e521742_href.png"/></div>
 <p>The following tasks will be covered in this tutorial: </p>
 <ul><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-1E1A247E-3740-5CAB-AEB7-171F455EE429"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-1E1A247E-3740-5CAB-AEB7-171F455EE429"><!-- --></a><p><a href="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB.html#GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-196AFBAE-8264-5DE2-994D-F2F06CF5CF3A"> Constructing an audio input stream</a>  </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-2744A8AE-A82C-5DAC-8C12-87D9B5ADCA6F"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-2744A8AE-A82C-5DAC-8C12-87D9B5ADCA6F"><!-- --></a><p><a href="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB.html#GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-51B28404-61E7-54E8-9F4E-730315308EA2">Opening an audio input stream</a>  </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-98480431-5F02-57D0-9564-7F0FFF2782C8"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-98480431-5F02-57D0-9564-7F0FFF2782C8"><!-- --></a><p><a href="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB.html#GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-4EAC65E0-E108-5BAA-B338-5B19B82D5057"> Getting and setting the stream properties</a>  </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-C03B920D-396F-5A44-9A76-77709CE45D2B"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-C03B920D-396F-5A44-9A76-77709CE45D2B"><!-- --></a><p><a href="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB.html#GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-BD91C4E9-9BBA-5442-A72E-01B42160DBDA"> Reading an audio input stream</a>  </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-91F3BEEE-52D7-504C-B74D-5C2FB8D59004"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-91F3BEEE-52D7-504C-B74D-5C2FB8D59004"><!-- --></a><p><a href="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB.html#GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-5811A2A0-5793-5FBB-B01A-AD94590955A8">Stopping an audio input stream</a>  </p>
 </li>
 </ul>
 <p id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-196AFBAE-8264-5DE2-994D-F2F06CF5CF3A"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-196AFBAE-8264-5DE2-994D-F2F06CF5CF3A"><!-- --></a><strong>Basic Procedure to Construct an Audio Input Stream</strong> </p>
 <p>The high level step to construct an audio input stream is shown here: </p>
 <ul><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-DDD98263-FD3A-5057-8E35-72D237807343"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-DDD98263-FD3A-5057-8E35-72D237807343"><!-- --></a><p>The client application creates an audio input stream object using the static function <a href="GUID-92BDB3AF-D9DB-35E2-AC6F-6435D3D1A4D8.html#GUID-92BDB3AF-D9DB-35E2-AC6F-6435D3D1A4D8__GUID-D534A585-D2B7-3906-AD82-E14A5FC1D501"><span class="apiname">CMdaAudioInputStream::NewL()</span></a>. The input stream class provides two versions of the constructor: one with the default priority and preferences, and another with specified priority and preferences. The client application must also implement the observer class <a href="GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0.html"><span class="apiname">MMdaAudioInputStreamCallback</span></a> to notify it about audio input streaming progress. </p>
 <p>The following code constructs an audio input stream: </p>
 <pre class="codeblock" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-0749EB33-33FA-5B58-856B-99F96AB9E3A2"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-0749EB33-33FA-5B58-856B-99F96AB9E3A2"><!-- --></a>CMdaAudioInputStream* aInputStream;
aInputStream = CMdaAudioInputStream::NewL(aCallback, EMdaPriorityNormal, EMdaPriorityPreferenceTimeAndQuality);</pre>
 <p>where, <samp class="codeph">aCallback</samp> is an <a href="GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0.html"><span class="apiname">MMdaAudioInputStreamCallback</span></a> object. </p>
 </li>
 </ul>
 <p id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-51B28404-61E7-54E8-9F4E-730315308EA2"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-51B28404-61E7-54E8-9F4E-730315308EA2"><!-- --></a><strong>Basic Procedure to Open an Audio Input Stream</strong> </p>
 <p>The high level steps to open an audio input stream are shown here: </p>
 <a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-67E0F7C7-E2E3-5882-A21F-254CB2EEBDA3"><!-- --></a><ol id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-67E0F7C7-E2E3-5882-A21F-254CB2EEBDA3"><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-B3AE7481-9750-5352-B10B-D51D1A220F97"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-B3AE7481-9750-5352-B10B-D51D1A220F97"><!-- --></a><p>To open an input stream, use the <a href="GUID-20D0D10F-3401-3F72-8AF6-DC35F6025DC2.html"><span class="apiname">Open()</span></a> member function, which provides a pointer to the <a href="GUID-06892E22-2EAC-305A-9D3A-F24E7F903427.html"><span class="apiname">TMdaPackage</span></a> object with the required audio settings. You can also open the stream without the audio settings. For example: </p>
 <pre class="codeblock" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-96065C5F-54F6-59D7-B6F1-BDE71EF46303"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-96065C5F-54F6-59D7-B6F1-BDE71EF46303"><!-- --></a>aInputStream-&gt;Open(NULL);</pre>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-8D443EF2-2FD1-5DBD-BEB3-21C5B7855978"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-8D443EF2-2FD1-5DBD-BEB3-21C5B7855978"><!-- --></a><p>Once the stream is open, a <a href="GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0.html#GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0__GUID-1F9A4EAF-EE58-3FA4-8707-D8C5EDFC0664"><span class="apiname">MMdaAudioInputStreamCallback::MaiscOpenComplete()</span></a> is issued to indicate that the stream is ready for use. </p>
 <pre class="codeblock" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-20F93B48-6662-59F1-A61B-374565A2FCB2"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-20F93B48-6662-59F1-A61B-374565A2FCB2"><!-- --></a>void CIOStreamAudio::MaiscOpenComplete(TInt aError)
    {
    ASSERT(iState==EStateOpeningInput);
    if (aError!=KErrNone)
        {
        Complete(aError);
        }
    else
        {
        iMainBuffer.Zero();
        iState = EStateReading;
        ReadNextBlock(KNullDesC8); // kick off a new read - KNullDesC8 for first buffer
        }
    }</pre>
 </li>
 </ol>
 <p id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-4EAC65E0-E108-5BAA-B338-5B19B82D5057"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-4EAC65E0-E108-5BAA-B338-5B19B82D5057"><!-- --></a><strong>Basic Procedure to Get and Set Stream Properties </strong> </p>
 <p>The high level steps to get and set stream properties are shown here: </p>
 <a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-98A49133-59B7-5681-9EC0-C19B1D71E9DD"><!-- --></a><ol id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-98A49133-59B7-5681-9EC0-C19B1D71E9DD"><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-DD84E50F-B44A-5ADC-ADF5-5DDE561D9AFD"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-DD84E50F-B44A-5ADC-ADF5-5DDE561D9AFD"><!-- --></a><p>To set the sampling rate and number of audio channels, use the <a href="GUID-38034819-8999-3EBE-9833-479D96D5DAB6.html"><span class="apiname">SetAudioPropertiesL()</span></a> member function. You can do this only if the stream is open and if data is not being streamed. Values must be specified as enum values. For example, <a href="GUID-CF54F882-E290-3C68-9352-79C6B7303FDF.html#GUID-CF54F882-E290-3C68-9352-79C6B7303FDF__GUID-681C1220-0CDD-34BF-848F-9DC82CB001DB"><span class="apiname">TMdaAudioDataSettings::ESampleRate8000Hz</span></a> and not <samp class="codeph">8000</samp> (Hz). The following code sets the sampling rate to 8000Hz and audio channel to mono: </p>
 <pre class="codeblock" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-EBC071A0-A461-5000-80E5-D3579E690D18"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-EBC071A0-A461-5000-80E5-D3579E690D18"><!-- --></a>aInputStream-&gt;SetAudioPropertiesL(TMdaAudioDataSettings::ESampleRate8000Hz,TMdaAudioDataSettings::EChannelsMono));</pre>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-EE508886-465A-581D-9FAF-76B5C522433F"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-EE508886-465A-581D-9FAF-76B5C522433F"><!-- --></a><p>The <a href="GUID-F4CC52C5-414A-3CA9-8472-A5C5298AC412.html"><span class="apiname">Gain()</span></a> and <a href="GUID-C2B76645-A50F-3DFF-943B-4F3D5A33ED31.html"><span class="apiname">GetBalanceL()</span></a> member functions let you determine the current gain and balance settings. </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-AEABCD16-7828-5DA1-B234-58BF44FB9C0E"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-AEABCD16-7828-5DA1-B234-58BF44FB9C0E"><!-- --></a><p>The <a href="GUID-54851704-F44B-3C2C-B3C9-2B4537AD1472.html"><span class="apiname">SetGain()</span></a> and <a href="GUID-D1856981-6A17-3CD9-80B5-65781A803BA4.html"><span class="apiname">SetBalanceL()</span></a> member functions let you set the gain and balance respectively. You can use them while the stream is open, with the new settings taking immediate effect. </p>
 </li>
 </ol>
 <p id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-BD91C4E9-9BBA-5442-A72E-01B42160DBDA"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-BD91C4E9-9BBA-5442-A72E-01B42160DBDA"><!-- --></a><strong>Basic Procedure to Read an Audio Input Stream</strong> </p>
 <p>The high level steps to read an audio input stream are shown here: </p>
 <a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-D78033B0-4918-51B8-8DC0-8B55F0172AC3"><!-- --></a><ol id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-D78033B0-4918-51B8-8DC0-8B55F0172AC3"><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-47C7BE03-0EAA-5C19-8FBB-7723B2AA9DEC"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-47C7BE03-0EAA-5C19-8FBB-7723B2AA9DEC"><!-- --></a><p>To record the audio stream, use the <a href="GUID-D7A48ABE-33F7-333E-8F57-0E673DA4B6F5.html"><span class="apiname">ReadL()</span></a> member function, specifying the buffer to use. The first <a href="GUID-D7A48ABE-33F7-333E-8F57-0E673DA4B6F5.html"><span class="apiname">ReadL()</span></a> after a successful <a href="GUID-20D0D10F-3401-3F72-8AF6-DC35F6025DC2.html"><span class="apiname">Open()</span></a>, starts audio recording. Once the buffer is successfully recorded, a pointer to it is returned by <a href="GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0.html#GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0__GUID-FB4EC66A-4B6D-331B-B5A1-4605084343B0"><span class="apiname">MMdaAudioInputStreamCallback::MaiscBufferCopied()</span></a> callback. </p>
 <pre class="codeblock" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-362E4E39-294E-57B9-912D-D0EB2C7B0B9B"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-362E4E39-294E-57B9-912D-D0EB2C7B0B9B"><!-- --></a>void CIOStreamAudio::MaiscBufferCopied(TInt aError, const TDesC8&amp; aBuffer)
    {
    ASSERT(iState==EStateReading);
    if (aError!=KErrNone)
        {
        if (aError!=KErrAbort) // aborts happen on Stop as buffers are recovered, need to ignore
            {
            Complete(aError);
            }
        }
    else
        {
        ReadNextBlock(aBuffer);
        }
    }</pre>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-CD08610E-0AFE-5730-BC3A-8F112FF54EE5"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-CD08610E-0AFE-5730-BC3A-8F112FF54EE5"><!-- --></a><p>The following code reads the next audio block into the buffer in an array of descriptors: </p>
 <pre class="codeblock" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-7E4D79D2-34DC-5691-865A-6C472B766BF8"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-7E4D79D2-34DC-5691-865A-6C472B766BF8"><!-- --></a>void CIOStreamAudio::ReadNextBlock(const TDesC8&amp; aBuffer)
    {
    ASSERT(iState==EStateReading);
    // buffer will be tail of iMainBuffer. Shift latter's length and get the next bit
    TInt lengthRecorded = iMainBuffer.Length()+aBuffer.Length();
    iMainBuffer.SetLength(lengthRecorded);
    iBufferPtr.Set(const_cast&lt;TUint8*&gt;(iMainBuffer.Ptr())+lengthRecorded, 0, iMainBuffer.MaxLength()-lengthRecorded);
    TRAPD(error, iInputStream-&gt;ReadL(iBufferPtr));
    if (error!=KErrNone)
        {
        Complete(error);
        }
    }</pre>
 </li>
 </ol>
 <p id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-5811A2A0-5793-5FBB-B01A-AD94590955A8"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-5811A2A0-5793-5FBB-B01A-AD94590955A8"><!-- --></a><strong>Basic Procedure to Stop an Audio Input Stream</strong> </p>
 <p>The high level steps to stop an audio input stream are shown here: </p>
 <ul><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-43677A50-198B-59D5-8F58-39C96CFAC5A4"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-43677A50-198B-59D5-8F58-39C96CFAC5A4"><!-- --></a><p>To stop recording the audio stream, use the <a href="GUID-7CBDCF0D-1D11-34D1-BF5C-1E5B50DA75B5.html"><span class="apiname">Stop()</span></a> member function. Two callbacks are issued after a <samp class="codeph">Stop()</samp>. </p>
 <a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-591B7B4E-899D-5D28-B33D-3EFC2DE1B4D6"><!-- --></a><ol id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-591B7B4E-899D-5D28-B33D-3EFC2DE1B4D6"><li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-EE9F9106-E0E8-5C20-8D8E-CB2A9FCCD0C4"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-EE9F9106-E0E8-5C20-8D8E-CB2A9FCCD0C4"><!-- --></a><p>An <a href="GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0.html#GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0__GUID-FB4EC66A-4B6D-331B-B5A1-4605084343B0"><span class="apiname">MMdaAudioInputStreamCallback::MaiscBufferCopied()</span></a> pointing to a buffer that contains the last of the recorded audio data (and an <samp class="codeph">aError</samp> value of <samp class="codeph">KErrAbort</samp>). </p>
 </li>
 <li id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-E3EBC7BE-C12C-527C-BF33-3EF787D8F9F4"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-E3EBC7BE-C12C-527C-BF33-3EF787D8F9F4"><!-- --></a><p>An <a href="GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0.html#GUID-6A1EAD31-95CA-3CAC-8897-791E9D522DF0__GUID-23F823E5-46A4-34D1-A7DD-DF6B18C37445"><span class="apiname">MMdaAudioInputStreamCallback::MaiscRecordComplete()</span></a>, indicating successful closure of the audio stream. </p>
 <pre class="codeblock" id="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-A9CE4580-E981-56E8-B98B-05C84E3C746E"><a name="GUID-1C499E7D-8099-5BE4-AE46-6143388E6ACB__GUID-A9CE4580-E981-56E8-B98B-05C84E3C746E"><!-- --></a>void CIOStreamAudio::MaiscRecordComplete(TInt aError)
    {
    ASSERT(iState==EStateReading &amp;&amp; aError!=KErrNone);
    Complete(aError);
    }</pre>
 </li>
 </ol>
 </li>
 </ul>
 </div>
 <div class="section"><h2 class="sectiontitle">See Also</h2> <p><a href="GUID-ECBA6331-2187-52C9-A5DF-20CD1EEFE781.html">Audio Output Streaming Tutorial</a>  </p>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-C2BF3044-CC37-554D-9496-C7B18AE94561.html" title="This section describes how to use the Audio Input Stream library.">Audio Input Stream Tutorials</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>