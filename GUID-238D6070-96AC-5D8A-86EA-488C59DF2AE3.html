<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Detecting Changes in the Environment"/>
<meta name="DC.Relation" scheme="URI" content="GUID-68A55CD5-EF01-5DE2-8119-EFA39589960F.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-94005A46-B4C6-4A30-A8E8-1B9C2D583D50.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-E079315A-E5B6-4D33-B7E3-88697A3F11A4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-0C6CCACF-84B2-5715-BCF3-12330E6F05D4.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-68A55CD5-EF01-5DE2-8119-EFA39589960F.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Detecting Changes in the Environment</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2561792 id2839629 id2839186 id2839196 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-94005A46-B4C6-4A30-A8E8-1B9C2D583D50.html">Classic UI Guide</a> &gt; <a href="GUID-E079315A-E5B6-4D33-B7E3-88697A3F11A4.html">Control and animation framework</a> &gt; <a href="GUID-0C6CCACF-84B2-5715-BCF3-12330E6F05D4.html" title="This section explains Front End Processor (FEP), and its implementations and events.">Using Front End Processor (FEPBASE)</a> &gt; <a href="GUID-68A55CD5-EF01-5DE2-8119-EFA39589960F.html">How to Write a FEP</a> &gt; </div>
<h1 class="topictitle1">Detecting
Changes in the Environment</h1>
<div>
<div class="section" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-829626B3-7A91-4A78-8608-9C9F35C96A5F"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-829626B3-7A91-4A78-8608-9C9F35C96A5F"><!-- --></a><h2 class="sectiontitle">Introduction</h2> <p>There
are two classes defined in <span class="filepath">epoc32\include\COEMAIN.H</span> that
enable FEPs to be notified about changes in their environment: <a href="GUID-2CAC79B0-8BD3-3961-A162-75B004AEE5FC.html"><span class="apiname">MCoeForegroundObserver</span></a> and <a href="GUID-E591B7D7-ED56-3CEF-883F-7091D5833731.html"><span class="apiname">MCoeFocusObserver</span></a>. <a href="GUID-ADAA039A-7BF3-3B06-8486-2E3604C2633D.html"><span class="apiname">CCoeFep</span></a> derives from both of these classes, but does not itself
implement any of their virtual functions. </p>
 </div>

<div class="section" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-357E255E-69AC-4A2C-B098-F1F0353A4F21"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-357E255E-69AC-4A2C-B098-F1F0353A4F21"><!-- --></a><h2 class="sectiontitle">Using the MCoeForegroundObserver
class</h2><p> <a href="GUID-2CAC79B0-8BD3-3961-A162-75B004AEE5FC.html"><span class="apiname">MCoeForegroundObserver</span></a> has two (pure)
virtual functions whose signatures are as follows: </p>
 <pre class="codeblock" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-123B7768-7C63-5398-9285-5F94436D8924"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-123B7768-7C63-5398-9285-5F94436D8924"><!-- --></a>virtual void HandleGainingForeground()=0;
virtual void HandleLosingForeground()=0;</pre>
 <p>The purpose of this
class is to enable notification of when the application (in whose thread the
client of this class is running) goes into the foreground or background. FEPs
that have a window owning control should include the following code at the
start of their implementation of <samp class="codeph">HandleGainingForeground()</samp>: </p>
 <pre class="codeblock" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-994FECF5-2EF2-5F29-A0CE-9C3225311812"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-994FECF5-2EF2-5F29-A0CE-9C3225311812"><!-- --></a>DrawableWindow()-&gt;MoveToGroup(iCoeEnv-&gt;WsSession().GetFocusWindowGroup());</pre>
 <p>This
code switches the FEP to the window group that has gained focus. Doing this
also enables FEPs to work with applications that have more than one window
group. The <samp class="codeph">HandleGainingForeground()</samp> and <samp class="codeph">HandleLosingForeground()</samp> virtual
functions might also be of use to a FEP if, for example, it is required to
be invisible when the application underneath it is in the background. </p>
</div>

<div class="section" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-C24BDB34-DBBE-4E7A-B07C-BC3E225683F3"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-C24BDB34-DBBE-4E7A-B07C-BC3E225683F3"><!-- --></a><h2 class="sectiontitle">Using the MCoeFocusObserver
class</h2><p> <a href="GUID-E591B7D7-ED56-3CEF-883F-7091D5833731.html"><span class="apiname">MCoeFocusObserver</span></a> has two (pure) virtual
functions whose signatures are as follows: </p>
 <pre class="codeblock" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-36F6FD47-99F1-57B0-A3E9-4CB866272C09"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-36F6FD47-99F1-57B0-A3E9-4CB866272C09"><!-- --></a>virtual void HandleChangeInFocus()=0;
virtual void HandleDestructionOfFocusedItem()=0;</pre>
 <p>The purpose
of this class is to enable notification of when controls under the FEP gain
or lose focus. This notification is useful to FEPs that need to know about
the input capabilities of their target control. See the next section for information
on input capabilities. </p>
</div>

<div class="section" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-5B6859ED-764F-4635-8457-91DDC29FBA7E"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-5B6859ED-764F-4635-8457-91DDC29FBA7E"><!-- --></a><h2 class="sectiontitle">Using the TCoeInputCapabilities
class</h2><p>The public parts of <samp class="codeph">TCoeInputCapabilities</samp> (which
is defined in <span class="filepath">epoc32\include\COEINPUT.H</span>) are as follows: </p>
 <pre class="codeblock" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-CF002ADB-2946-5D3A-9749-796D88D3C718"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-CF002ADB-2946-5D3A-9749-796D88D3C718"><!-- --></a>class TCoeInputCapabilities
    {
public:
    enum
        {
        ENone=0,
        EWesternNumericIntegerPositive=0x00000001,
        EWesternNumericIntegerNegative=0x00000002,
        EWesternNumericReal=0x00000004,
        EWesternAlphabetic=0x00000008,
        EJapaneseHiragana=0x00000010,
        EJapaneseKatakanaHalfWidth=0x00000020,
        EJapaneseKatakanaFullWidth=0x00000040,
        EDialableCharacters=0x00000080,
        ESecretText=0x00000100,
        EAllText=0x01000000,
        ENavigation=0x02000000
        };
    class MCoeFepSpecificExtensions; // to be defined by concrete FEPs, declared here
public:
    IMPORT_C TCoeInputCapabilities(TUint aCapabilities);
    IMPORT_C TCoeInputCapabilities(TUint aCapabilities, MCoeFepAwareTextEditor* aFepAwareTextEditor, MCoeCaptionRetrieverForFep* aCaptionRetrieverForFep);
    IMPORT_C TCoeInputCapabilities(TUint aCapabilities, MCoeFepAwareTextEditor* aFepAwareTextEditor,  MCoeCaptionRetrieverForFep* aCaptionRetrieverForFep,  TUid aFepUid, MCoeFepSpecificExtensions* aFepSpecificExtensions);
    IMPORT_C TCoeInputCapabilities(const TCoeInputCapabilities&amp; aAnother);
    IMPORT_C TCoeInputCapabilities&amp; operator=(const TCoeInputCapabilities&amp; aAnother);
    IMPORT_C TBool operator==(const TCoeInputCapabilities&amp; aAnother) const;
    IMPORT_C TBool operator!=(const TCoeInputCapabilities&amp; aAnother) const;
    IMPORT_C void MergeWith(const TCoeInputCapabilities&amp; aAnother);
    IMPORT_C void SetCapabilities(TUint aCapabilities);
    IMPORT_C TUint Capabilities() const;
    IMPORT_C TBool IsNone() const;
    IMPORT_C TBool SupportsWesternNumericIntegerPositive() const;
    IMPORT_C TBool SupportsWesternNumericIntegerNegative() const;
    IMPORT_C TBool SupportsWesternNumericReal() const;
    IMPORT_C TBool SupportsWesternAlphabetic() const;
    IMPORT_C TBool SupportsJapaneseHiragana() const;
    IMPORT_C TBool SupportsJapaneseKatakanaHalfWidth() const;
    IMPORT_C TBool SupportsJapaneseKatakanaFullWidth() const;
    IMPORT_C TBool SupportsDialableCharacters() const;
    IMPORT_C TBool SupportsSecretText() const;
    IMPORT_C TBool SupportsAllText() const;
    IMPORT_C TBool SupportsNavigation() const;
    IMPORT_C MCoeFepAwareTextEditor* FepAwareTextEditor() const;
    IMPORT_C MCoeCaptionRetrieverForFep* CaptionRetrieverForFep() const;
    IMPORT_C MCoeFepSpecificExtensions* FepSpecificExtensions(TUid aFepUid) const;
    IMPORT_C MObjectProvider* ObjectProvider() const;
    IMPORT_C void SetObjectProvider(MObjectProvider* aObjectProvider);
    };</pre>
 <p>The following code initializes <samp class="codeph">inputCapabilities</samp> to
the merged input capabilities of all the currently focused controls: </p>
 <pre class="codeblock" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-E82A2E62-B8BF-5D8C-B56C-B67CC4B34CCF"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-E82A2E62-B8BF-5D8C-B56C-B67CC4B34CCF"><!-- --></a>TCoeInputCapabilities inputCapabilities(STATIC_CAST(CCoeAppUi*, iCoeEnv-&gt;AppUi())-&gt;InputCapabilities());</pre>
 <p>The best place for this code is inside the overrides of <a href="GUID-E591B7D7-ED56-3CEF-883F-7091D5833731.html"><span class="apiname">MCoeFocusObserver</span></a> â€™s
virtual functions. </p>
 <p>By calling <a href="GUID-BB7D0D56-1713-3DC0-BDA0-3CA1F0462BE2.html"><span class="apiname">TCoeInputCapabilities</span></a>'s
inquiry functions, the FEP can vary its behaviour according to the input capabilities
of the target control. The <samp class="codeph">Supports</samp> <em>Xxxxx</em> <samp class="codeph">()</samp> member
functions indicate what sort of key events should be sent by the FEP to the
target control. It is important for the FEP to behave appropriately for the
capabilities of the target control(s). For example, a FEP should not allow
the user to compose a large amount of text, only to pass it on to a control
that does not support it. The <samp class="codeph">FepAwareTextEditor()</samp>, <samp class="codeph">CaptionRetrieverForFep()</samp> and <samp class="codeph">FepSpecificExtensions()</samp> member functions return pointers to objects of the interface classes <a href="GUID-A5D563D6-A99A-31DF-B844-5F94EF5FFE87.html"><span class="apiname">MCoeFepAwareTextEditor</span></a>, <a href="GUID-68C16461-68A4-37D2-888E-DD4A6917442A.html"><span class="apiname">MCoeCaptionRetrieverForFep</span></a> and <a href="GUID-03D3A775-F899-30F1-8A4F-25D60439C11E.html"><span class="apiname">MCoeFepSpecificExtensions</span></a> respectively. In each case,
a NULL return value indicates that the interface is not supported by any of
the currently focused controls. </p>
 <p> <a href="GUID-A5D563D6-A99A-31DF-B844-5F94EF5FFE87.html"><span class="apiname">MCoeFepAwareTextEditor</span></a> (which
is defined in <span class="filepath">epoc32\include\FEPBASE.H</span>) is an important
and complex class, and is discussed in <a href="GUID-38679CA2-0066-589C-988F-AC14B7E2F107.html#GUID-38679CA2-0066-589C-988F-AC14B7E2F107__GUID-9C16757D-DC75-5223-A555-550B8D3C1DB4">Close
interaction with text editor controls</a> below. </p>
 <p> <a href="GUID-68C16461-68A4-37D2-888E-DD4A6917442A.html"><span class="apiname">MCoeCaptionRetrieverForFep</span></a>,
which is also defined in <span class="filepath">epoc32\include\FEPBASE.H</span>, has
a single member function whose signature is as follows: </p>
 <pre class="codeblock" id="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-AD620A06-25B2-5E2D-B9F0-AB4D7686F96D"><a name="GUID-238D6070-96AC-5D8A-86EA-488C59DF2AE3__GUID-AD620A06-25B2-5E2D-B9F0-AB4D7686F96D"><!-- --></a>virtual void GetCaptionForFep(TDes&amp; aCaption) const=0;</pre>
 <p>This sets <samp class="codeph">aCaption</samp> to the caption of the target control.
An example of a caption is the non-editable prompt displayed alongside each
item in a dialog. </p>
 <p> <a href="GUID-03D3A775-F899-30F1-8A4F-25D60439C11E.html"><span class="apiname">MCoeFepSpecificExtensions</span></a> is
declared in <span class="filepath">epoc32\include\COEINPUT.H</span> within the scope
of the <a href="GUID-BB7D0D56-1713-3DC0-BDA0-3CA1F0462BE2.html"><span class="apiname">TCoeInputCapabilities</span></a> class, although it is not
defined by any component in the Symbian platform. It is to be defined by concrete
FEPs rather than by the FEP architecture. The intention of this is to allow
applications to communicate specialized input capabilities with a particular
FEP that they know about. The concrete FEP would define the class in a public
header file which then can be used by the relevant applications. Note that
the <a href="GUID-BB7D0D56-1713-3DC0-BDA0-3CA1F0462BE2.html"><span class="apiname">TCoeInputCapabilities</span></a> constructor which takes a <a href="GUID-03D3A775-F899-30F1-8A4F-25D60439C11E.html"><span class="apiname">MCoeFepSpecificExtensions</span></a> pointer,
and also the inquiry function returning a <a href="GUID-03D3A775-F899-30F1-8A4F-25D60439C11E.html"><span class="apiname">MCoeFepSpecificExtensions</span></a> pointer
both require the UID of the FEP defining this class to be passed. This is
to ensure that the FEP and the application are both assuming the same definition
of the <a href="GUID-03D3A775-F899-30F1-8A4F-25D60439C11E.html"><span class="apiname">MCoeFepSpecificExtensions</span></a> class. </p>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-68A55CD5-EF01-5DE2-8119-EFA39589960F.html">How to Write a FEP</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>