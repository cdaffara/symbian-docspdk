<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2010"/>
<meta name="DC.rights.owner" content="(C) Copyright 2010"/>
<meta name="DC.Type" content="concept"/>
<meta name="DC.Title" content="Advanced Audio Adaptation Framework Technology Guide"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DC704CA7-401C-54D5-85DA-B5EBF4362806.html"/>
<meta name="DC.Relation" scheme="URI" content="index.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-EC4CE675-3EE7-58F7-A872-E72548B0C9A5.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-567AB683-5D92-533D-B4D8-813E70316DA3.html"/>
<meta name="DC.Relation" scheme="URI" content="GUID-DC704CA7-401C-54D5-85DA-B5EBF4362806.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2"/>
<meta name="DC.Language" content="en"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Advanced Audio Adaptation Framework Technology Guide</title>

     
<link type="text/css" rel="stylesheet" href="css/common.css" media="screen"/>
<link type="text/css" rel="stylesheet" href="css/sdl.css" media="screen"/>

<!--[if IE]>
<link href="css/iefix.css" rel="stylesheet" type="text/css" media="screen" />
<![endif]-->



     <link rel="stylesheet" type="text/css" href="nokiacxxref.css"/></head>
<body id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2"><!-- --></a>


<?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ?>
<div id="sdl_container">
   <div id="leftMenu">  
 <div id="expandcontractdiv">
    <a id="collapseTree" href="javascript:tree.collapseAll()">Collapse all</a>
    <a id="index" href="index.html">Symbian^3 Product Developer Library</a>        
</div>
     <iframe style="border:none" height="800" width="300" src="index-toc.html"></iframe>
<div id="treeDiv1">&#160;</div>
     <script type="text/javascript">
	var currentIconMode = 0; window.name="id2563754 id2405098 id2397272 id2397286 id2397301 ";
	YAHOO.util.Event.onDOMReady(buildTree, this,true);
    </script>
     
</div>

<div id="sdl_content">


<div class="breadcrumb"><a href="index.html" title="Symbian^3 Product Developer Library">Symbian^3 Product Developer Library</a> &gt; <a href="GUID-32E29020-1956-461A-B79A-1492E06049E7.html" title="The Symbian Guide describes the architecture and functionality of the platform, and provides guides on using its APIs.">Symbian Guide</a> &gt; <a href="GUID-1DE5CDAD-8D71-5384-9E98-5665D5A4C792.html">Multimedia Guide</a> &gt; <a href="GUID-EC4CE675-3EE7-58F7-A872-E72548B0C9A5.html" title="The Sound Device collection provides a common interface for all audio functionality. Key audio components in the Sound Device collection are the Advanced Audio Adaptation Framework (A3F) DevSound and Audio Component Framework.">Sound Device Collection</a> &gt; <a href="GUID-567AB683-5D92-533D-B4D8-813E70316DA3.html" title="The Advanced Audio Adaptation Framework (A3F) Audio Component Framework component provides a common interface for accessing audio resources, playing tones, and configuring audio for playing and recording.">A3F Audio Component Framework Component</a> &gt; <a href="GUID-DC704CA7-401C-54D5-85DA-B5EBF4362806.html" title="This section describes important A3F Audio Component Framework concepts, such as audio stream states and the Commit process.">A3F Audio Component Framework Concepts</a> &gt; </div>
<h1 class="topictitle1">Advanced Audio Adaptation Framework Technology Guide</h1>
<div><p>This document provides additional information about the Advanced Audio Adaptation Framework. </p>
 <div class="section"><h2 class="sectiontitle">Purpose</h2> <p>The Advanced Audio Adaptation Framework (A3F) provides a common interface for accessing audio resources, playing tones, and configuring audio for playing and recording. </p>
 </div>
 <div class="section"><h2 class="sectiontitle">Understanding A3F</h2> <p>A3F functionality is provided by the <a href="GUID-C4AD7B75-9027-3F62-889C-ADEF5E6DBC73.html"><span class="apiname">CAudioContextFactory</span></a> class. <a href="GUID-C4AD7B75-9027-3F62-889C-ADEF5E6DBC73.html"><span class="apiname">CAudioContextFactory</span></a> is responsible for creating audio contexts. The Audio Context API (<a href="GUID-67BE95B2-BE4A-32AF-8BDF-92FD8FBE6DC3.html"><span class="apiname">MAudioContext</span></a>) maintains all audio components created in a context, where audio components are instances of the <a href="GUID-C5B1FE01-DCFC-3CA5-931B-E371AEC918A6.html"><span class="apiname">MAudioStream</span></a> and <a href="GUID-0536EF5D-3DA6-3F30-A404-52FE9E21B359.html"><span class="apiname">MAudioProcessingUnit</span></a> classes. </p>
 <p>An <a href="GUID-0536EF5D-3DA6-3F30-A404-52FE9E21B359.html"><span class="apiname">MAudioProcessingUnit</span></a> is created in a context by giving the type of the processing unit such as codec and source sink. <a href="GUID-0536EF5D-3DA6-3F30-A404-52FE9E21B359.html"><span class="apiname">MAudioProcessingUnit</span></a> allows extension interfaces to set additional audio processing unit settings. </p>
 <p>The Audio Stream API (<a href="GUID-C5B1FE01-DCFC-3CA5-931B-E371AEC918A6.html"><span class="apiname">MAudioStream</span></a>) is an audio component that links together processing units into an audio stream. <a href="GUID-C5B1FE01-DCFC-3CA5-931B-E371AEC918A6.html"><span class="apiname">MAudioStream</span></a> manages the audio processing state requested by the client and interacts with the audio processing units added to the stream. <a href="GUID-C5B1FE01-DCFC-3CA5-931B-E371AEC918A6.html"><span class="apiname">MAudioStream</span></a> provides runtime control over a stream's (composite) behaviour and lifetime management of the entities in a stream (whether the state of the stream is uninitialized, initialized, idle, primed, active or dead). For more information, see <a href="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2.html#GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-28D6AB9C-8F4F-573A-853D-726138249390">Stream States</a>. </p>
 <p>The Audio Context API allows a grouping notion for multimedia allocations. <a href="GUID-67BE95B2-BE4A-32AF-8BDF-92FD8FBE6DC3.html"><span class="apiname">MAudioContext</span></a> groups component actions made inside a context. This means any allocation or loss of resources which occurs in any single audio component affects all of the components grouped in the context. </p>
 <p id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-C13977B1-D855-5D46-913C-15059421C225"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-C13977B1-D855-5D46-913C-15059421C225"><!-- --></a><strong>The Commit Cycle</strong> </p>
 <p>Changes made to an audio stream are handled in a transactional manner. If changes fail to be applied, then any other changes made to the stream are considered to fail also. The application of changes is dependent on a successful commit cycle. If there is a failure, a “rollback" mechanism is executed and the stream states are reverted to their previous state. </p>
 <p>The client requests changes through various <samp class="codeph">Set()</samp> calls and then calls the <a href="GUID-67BE95B2-BE4A-32AF-8BDF-92FD8FBE6DC3.html#GUID-67BE95B2-BE4A-32AF-8BDF-92FD8FBE6DC3__GUID-7011BDC1-C4D8-3BB5-9B7C-8729FADCE67E"><span class="apiname">MAudioContext::Commit()</span></a> function. The platform-specific implementation then decides whether the <samp class="codeph">Commit()</samp> request is allowed, possibly dictates new values if needed, and then applies the changes. If successful, the client is informed through callbacks. If there is a need to modify the context because resources are needed in another context, then the platform-specific implementation can take the resources by pre-empting the context. In this case, the client is informed about the pre-emption. </p>
 <p>The following diagram shows this behaviour: </p>
 <div class="fignone" id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-18D00361-18E7-5A5C-B8C0-115E1D2DF29F"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-18D00361-18E7-5A5C-B8C0-115E1D2DF29F"><!-- --></a><span class="figcap">Figure 1. 
                A3F Commit / Pre-emption Cycle 
             </span> <img src="GUID-F68FF4C2-F9DB-5935-9027-9BEC006D031F_d0e543528_href.png"/></div>
 <p><strong>Observers</strong> </p>
 <p>Most of the A3F API functions are asynchronous. For example, the functions <samp class="codeph">Foo()</samp> or <samp class="codeph">SetFoo()</samp> are followed with <samp class="codeph">FooComplete(Tint aError)</samp> or <samp class="codeph">FooSet(Tint aError)</samp>. </p>
 <p>The following A3F observers are defined: </p>
 <ul><li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-11C7E019-8628-533E-ACAB-E7A7C4893C65"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-11C7E019-8628-533E-ACAB-E7A7C4893C65"><!-- --></a><p> <a href="GUID-3336EC2B-4FB8-3FD0-A702-0CB50DE059B4.html"><span class="apiname">MAudioContextObserver</span></a>  </p>
 <p>Informs with <samp class="codeph">ContextEvent()</samp> about the commit cycle. Note that <samp class="codeph">ContextEvent()</samp> is in the same thread context as the A3F client. </p>
 </li>
 <li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-1E628CBE-641F-54B2-B144-FFEC88AB2ECF"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-1E628CBE-641F-54B2-B144-FFEC88AB2ECF"><!-- --></a><p> <a href="GUID-D2075F61-F6FA-3FAE-9FBB-20CEFE81334C.html"><span class="apiname">MAudioStreamObserver</span></a>  </p>
 <p>Informs with <samp class="codeph">StateEvent()</samp> about state changes </p>
 </li>
 <li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-611327B3-9278-5793-9BE2-072B898A5245"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-611327B3-9278-5793-9BE2-072B898A5245"><!-- --></a><p> <a href="GUID-805E421D-9143-326D-9455-FF40205AA70A.html"><span class="apiname">MAudioCodecObserver</span></a>  </p>
 <p>Informs about completion of setters and getters. </p>
 </li>
 <li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-CD6FC1B2-B581-5CD2-9355-8B3AF8681680"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-CD6FC1B2-B581-5CD2-9355-8B3AF8681680"><!-- --></a><p> <a href="GUID-B235174E-E8AC-36EE-8BCC-F466EEB8E720.html"><span class="apiname">MAudioGainControlObserver</span></a>  </p>
 <p>Informs about changes in gain or changes in maximum gain values. </p>
 </li>
 <li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-A46EF843-AD06-583E-8E1E-712CC0341421"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-A46EF843-AD06-583E-8E1E-712CC0341421"><!-- --></a><p> <a href="GUID-C070F06A-E77A-3477-90A2-C2E38B0E823C.html"><span class="apiname">MAudioProcessingUnitObserver</span></a>  </p>
 <p>Informs about any additional errors in audio processing units. </p>
 </li>
 <li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-178B9281-35A8-519A-A01A-920134606A87"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-178B9281-35A8-519A-A01A-920134606A87"><!-- --></a><p> <a href="GUID-BC675A52-D3B5-3F97-B986-8643A8FEFE59.html"><span class="apiname">MMMFAudioDataConsumer</span></a>  </p>
 <p>Informs about recorded buffer to be ready for storing. Also informs the client if there is a buffer to be ignored. </p>
 </li>
 <li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-8F5E2944-DB55-5601-B150-490919C98C4E"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-8F5E2944-DB55-5601-B150-490919C98C4E"><!-- --></a><p> <a href="GUID-5F500DE3-5253-326C-B94A-1CBD7C83C082.html"><span class="apiname">MMMFAudioDataSupplier</span></a>  </p>
 <p>Informs about new buffer ready to be filled with audio data. Also informs the client if any requested buffer should be ignored. </p>
 </li>
 </ul>
 <p id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-28D6AB9C-8F4F-573A-853D-726138249390"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-28D6AB9C-8F4F-573A-853D-726138249390"><!-- --></a><strong>Stream States</strong> </p>
 <p>Clients using A3F should be aware that requested audio resources can be lost at any time while they are being used. A client with a higher importance can cause requests for resources to be denied or available resources to become unavailable. In these cases, the commit cycle informs the client through pre-emption events and the resulted stream state is usually demoted to the highest non-disturbing state. </p>
 <p>The possible audio stream states are described in the following table: </p>
 
<div class="tablenoborder"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-33D9A149-C1CF-52F0-87E1-234CF93F677E"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-33D9A149-C1CF-52F0-87E1-234CF93F677E" frame="border" border="1" rules="all"><thead align="left"><tr><th class="cellrowborder" valign="top" id="d1609426e272">State</th>
 <th class="cellrowborder" valign="top" id="d1609426e275">Description</th>
 </tr>
 </thead>
 <tbody><tr><td class="cellrowborder" valign="top" headers="d1609426e272 "><p> <samp class="codeph">EUninitialized</samp>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1609426e275 "><p>This is the state of the chain before it is initialized. However, the settings in the logical chain cannot be related to the adaptation because no adaptation has been selected yet. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1609426e272 "><p> <samp class="codeph">EInitialized</samp>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1609426e275 "><p>This state is set after a successful initialization request. </p>
 <p>The physical adaptation has been selected but may not be fully allocated. </p>
 <p>There should be no externally visible buffers allocated at this point </p>
 <p> <strong>Note</strong>: For zero copy and shared chunk buffers, a stream in the <samp class="codeph">EInitialized</samp> state should not require buffer consumption. This is an important issue if the base port only has 16 addressable chunks per process. </p>
 <p>In terms of DevSound compatibility, some custom interfaces are available at this point (although others may require further construction before they are available). </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1609426e272 "><p> <samp class="codeph">EIdle</samp>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1609426e275 "><p>All the chain resources are allocated. However, no processing time (other than that expended to put the chain into the <samp class="codeph">EIdle</samp> state) is consumed in this phase. </p>
 <p>In the <samp class="codeph">EIdle</samp> state, any existing allocated buffers continue to exist. </p>
 <p>The codec is allocated in terms of hardware memory consumption. </p>
 <p>A stream in the <samp class="codeph">EIdle</samp> state can be ‘mid-file position’. There is no implied reset of position or runtime settings (that is, time played) by returning to <samp class="codeph">EIdle</samp>. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1609426e272 "><p> <samp class="codeph">EPrimed</samp>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1609426e275 "><p>This state is the same as <samp class="codeph">EIdle</samp> but the stream can consume processing time by filling its buffers. The purpose of this state is to prepare a stream such that it is ready to play in as short a time as possible (for example, low-latency for audio chains which can be pre-buffered). </p>
 <p>Note that once the buffer is full, the stream may continue to use some processing time. </p>
 <p>There will not be an automatic transition to the <samp class="codeph">EIdle</samp> state when the buffer is full. If such behaviour is desired, the client must request it. </p>
 <p>There will not be an automatic transition to <samp class="codeph">EActive</samp> when the buffer is full. If such behaviour is desired, the client must request it. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1609426e272 "><p> <samp class="codeph">EActive</samp>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1609426e275 "><p>The chain has the resources as <samp class="codeph">EIdle</samp> and <samp class="codeph">EPrimed</samp> but also has started to process the actions requested by the client. </p>
 <p> <strong>Note:</strong> A chain can be in the <samp class="codeph">EActive</samp> state and performing a wide range of operations. However the semantics are that it is processing the stream and that it is consuming both processing and memory resources. </p>
 </td>
 </tr>
 <tr><td class="cellrowborder" valign="top" headers="d1609426e272 "><p> <samp class="codeph">EDead</samp>  </p>
 </td>
 <td class="cellrowborder" valign="top" headers="d1609426e275 "><p>The stream can no longer function due to a fatal error. The logical chain still exists, but any physical resources should be reclaimed by the adaptation. </p>
 </td>
 </tr>
 </tbody>
 </table>
</div>
 <p>The following diagram shows the stream states: </p>
 <div class="fignone" id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-1FA73F08-1C43-57AA-AEFA-DDEDD9464DDA"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-1FA73F08-1C43-57AA-AEFA-DDEDD9464DDA"><!-- --></a><span class="figcap">Figure 2. 
                A3F State Machine 
             </span> <img src="GUID-D2DCBC1F-91B8-5F81-AAE8-546AE3EB1E29_d0e543846_href.png"/></div>
 </div>
 <div class="section"><h2 class="sectiontitle">A3F Tutorials</h2> <p>The following tutorials are provided to help you create A3F solutions: </p>
 <ul><li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-EC27BD5D-A1DB-53E7-87F1-4A0AD6280F8B"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-EC27BD5D-A1DB-53E7-87F1-4A0AD6280F8B"><!-- --></a><p><a href="GUID-931207BE-3561-562D-8F67-0FB52CFF83CD.html">Audio Component Framework Tutorial</a>  </p>
 </li>
 <li id="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-4BBFA92A-F174-57A6-B512-9F0D56C0EA6D"><a name="GUID-B0449B60-B78E-5CC1-8FAF-E5EE24D88EB2__GUID-4BBFA92A-F174-57A6-B512-9F0D56C0EA6D"><!-- --></a><p><a href="GUID-2A543E1C-F3DE-59EF-8A43-1B655F367FBC.html">Audio Processing Tutorial</a>  </p>
 </li>
 </ul>
 </div>
 <div class="section"><h2 class="sectiontitle">See Also</h2> <p><a href="GUID-4AAABD77-C08E-5EE2-A02A-3B412EA6D23F.html">Advanced Audio Adaptation Framework Overview</a> </p>
 <p><a href="GUID-174D98FF-6782-564E-9FDF-1AE32F770591.html">Sound Device Overview</a>  </p>
 </div>
 </div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="GUID-DC704CA7-401C-54D5-85DA-B5EBF4362806.html" title="This section describes important A3F Audio Component Framework concepts, such as audio stream states and the Commit process.">A3F Audio Component Framework Concepts</a></div>
</div>
</div>
   
<p class="copyright">Copyright &#169;2010 Nokia Corporation and/or its subsidiary(-ies).<br /> All rights
reserved. Unless otherwise stated, these materials are provided under the terms of the <a href=" http://www.eclipse.org/legal/epl-v10.html"> Eclipse Public License
v1.0</a>.</p> 
</div>
</div>
<?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ?>

</body>
</html>